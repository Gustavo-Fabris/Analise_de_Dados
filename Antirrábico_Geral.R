rm(list =ls())

####Indicando Diretório de Trabalho.#####

setwd("/home/gustavo/Área de Trabalho/Análise_de_Dados/")

###Libraries###

library(foreign)
library (dplyr)
library(ggplot2)

####Planilha com os dados dos municípios e com os códigos do IBGE. Será utilizada nos for loops para buscar dados######## 
####dos municípios e vinculá-los com os dados da base DBF do SINAN#######################################################

BASE_IBGE<-read.csv(file="Base_de_Dados/Planilha_Base_IBGE.csv", 
                    header=TRUE, 
                    sep=",")

############################################################################################
####   Definindo o objeto RS para servir de apoio para    ##################################
####    buscar dados de todas as RS. Usar 1, 2, 3..., 21, 22    ############################
############################################################################################

RS <- 22   #####  Deve-se colocar AQUI a Regional

######   Criando objeto ID_REG. Será utilizado para selecionar
######   RS no DBF do SINAN ONLINE.

ID_REG <- as.data.frame(BASE_IBGE[which(BASE_IBGE$RS == RS), 6])

ID_REG <- as.numeric(ID_REG[1,1])

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2012 <- read.dbf(file = "Base_de_Dados/DBF/ANTRANET2012.DBF",
                       as.is = FALSE)


####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2012$ID_MN_RESI <- as.numeric(as.character(ANTRAB2012$ID_MN_RESI))

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica <- data.frame(Ano = 
                                          c("2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023"),
                                        Notificados = NA)

PR_ANTRAB_Serie_Historica[1, 2] <- as.integer(ANTRAB2012 %>% 
                                                count()
)
#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

SINAN_ANTRAB_2012 <- ANTRAB2012 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_ANTRAB_2012_SINAN"), SINAN_ANTRAB_2012)

write.csv (assign(paste0("RS", RS, "_ANTRAB_2012_SINAN"), SINAN_ANTRAB_2012), 
           paste0("Base_de_Dados/Tabulacoes_R/Raiva/RS", RS, "_ANTRAB_2012_SINAN.csv"), 
           row.names = FALSE)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2012_SE_Notificados <- matrix(data = NA, 
                                     nrow =  row, 
                                     ncol = 54)

RS22_ANTRAB_2012_SE_Notificados <- as.data.frame(RS22_ANTRAB_2012_SE_Notificados)

colnames(RS22_ANTRAB_2012_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2012_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2012_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2012_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                        filter(ID_MN_RESI == i,
                                                                                               SEM_PRI ==201201)%>%
                                                                                        count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                        filter(ID_MN_RESI == i, 
                                                                                               SEM_PRI ==201202) %>% 
                                                                                        count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                        filter(ID_MN_RESI == i,
                                                                                               SEM_PRI ==201203) %>% 
                                                                                        count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201204) %>% 
                                                                                       count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                        filter(ID_MN_RESI == i,
                                                                                               SEM_PRI ==201205) %>% 
                                                                                        count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                        filter(ID_MN_RESI == i, 
                                                                                               SEM_PRI ==201206) %>%
                                                                                        count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                        filter(ID_MN_RESI == i, 
                                                                                               SEM_PRI ==201207) %>% 
                                                                                        count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                        filter(ID_MN_RESI == i, 
                                                                                               SEM_PRI ==201208) %>% 
                                                                                        count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201209) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201210) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201211) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201212) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201213) %>% 
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201214) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201215) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201216) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201217) %>%  
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201218) %>%      
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201219) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i, 
                                                                                                 SEM_PRI ==201220) %>%
                                                                                          count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201221) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201222) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201223) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201224) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201225) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201226) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201227) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201228) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201229) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201230) %>% 
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201231) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201232) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201233) %>% 
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201234) %>% 
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201235) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201236) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201237) %>% 
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201238) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201239) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201240) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201241) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201242) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201243) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201244) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201245) %>%
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201246) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201247) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201248) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201249) %>% 
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201250) %>% 
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201251) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2012 %>%
                                                                                         filter(ID_MN_RESI == i,
                                                                                                SEM_PRI ==201252) %>%
                                                                                         count() 
  )
  
  RS22_ANTRAB_2012_SE_Notificados[which(RS22_ANTRAB_2012_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i, 
                                                                                                SEM_PRI ==201253) %>%
                                                                                         count() 
  )
}

RS22_ANTRAB_2012_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2012_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2012_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2012_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2012_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_GERAL <- RS22_ANTRAB_2012_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_GERAL$Notificados <- NA

RS22_ANTRAB_2012_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2012_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2012_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2012_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2012_GERAL$Feminino <- NA

RS22_ANTRAB_2012_GERAL$Masculino <- NA

RS22_ANTRAB_2012_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2012_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2012_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2012_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2012_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2012_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2012_GERAL$Analfabeto <- NA

RS22_ANTRAB_2012_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2012_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2012_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2012_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2012_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2012_GERAL$Superior_completo <- NA

RS22_ANTRAB_2012_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2012_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2012_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2012_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2012_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2012_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2012_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2012_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2012_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2012_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2012_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2012_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2012_GERAL[which(RS22_ANTRAB_2012_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2012_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2012_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2012_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2012_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_EXPOSICAO <- RS22_ANTRAB_2012_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2012_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2012_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2012_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2012_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_EXPOSICAO[which(RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2012_EXPOSICAO[which(RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_EXPOSICAO[which(RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_EXPOSICAO[which(RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_EXPOSICAO[which(RS22_ANTRAB_2012_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2012_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2012_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2012_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2012_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_LOCALIZACAO <- RS22_ANTRAB_2012_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2012_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2012_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2012_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2012_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2012_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2012_LOCALIZACAO[which(RS22_ANTRAB_2012_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2012_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2012_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2012_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2012_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_FERIMENTO <- RS22_ANTRAB_2012_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_FERIMENTO$Unico <- NA

RS22_ANTRAB_2012_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2012_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2012_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_FERIMENTO[which(RS22_ANTRAB_2012_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2012_FERIMENTO[which(RS22_ANTRAB_2012_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_FERIMENTO[which(RS22_ANTRAB_2012_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_FERIMENTO[which(RS22_ANTRAB_2012_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2012_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2012_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2012_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2012_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_TIPO_FERIMENTO <- RS22_ANTRAB_2012_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2012_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2012_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_TIPO_FERIMENTO[which(RS22_ANTRAB_2012_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2012_TIPO_FERIMENTO[which(RS22_ANTRAB_2012_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2012_TIPO_FERIMENTO[which(RS22_ANTRAB_2012_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2012_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2012_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2012_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2012_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_ANTECEDENTE_ANTR <- RS22_ANTRAB_2012_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2012_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2012_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2012_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2012_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2012_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2012_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2012_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2012_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_AGRESSOR <- RS22_ANTRAB_2012_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_AGRESSOR$Canina <- NA

RS22_ANTRAB_2012_AGRESSOR$Felina <- NA

RS22_ANTRAB_2012_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2012_AGRESSOR$Primata <- NA

RS22_ANTRAB_2012_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2012_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2012_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2012_AGRESSOR[which(RS22_ANTRAB_2012_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2012_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2012_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2012_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2012_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_COND_ANIMAL_ACID <- RS22_ANTRAB_2012_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2012_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2012_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2012_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_COND_ANIMAL_ACID[which(RS22_ANTRAB_2012_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2012_COND_ANIMAL_ACID[which(RS22_ANTRAB_2012_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2012_COND_ANIMAL_ACID[which(RS22_ANTRAB_2012_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2012_COND_ANIMAL_ACID[which(RS22_ANTRAB_2012_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2012_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2012_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2012_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2012_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_OBSERVAVEL <- RS22_ANTRAB_2012_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2012_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_OBSERVAVEL[which(RS22_ANTRAB_2012_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2012_OBSERVAVEL[which(RS22_ANTRAB_2012_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2012_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2012_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2012_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2012_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_TRATAMENTO <- RS22_ANTRAB_2012_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2012_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2012_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2012_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2012_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2012_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2012_TRATAMENTO[which(RS22_ANTRAB_2012_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2012_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2012_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2012_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2012_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_COND_FINAL_ANIMAL<- RS22_ANTRAB_2012_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2012_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2012_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2012_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2012_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2012_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2012_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2012_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_INTERRUPCAO_TRAT <- RS22_ANTRAB_2012_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2012_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2012_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2012_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2012_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2012_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2012_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2012_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2012_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_SOROTERAPIA <- RS22_ANTRAB_2012_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2012_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2012_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_SOROTERAPIA[which(RS22_ANTRAB_2012_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2012_SOROTERAPIA[which(RS22_ANTRAB_2012_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2012_SOROTERAPIA[which(RS22_ANTRAB_2012_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2012_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2012_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2012_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2012_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2012_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2012_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2012_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2012_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2012_SORO_INFILTRACAO  <- RS22_ANTRAB_2012_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2012_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2012_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2012_SORO_INFILTRACAO[which(RS22_ANTRAB_2012_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2012_SORO_INFILTRACAO[which(RS22_ANTRAB_2012_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2012 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2012_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2012_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2012_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2012)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2013 <- read.dbf(file = "ANTRANET2013.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[2, 2] <- as.integer(ANTRAB2013 %>% 
                                                count()
                                              )

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2013$ID_MN_RESI <- as.numeric(as.character(ANTRAB2013$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2013 <- ANTRAB2013 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2013_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2013_SE_Notificados <- as.data.frame(RS22_ANTRAB_2013_SE_Notificados)

colnames(RS22_ANTRAB_2013_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2013_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2013_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2013_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201301)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201302) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201303) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201304) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201305) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201306) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201307) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201308) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201309) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201310) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201311) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201312) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201313) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201314) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201315) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201316) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201317) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201318) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201319) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201320) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201321) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201322) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201323) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201324) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201325) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201326) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201327) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201328) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201329) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201330) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201331) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201332) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201333) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201334) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201335) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201336) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201337) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201338) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201339) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201340) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201341) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201342) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201343) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201344) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201345) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201346) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201347) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201348) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201349) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201350) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201351) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2013 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201352) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2013_SE_Notificados[which(RS22_ANTRAB_2013_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201353) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2013_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2013_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2013_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2013_SE_Notificados[17,1] <- "Total"


#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2013_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_GERAL <- RS22_ANTRAB_2013_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_GERAL$Notificados <- NA

RS22_ANTRAB_2013_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2013_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2013_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2013_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2013_GERAL$Feminino <- NA

RS22_ANTRAB_2013_GERAL$Masculino <- NA

RS22_ANTRAB_2013_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2013_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2013_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2013_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2013_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2013_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2013_GERAL$Analfabeto <- NA

RS22_ANTRAB_2013_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2013_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2013_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2013_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2013_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2013_GERAL$Superior_completo <- NA

RS22_ANTRAB_2013_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2013_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2013_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2013_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2013_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2013_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2013_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2013_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2013_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2013_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2013_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2013_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2013_GERAL[which(RS22_ANTRAB_2013_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2013_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2013_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2013_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2013_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_EXPOSICAO <- RS22_ANTRAB_2013_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2013_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2013_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2013_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2013_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_EXPOSICAO[which(RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2013_EXPOSICAO[which(RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_EXPOSICAO[which(RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_EXPOSICAO[which(RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_EXPOSICAO[which(RS22_ANTRAB_2013_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2013_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2013_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2013_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2013_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_LOCALIZACAO <- RS22_ANTRAB_2013_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2013_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2013_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2013_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2013_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2013_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2013_LOCALIZACAO[which(RS22_ANTRAB_2013_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2013_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2013_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2013_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2013_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_FERIMENTO <- RS22_ANTRAB_2013_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_FERIMENTO$Unico <- NA

RS22_ANTRAB_2013_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2013_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2013_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_FERIMENTO[which(RS22_ANTRAB_2013_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2013_FERIMENTO[which(RS22_ANTRAB_2013_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_FERIMENTO[which(RS22_ANTRAB_2013_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_FERIMENTO[which(RS22_ANTRAB_2013_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2013_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2013_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2013_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2013_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_TIPO_FERIMENTO <- RS22_ANTRAB_2013_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2013_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2013_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_TIPO_FERIMENTO[which(RS22_ANTRAB_2013_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2013_TIPO_FERIMENTO[which(RS22_ANTRAB_2013_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2013_TIPO_FERIMENTO[which(RS22_ANTRAB_2013_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2013_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2013_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2013_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2013_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_ANTECEDENTE_ANTR <- RS22_ANTRAB_2013_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2013_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2013_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2013_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2013_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2013_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2013_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2013_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2013_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_AGRESSOR <- RS22_ANTRAB_2013_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_AGRESSOR$Canina <- NA

RS22_ANTRAB_2013_AGRESSOR$Felina <- NA

RS22_ANTRAB_2013_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2013_AGRESSOR$Primata <- NA

RS22_ANTRAB_2013_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2013_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2013_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2013_AGRESSOR[which(RS22_ANTRAB_2013_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2013_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2013_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2013_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2013_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_COND_ANIMAL_ACID <- RS22_ANTRAB_2013_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2013_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2013_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2013_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_COND_ANIMAL_ACID[which(RS22_ANTRAB_2013_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2013_COND_ANIMAL_ACID[which(RS22_ANTRAB_2013_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2013_COND_ANIMAL_ACID[which(RS22_ANTRAB_2013_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2013_COND_ANIMAL_ACID[which(RS22_ANTRAB_2013_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2013_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2013_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2013_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2013_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_OBSERVAVEL <- RS22_ANTRAB_2013_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2013_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_OBSERVAVEL[which(RS22_ANTRAB_2013_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2013_OBSERVAVEL[which(RS22_ANTRAB_2013_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2013_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2013_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2013_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2013_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_TRATAMENTO <- RS22_ANTRAB_2013_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2013_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2013_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2013_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2013_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2013_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2013_TRATAMENTO[which(RS22_ANTRAB_2013_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2013_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2013_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2013_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2013_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_COND_FINAL_ANIMAL<- RS22_ANTRAB_2013_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2013_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2013_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2013_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2013_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2013_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2013_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2013_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_INTERRUPCAO_TRAT <- RS22_ANTRAB_2013_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2013_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2013_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2013_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2013_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2013_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2013_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2013_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2013_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_SOROTERAPIA <- RS22_ANTRAB_2013_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2013_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2013_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_SOROTERAPIA[which(RS22_ANTRAB_2013_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2013_SOROTERAPIA[which(RS22_ANTRAB_2013_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2013_SOROTERAPIA[which(RS22_ANTRAB_2013_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2013_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2013_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2013_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2013_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2013_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2013_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2013_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2013_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2013_SORO_INFILTRACAO  <- RS22_ANTRAB_2013_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2013_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2013_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2013_SORO_INFILTRACAO[which(RS22_ANTRAB_2013_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2013_SORO_INFILTRACAO[which(RS22_ANTRAB_2013_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2013 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2013_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2013_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2013_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2013)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2014 <- read.dbf(file = "ANTRANET2014.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[3, 2] <- as.integer(ANTRAB2014 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2014$ID_MN_RESI <- as.numeric(as.character(ANTRAB2014$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2014 <- ANTRAB2014 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)


################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2014_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2014_SE_Notificados <- as.data.frame(RS22_ANTRAB_2014_SE_Notificados)

colnames(RS22_ANTRAB_2014_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2014_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2014_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2014_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201401)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201402) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201403) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201404) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201405) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201406) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201407) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201408) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201409) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201410) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201411) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201412) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201413) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201414) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201415) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201416) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201417) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201418) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201419) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201420) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201421) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201422) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201423) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201424) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201425) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201426) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201427) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201428) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201429) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201430) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201431) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201432) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201433) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201434) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201435) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201436) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201437) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201438) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201439) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201440) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201441) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201442) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201443) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201444) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201445) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201446) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201447) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201448) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201449) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201450) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201451) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2014 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201452) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2014_SE_Notificados[which(RS22_ANTRAB_2014_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201453) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2014_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2014_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2014_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2014_SE_Notificados[17,1] <- "Total"


#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2014_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_GERAL <- RS22_ANTRAB_2014_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_GERAL$Notificados <- NA

RS22_ANTRAB_2014_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2014_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2014_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2014_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2014_GERAL$Feminino <- NA

RS22_ANTRAB_2014_GERAL$Masculino <- NA

RS22_ANTRAB_2014_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2014_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2014_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2014_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2014_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2014_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2014_GERAL$Analfabeto <- NA

RS22_ANTRAB_2014_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2014_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2014_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2014_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2014_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2014_GERAL$Superior_completo <- NA

RS22_ANTRAB_2014_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2014_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2014_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2014_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2014_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2014_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2014_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2014_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2014_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2014_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2014_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2014_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2014_GERAL[which(RS22_ANTRAB_2014_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2014_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2014_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2014_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2014_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_EXPOSICAO <- RS22_ANTRAB_2014_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2014_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2014_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2014_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2014_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_EXPOSICAO[which(RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2014_EXPOSICAO[which(RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_EXPOSICAO[which(RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_EXPOSICAO[which(RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_EXPOSICAO[which(RS22_ANTRAB_2014_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2014_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2014_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2014_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2014_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_LOCALIZACAO <- RS22_ANTRAB_2014_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2014_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2014_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2014_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2014_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2014_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2014_LOCALIZACAO[which(RS22_ANTRAB_2014_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2014_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2014_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2014_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2014_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_FERIMENTO <- RS22_ANTRAB_2014_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_FERIMENTO$Unico <- NA

RS22_ANTRAB_2014_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2014_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2014_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_FERIMENTO[which(RS22_ANTRAB_2014_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2014_FERIMENTO[which(RS22_ANTRAB_2014_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_FERIMENTO[which(RS22_ANTRAB_2014_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_FERIMENTO[which(RS22_ANTRAB_2014_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2014_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2014_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2014_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2014_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_TIPO_FERIMENTO <- RS22_ANTRAB_2014_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2014_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2014_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_TIPO_FERIMENTO[which(RS22_ANTRAB_2014_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2014_TIPO_FERIMENTO[which(RS22_ANTRAB_2014_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2014_TIPO_FERIMENTO[which(RS22_ANTRAB_2014_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2014_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2014_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2014_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2014_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_ANTECEDENTE_ANTR <- RS22_ANTRAB_2014_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2014_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2014_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2014_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2014_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2014_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2014_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2014_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2014_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_AGRESSOR <- RS22_ANTRAB_2014_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_AGRESSOR$Canina <- NA

RS22_ANTRAB_2014_AGRESSOR$Felina <- NA

RS22_ANTRAB_2014_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2014_AGRESSOR$Primata <- NA

RS22_ANTRAB_2014_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2014_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2014_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2014_AGRESSOR[which(RS22_ANTRAB_2014_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2014_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2014_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2014_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2014_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_COND_ANIMAL_ACID <- RS22_ANTRAB_2014_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2014_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2014_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2014_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_COND_ANIMAL_ACID[which(RS22_ANTRAB_2014_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2014_COND_ANIMAL_ACID[which(RS22_ANTRAB_2014_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2014_COND_ANIMAL_ACID[which(RS22_ANTRAB_2014_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2014_COND_ANIMAL_ACID[which(RS22_ANTRAB_2014_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2014_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2014_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2014_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2014_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_OBSERVAVEL <- RS22_ANTRAB_2014_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2014_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_OBSERVAVEL[which(RS22_ANTRAB_2014_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2014_OBSERVAVEL[which(RS22_ANTRAB_2014_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2014_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2014_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2014_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2014_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_TRATAMENTO <- RS22_ANTRAB_2014_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2014_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2014_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2014_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2014_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2014_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2014_TRATAMENTO[which(RS22_ANTRAB_2014_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2014_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2014_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2014_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2014_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_COND_FINAL_ANIMAL<- RS22_ANTRAB_2014_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2014_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2014_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2014_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2014_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2014_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2014_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2014_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_INTERRUPCAO_TRAT <- RS22_ANTRAB_2014_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2014_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2014_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2014_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2014_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2014_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2014_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2014_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2014_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_SOROTERAPIA <- RS22_ANTRAB_2014_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2014_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2014_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_SOROTERAPIA[which(RS22_ANTRAB_2014_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2014_SOROTERAPIA[which(RS22_ANTRAB_2014_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2014_SOROTERAPIA[which(RS22_ANTRAB_2014_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2014_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2014_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2014_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2014_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2014_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2014_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2014_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2014_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2014_SORO_INFILTRACAO  <- RS22_ANTRAB_2014_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2014_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2014_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2014_SORO_INFILTRACAO[which(RS22_ANTRAB_2014_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2014_SORO_INFILTRACAO[which(RS22_ANTRAB_2014_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2014 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2014_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2014_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2014_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2014)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2015 <- read.dbf(file = "ANTRANET2015.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[4, 2] <- as.integer(ANTRAB2015 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2015$ID_MN_RESI <- as.numeric(as.character(ANTRAB2015$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2015 <- ANTRAB2015 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2015_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2015_SE_Notificados <- as.data.frame(RS22_ANTRAB_2015_SE_Notificados)

colnames(RS22_ANTRAB_2015_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2015_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2015_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2015_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201501)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201502) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201503) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201504) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201505) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201506) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201507) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201508) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201509) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201510) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201511) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201512) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201513) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201514) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201515) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201516) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201517) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201518) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201519) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201520) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201521) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201522) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201523) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201524) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201525) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201526) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201527) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201528) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201529) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201530) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201531) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201532) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201533) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201534) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201535) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201536) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201537) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201538) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201539) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201540) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201541) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201542) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201543) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201544) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201545) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201546) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201547) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201548) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201549) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201550) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201551) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2015 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201552) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2015_SE_Notificados[which(RS22_ANTRAB_2015_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201553) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2015_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2015_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2015_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2015_SE_Notificados[17,1] <- "Total"


#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2015_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_GERAL <- RS22_ANTRAB_2015_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_GERAL$Notificados <- NA

RS22_ANTRAB_2015_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2015_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2015_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2015_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2015_GERAL$Feminino <- NA

RS22_ANTRAB_2015_GERAL$Masculino <- NA

RS22_ANTRAB_2015_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2015_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2015_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2015_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2015_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2015_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2015_GERAL$Analfabeto <- NA

RS22_ANTRAB_2015_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2015_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2015_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2015_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2015_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2015_GERAL$Superior_completo <- NA

RS22_ANTRAB_2015_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2015_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2015_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2015_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2015_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2015_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2015_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2015_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2015_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2015_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2015_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2015_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2015_GERAL[which(RS22_ANTRAB_2015_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2015_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2015_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2015_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2015_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_EXPOSICAO <- RS22_ANTRAB_2015_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2015_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2015_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2015_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2015_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_EXPOSICAO[which(RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2015_EXPOSICAO[which(RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_EXPOSICAO[which(RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_EXPOSICAO[which(RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_EXPOSICAO[which(RS22_ANTRAB_2015_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2015_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2015_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2015_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2015_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_LOCALIZACAO <- RS22_ANTRAB_2015_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2015_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2015_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2015_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2015_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2015_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2015_LOCALIZACAO[which(RS22_ANTRAB_2015_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2015_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2015_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2015_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2015_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_FERIMENTO <- RS22_ANTRAB_2015_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_FERIMENTO$Unico <- NA

RS22_ANTRAB_2015_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2015_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2015_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_FERIMENTO[which(RS22_ANTRAB_2015_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2015_FERIMENTO[which(RS22_ANTRAB_2015_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_FERIMENTO[which(RS22_ANTRAB_2015_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_FERIMENTO[which(RS22_ANTRAB_2015_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2015_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2015_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2015_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2015_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_TIPO_FERIMENTO <- RS22_ANTRAB_2015_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2015_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2015_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_TIPO_FERIMENTO[which(RS22_ANTRAB_2015_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2015_TIPO_FERIMENTO[which(RS22_ANTRAB_2015_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2015_TIPO_FERIMENTO[which(RS22_ANTRAB_2015_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2015_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2015_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2015_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2015_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_ANTECEDENTE_ANTR <- RS22_ANTRAB_2015_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2015_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2015_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2015_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2015_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2015_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2015_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2015_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2015_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_AGRESSOR <- RS22_ANTRAB_2015_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_AGRESSOR$Canina <- NA

RS22_ANTRAB_2015_AGRESSOR$Felina <- NA

RS22_ANTRAB_2015_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2015_AGRESSOR$Primata <- NA

RS22_ANTRAB_2015_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2015_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2015_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2015_AGRESSOR[which(RS22_ANTRAB_2015_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2015_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2015_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2015_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2015_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_COND_ANIMAL_ACID <- RS22_ANTRAB_2015_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2015_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2015_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2015_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_COND_ANIMAL_ACID[which(RS22_ANTRAB_2015_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2015_COND_ANIMAL_ACID[which(RS22_ANTRAB_2015_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2015_COND_ANIMAL_ACID[which(RS22_ANTRAB_2015_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2015_COND_ANIMAL_ACID[which(RS22_ANTRAB_2015_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2015_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2015_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2015_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2015_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_OBSERVAVEL <- RS22_ANTRAB_2015_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2015_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_OBSERVAVEL[which(RS22_ANTRAB_2015_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2015_OBSERVAVEL[which(RS22_ANTRAB_2015_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2015_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2015_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2015_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2015_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_TRATAMENTO <- RS22_ANTRAB_2015_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2015_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2015_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2015_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2015_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2015_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2015_TRATAMENTO[which(RS22_ANTRAB_2015_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2015_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2015_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2015_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2015_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_COND_FINAL_ANIMAL<- RS22_ANTRAB_2015_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2015_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2015_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2015_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2015_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2015_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2015_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2015_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_INTERRUPCAO_TRAT <- RS22_ANTRAB_2015_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2015_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2015_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2015_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2015_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2015_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2015_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2015_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2015_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_SOROTERAPIA <- RS22_ANTRAB_2015_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2015_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2015_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_SOROTERAPIA[which(RS22_ANTRAB_2015_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2015_SOROTERAPIA[which(RS22_ANTRAB_2015_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2015_SOROTERAPIA[which(RS22_ANTRAB_2015_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2015_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2015_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2015_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2015_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2015_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2015_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2015_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2015_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2015_SORO_INFILTRACAO  <- RS22_ANTRAB_2015_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2015_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2015_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2015_SORO_INFILTRACAO[which(RS22_ANTRAB_2015_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2015_SORO_INFILTRACAO[which(RS22_ANTRAB_2015_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2015 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2015_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2015_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2015_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2015)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2016 <- read.dbf(file = "ANTRANET2016.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[5, 2] <- as.integer(ANTRAB2016 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2016$ID_MN_RESI <- as.numeric(as.character(ANTRAB2016$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2016 <- ANTRAB2016 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2016_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2016_SE_Notificados <- as.data.frame(RS22_ANTRAB_2016_SE_Notificados)

colnames(RS22_ANTRAB_2016_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2016_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2016_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2016_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201601)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201602) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201603) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201604) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201605) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201606) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201607) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201608) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201609) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201610) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201611) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201612) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201613) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201614) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201615) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201616) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201617) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201618) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201619) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201620) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201621) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201622) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201623) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201624) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201625) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201626) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201627) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201628) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201629) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201630) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201631) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201632) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201633) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201634) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201635) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201636) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201637) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201638) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201639) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201640) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201641) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201642) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201643) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201644) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201645) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201646) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201647) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201648) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201649) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201650) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201651) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2016 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201652) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2016_SE_Notificados[which(RS22_ANTRAB_2016_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201653) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2016_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2016_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2016_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2016_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2016_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_GERAL <- RS22_ANTRAB_2016_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_GERAL$Notificados <- NA

RS22_ANTRAB_2016_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2016_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2016_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2016_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2016_GERAL$Feminino <- NA

RS22_ANTRAB_2016_GERAL$Masculino <- NA

RS22_ANTRAB_2016_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2016_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2016_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2016_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2016_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2016_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2016_GERAL$Analfabeto <- NA

RS22_ANTRAB_2016_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2016_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2016_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2016_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2016_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2016_GERAL$Superior_completo <- NA

RS22_ANTRAB_2016_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2016_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2016_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2016_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2016_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2016_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2016_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2016_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2016_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2016_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2016_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2016_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2016_GERAL[which(RS22_ANTRAB_2016_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2016_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2016_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2016_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2016_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_EXPOSICAO <- RS22_ANTRAB_2016_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2016_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2016_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2016_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2016_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_EXPOSICAO[which(RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2016_EXPOSICAO[which(RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_EXPOSICAO[which(RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_EXPOSICAO[which(RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_EXPOSICAO[which(RS22_ANTRAB_2016_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2016_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2016_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2016_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2016_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_LOCALIZACAO <- RS22_ANTRAB_2016_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2016_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2016_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2016_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2016_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2016_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2016_LOCALIZACAO[which(RS22_ANTRAB_2016_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2016_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2016_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2016_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2016_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_FERIMENTO <- RS22_ANTRAB_2016_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_FERIMENTO$Unico <- NA

RS22_ANTRAB_2016_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2016_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2016_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_FERIMENTO[which(RS22_ANTRAB_2016_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2016_FERIMENTO[which(RS22_ANTRAB_2016_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_FERIMENTO[which(RS22_ANTRAB_2016_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_FERIMENTO[which(RS22_ANTRAB_2016_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2016_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2016_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2016_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2016_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_TIPO_FERIMENTO <- RS22_ANTRAB_2016_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2016_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2016_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_TIPO_FERIMENTO[which(RS22_ANTRAB_2016_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2016_TIPO_FERIMENTO[which(RS22_ANTRAB_2016_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2016_TIPO_FERIMENTO[which(RS22_ANTRAB_2016_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2016_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2016_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2016_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2016_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_ANTECEDENTE_ANTR <- RS22_ANTRAB_2016_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2016_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2016_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2016_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2016_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2016_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2016_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2016_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2016_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_AGRESSOR <- RS22_ANTRAB_2016_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_AGRESSOR$Canina <- NA

RS22_ANTRAB_2016_AGRESSOR$Felina <- NA

RS22_ANTRAB_2016_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2016_AGRESSOR$Primata <- NA

RS22_ANTRAB_2016_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2016_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2016_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2016_AGRESSOR[which(RS22_ANTRAB_2016_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2016_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2016_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2016_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2016_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_COND_ANIMAL_ACID <- RS22_ANTRAB_2016_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2016_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2016_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2016_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_COND_ANIMAL_ACID[which(RS22_ANTRAB_2016_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2016_COND_ANIMAL_ACID[which(RS22_ANTRAB_2016_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2016_COND_ANIMAL_ACID[which(RS22_ANTRAB_2016_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2016_COND_ANIMAL_ACID[which(RS22_ANTRAB_2016_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2016_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2016_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2016_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2016_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_OBSERVAVEL <- RS22_ANTRAB_2016_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2016_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_OBSERVAVEL[which(RS22_ANTRAB_2016_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2016_OBSERVAVEL[which(RS22_ANTRAB_2016_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2016_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2016_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2016_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2016_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_TRATAMENTO <- RS22_ANTRAB_2016_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2016_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2016_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2016_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2016_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2016_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2016_TRATAMENTO[which(RS22_ANTRAB_2016_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2016_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2016_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2016_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2016_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_COND_FINAL_ANIMAL<- RS22_ANTRAB_2016_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2016_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2016_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2016_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2016_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2016_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2016_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2016_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_INTERRUPCAO_TRAT <- RS22_ANTRAB_2016_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2016_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2016_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2016_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2016_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2016_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2016_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2016_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2016_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_SOROTERAPIA <- RS22_ANTRAB_2016_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2016_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2016_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_SOROTERAPIA[which(RS22_ANTRAB_2016_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2016_SOROTERAPIA[which(RS22_ANTRAB_2016_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2016_SOROTERAPIA[which(RS22_ANTRAB_2016_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2016_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2016_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2016_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2016_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2016_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2016_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2016_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2016_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2016_SORO_INFILTRACAO  <- RS22_ANTRAB_2016_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2016_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2016_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2016_SORO_INFILTRACAO[which(RS22_ANTRAB_2016_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2016_SORO_INFILTRACAO[which(RS22_ANTRAB_2016_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2016 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2016_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2016_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2016_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2016)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2017 <- read.dbf(file = "ANTRANET2017.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[6, 2] <- as.integer(ANTRAB2017 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2017$ID_MN_RESI <- as.numeric(as.character(ANTRAB2017$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2017 <- ANTRAB2017 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2017_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2017_SE_Notificados <- as.data.frame(RS22_ANTRAB_2017_SE_Notificados)

colnames(RS22_ANTRAB_2017_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2017_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2017_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2017_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201701)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201702) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201703) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201704) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201705) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201706) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201707) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201708) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201709) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201710) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201711) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201712) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201713) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201714) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201715) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201716) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201717) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201718) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201719) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201720) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201721) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201722) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201723) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201724) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201725) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201726) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201727) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201728) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201729) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201730) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201731) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201732) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201733) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201734) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201735) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201736) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201737) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201738) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201739) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201740) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201741) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201742) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201743) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201744) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201745) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201746) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201747) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201748) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201749) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201750) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201751) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2017 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201752) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2017_SE_Notificados[which(RS22_ANTRAB_2017_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201753) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2017_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2017_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2017_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2017_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2017_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_GERAL <- RS22_ANTRAB_2017_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_GERAL$Notificados <- NA

RS22_ANTRAB_2017_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2017_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2017_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2017_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2017_GERAL$Feminino <- NA

RS22_ANTRAB_2017_GERAL$Masculino <- NA

RS22_ANTRAB_2017_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2017_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2017_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2017_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2017_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2017_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2017_GERAL$Analfabeto <- NA

RS22_ANTRAB_2017_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2017_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2017_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2017_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2017_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2017_GERAL$Superior_completo <- NA

RS22_ANTRAB_2017_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2017_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2017_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2017_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2017_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2017_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2017_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2017_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2017_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2017_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2017_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2017_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2017_GERAL[which(RS22_ANTRAB_2017_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2017_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2017_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2017_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2017_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_EXPOSICAO <- RS22_ANTRAB_2017_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2017_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2017_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2017_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2017_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_EXPOSICAO[which(RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2017_EXPOSICAO[which(RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_EXPOSICAO[which(RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_EXPOSICAO[which(RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_EXPOSICAO[which(RS22_ANTRAB_2017_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2017_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2017_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2017_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2017_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_LOCALIZACAO <- RS22_ANTRAB_2017_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2017_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2017_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2017_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2017_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2017_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2017_LOCALIZACAO[which(RS22_ANTRAB_2017_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2017_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2017_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2017_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2017_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_FERIMENTO <- RS22_ANTRAB_2017_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_FERIMENTO$Unico <- NA

RS22_ANTRAB_2017_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2017_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2017_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_FERIMENTO[which(RS22_ANTRAB_2017_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2017_FERIMENTO[which(RS22_ANTRAB_2017_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_FERIMENTO[which(RS22_ANTRAB_2017_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_FERIMENTO[which(RS22_ANTRAB_2017_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2017_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2017_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2017_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2017_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_TIPO_FERIMENTO <- RS22_ANTRAB_2017_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2017_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2017_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_TIPO_FERIMENTO[which(RS22_ANTRAB_2017_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2017_TIPO_FERIMENTO[which(RS22_ANTRAB_2017_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2017_TIPO_FERIMENTO[which(RS22_ANTRAB_2017_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2017_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2017_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2017_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2017_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_ANTECEDENTE_ANTR <- RS22_ANTRAB_2017_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2017_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2017_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2017_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2017_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2017_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2017_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2017_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2017_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_AGRESSOR <- RS22_ANTRAB_2017_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_AGRESSOR$Canina <- NA

RS22_ANTRAB_2017_AGRESSOR$Felina <- NA

RS22_ANTRAB_2017_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2017_AGRESSOR$Primata <- NA

RS22_ANTRAB_2017_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2017_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2017_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2017_AGRESSOR[which(RS22_ANTRAB_2017_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2017_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2017_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2017_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2017_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_COND_ANIMAL_ACID <- RS22_ANTRAB_2017_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2017_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2017_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2017_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_COND_ANIMAL_ACID[which(RS22_ANTRAB_2017_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2017_COND_ANIMAL_ACID[which(RS22_ANTRAB_2017_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2017_COND_ANIMAL_ACID[which(RS22_ANTRAB_2017_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2017_COND_ANIMAL_ACID[which(RS22_ANTRAB_2017_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2017_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2017_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2017_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2017_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_OBSERVAVEL <- RS22_ANTRAB_2017_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2017_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_OBSERVAVEL[which(RS22_ANTRAB_2017_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2017_OBSERVAVEL[which(RS22_ANTRAB_2017_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2017_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2017_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2017_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2017_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_TRATAMENTO <- RS22_ANTRAB_2017_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2017_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2017_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2017_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2017_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2017_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2017_TRATAMENTO[which(RS22_ANTRAB_2017_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2017_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2017_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2017_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2017_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_COND_FINAL_ANIMAL<- RS22_ANTRAB_2017_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2017_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2017_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2017_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2017_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2017_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2017_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2017_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_INTERRUPCAO_TRAT <- RS22_ANTRAB_2017_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2017_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2017_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2017_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2017_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2017_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2017_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2017_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2017_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_SOROTERAPIA <- RS22_ANTRAB_2017_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2017_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2017_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_SOROTERAPIA[which(RS22_ANTRAB_2017_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2017_SOROTERAPIA[which(RS22_ANTRAB_2017_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2017_SOROTERAPIA[which(RS22_ANTRAB_2017_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2017_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2017_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2017_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2017_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2017_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2017_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2017_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2017_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2017_SORO_INFILTRACAO  <- RS22_ANTRAB_2017_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2017_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2017_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2017_SORO_INFILTRACAO[which(RS22_ANTRAB_2017_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2017_SORO_INFILTRACAO[which(RS22_ANTRAB_2017_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2017 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2017_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2017_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2017_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2017)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2018 <- read.dbf(file = "ANTRANET2018.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[7, 2] <- as.integer(ANTRAB2018 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2018$ID_MN_RESI <- as.numeric(as.character(ANTRAB2018$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2018 <- ANTRAB2018 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2018_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2018_SE_Notificados <- as.data.frame(RS22_ANTRAB_2018_SE_Notificados)

colnames(RS22_ANTRAB_2018_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2018_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2018_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2018_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201801)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201802) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201803) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201804) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201805) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201806) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201807) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201808) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201809) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201810) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201811) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201812) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201813) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201814) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201815) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201816) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201817) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201818) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201819) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201820) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201821) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201822) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201823) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201824) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201825) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201826) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201827) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201828) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201829) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201830) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201831) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201832) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201833) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201834) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201835) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201836) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201837) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201838) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201839) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201840) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201841) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201842) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201843) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201844) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201845) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201846) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201847) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201848) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201849) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201850) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201851) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2018 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201852) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2018_SE_Notificados[which(RS22_ANTRAB_2018_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201853) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2018_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2018_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2018_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2018_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2018_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_GERAL <- RS22_ANTRAB_2018_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_GERAL$Notificados <- NA

RS22_ANTRAB_2018_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2018_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2018_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2018_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2018_GERAL$Feminino <- NA

RS22_ANTRAB_2018_GERAL$Masculino <- NA

RS22_ANTRAB_2018_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2018_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2018_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2018_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2018_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2018_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2018_GERAL$Analfabeto <- NA

RS22_ANTRAB_2018_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2018_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2018_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2018_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2018_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2018_GERAL$Superior_completo <- NA

RS22_ANTRAB_2018_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2018_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2018_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2018_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2018_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2018_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2018_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2018_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2018_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2018_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2018_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2018_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2018_GERAL[which(RS22_ANTRAB_2018_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2018_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2018_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2018_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2018_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_EXPOSICAO <- RS22_ANTRAB_2018_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2018_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2018_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2018_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2018_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_EXPOSICAO[which(RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2018_EXPOSICAO[which(RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_EXPOSICAO[which(RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_EXPOSICAO[which(RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_EXPOSICAO[which(RS22_ANTRAB_2018_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2018_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2018_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2018_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2018_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_LOCALIZACAO <- RS22_ANTRAB_2018_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2018_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2018_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2018_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2018_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2018_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2018_LOCALIZACAO[which(RS22_ANTRAB_2018_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2018_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2018_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2018_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2018_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_FERIMENTO <- RS22_ANTRAB_2018_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_FERIMENTO$Unico <- NA

RS22_ANTRAB_2018_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2018_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2018_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_FERIMENTO[which(RS22_ANTRAB_2018_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2018_FERIMENTO[which(RS22_ANTRAB_2018_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_FERIMENTO[which(RS22_ANTRAB_2018_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_FERIMENTO[which(RS22_ANTRAB_2018_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2018_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2018_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2018_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2018_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_TIPO_FERIMENTO <- RS22_ANTRAB_2018_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2018_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2018_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_TIPO_FERIMENTO[which(RS22_ANTRAB_2018_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2018_TIPO_FERIMENTO[which(RS22_ANTRAB_2018_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2018_TIPO_FERIMENTO[which(RS22_ANTRAB_2018_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2018_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2018_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2018_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2018_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_ANTECEDENTE_ANTR <- RS22_ANTRAB_2018_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2018_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2018_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2018_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2018_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2018_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2018_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2018_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2018_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_AGRESSOR <- RS22_ANTRAB_2018_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_AGRESSOR$Canina <- NA

RS22_ANTRAB_2018_AGRESSOR$Felina <- NA

RS22_ANTRAB_2018_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2018_AGRESSOR$Primata <- NA

RS22_ANTRAB_2018_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2018_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2018_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2018_AGRESSOR[which(RS22_ANTRAB_2018_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2018_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2018_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2018_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2018_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_COND_ANIMAL_ACID <- RS22_ANTRAB_2018_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2018_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2018_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2018_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_COND_ANIMAL_ACID[which(RS22_ANTRAB_2018_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2018_COND_ANIMAL_ACID[which(RS22_ANTRAB_2018_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2018_COND_ANIMAL_ACID[which(RS22_ANTRAB_2018_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2018_COND_ANIMAL_ACID[which(RS22_ANTRAB_2018_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2018_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2018_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2018_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2018_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_OBSERVAVEL <- RS22_ANTRAB_2018_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2018_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_OBSERVAVEL[which(RS22_ANTRAB_2018_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2018_OBSERVAVEL[which(RS22_ANTRAB_2018_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2018_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2018_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2018_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2018_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_TRATAMENTO <- RS22_ANTRAB_2018_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2018_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2018_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2018_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2018_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2018_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2018_TRATAMENTO[which(RS22_ANTRAB_2018_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2018_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2018_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2018_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2018_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_COND_FINAL_ANIMAL<- RS22_ANTRAB_2018_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2018_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2018_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2018_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2018_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2018_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2018_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2018_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_INTERRUPCAO_TRAT <- RS22_ANTRAB_2018_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2018_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2018_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2018_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2018_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2018_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2018_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2018_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2018_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_SOROTERAPIA <- RS22_ANTRAB_2018_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2018_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2018_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_SOROTERAPIA[which(RS22_ANTRAB_2018_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2018_SOROTERAPIA[which(RS22_ANTRAB_2018_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2018_SOROTERAPIA[which(RS22_ANTRAB_2018_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2018_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2018_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2018_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2018_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2018_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2018_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2018_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2018_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2018_SORO_INFILTRACAO  <- RS22_ANTRAB_2018_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2018_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2018_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2018_SORO_INFILTRACAO[which(RS22_ANTRAB_2018_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2018_SORO_INFILTRACAO[which(RS22_ANTRAB_2018_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2018 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2018_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2018_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2018_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2018)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2019 <- read.dbf(file = "ANTRANET2019.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[8, 2] <- as.integer(ANTRAB2019 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2019$ID_MN_RESI <- as.numeric(as.character(ANTRAB2019$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2019 <- ANTRAB2019 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2019_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2019_SE_Notificados <- as.data.frame(RS22_ANTRAB_2019_SE_Notificados)

colnames(RS22_ANTRAB_2019_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2019_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2019_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2019_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201901)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201902) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201903) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==201904) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==201905) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201906) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201907) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==201908) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201909) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201910) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201911) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201912) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201913) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201914) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201915) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201916) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201917) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201918) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201919) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==201920) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201921) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201922) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201923) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201924) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201925) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201926) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201927) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201928) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201929) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201930) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201931) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201932) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201933) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201934) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201935) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201936) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201937) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201938) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201939) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201940) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201941) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201942) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201943) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201944) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201945) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201946) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201947) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201948) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201949) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201950) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201951) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2019 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==201952) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2019_SE_Notificados[which(RS22_ANTRAB_2019_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==201953) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2019_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2019_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2019_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2019_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2019_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_GERAL <- RS22_ANTRAB_2019_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_GERAL$Notificados <- NA

RS22_ANTRAB_2019_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2019_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2019_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2019_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2019_GERAL$Feminino <- NA

RS22_ANTRAB_2019_GERAL$Masculino <- NA

RS22_ANTRAB_2019_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2019_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2019_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2019_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2019_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2019_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2019_GERAL$Analfabeto <- NA

RS22_ANTRAB_2019_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2019_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2019_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2019_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2019_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2019_GERAL$Superior_completo <- NA

RS22_ANTRAB_2019_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2019_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2019_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2019_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2019_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2019_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2019_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2019_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2019_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2019_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2019_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2019_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2019_GERAL[which(RS22_ANTRAB_2019_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2019_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2019_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2019_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2019_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_EXPOSICAO <- RS22_ANTRAB_2019_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2019_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2019_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2019_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2019_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_EXPOSICAO[which(RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2019_EXPOSICAO[which(RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_EXPOSICAO[which(RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_EXPOSICAO[which(RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_EXPOSICAO[which(RS22_ANTRAB_2019_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2019_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2019_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2019_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2019_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_LOCALIZACAO <- RS22_ANTRAB_2019_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2019_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2019_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2019_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2019_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2019_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2019_LOCALIZACAO[which(RS22_ANTRAB_2019_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2019_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2019_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2019_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2019_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_FERIMENTO <- RS22_ANTRAB_2019_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_FERIMENTO$Unico <- NA

RS22_ANTRAB_2019_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2019_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2019_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_FERIMENTO[which(RS22_ANTRAB_2019_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2019_FERIMENTO[which(RS22_ANTRAB_2019_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_FERIMENTO[which(RS22_ANTRAB_2019_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_FERIMENTO[which(RS22_ANTRAB_2019_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2019_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2019_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2019_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2019_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_TIPO_FERIMENTO <- RS22_ANTRAB_2019_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2019_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2019_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_TIPO_FERIMENTO[which(RS22_ANTRAB_2019_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2019_TIPO_FERIMENTO[which(RS22_ANTRAB_2019_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2019_TIPO_FERIMENTO[which(RS22_ANTRAB_2019_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2019_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2019_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2019_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2019_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_ANTECEDENTE_ANTR <- RS22_ANTRAB_2019_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2019_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2019_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2019_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2019_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2019_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2019_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2019_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2019_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_AGRESSOR <- RS22_ANTRAB_2019_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_AGRESSOR$Canina <- NA

RS22_ANTRAB_2019_AGRESSOR$Felina <- NA

RS22_ANTRAB_2019_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2019_AGRESSOR$Primata <- NA

RS22_ANTRAB_2019_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2019_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2019_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2019_AGRESSOR[which(RS22_ANTRAB_2019_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2019_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2019_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2019_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2019_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_COND_ANIMAL_ACID <- RS22_ANTRAB_2019_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2019_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2019_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2019_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_COND_ANIMAL_ACID[which(RS22_ANTRAB_2019_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2019_COND_ANIMAL_ACID[which(RS22_ANTRAB_2019_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2019_COND_ANIMAL_ACID[which(RS22_ANTRAB_2019_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2019_COND_ANIMAL_ACID[which(RS22_ANTRAB_2019_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2019_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2019_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2019_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2019_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_OBSERVAVEL <- RS22_ANTRAB_2019_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2019_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_OBSERVAVEL[which(RS22_ANTRAB_2019_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2019_OBSERVAVEL[which(RS22_ANTRAB_2019_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2019_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2019_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2019_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2019_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_TRATAMENTO <- RS22_ANTRAB_2019_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2019_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2019_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2019_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2019_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2019_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2019_TRATAMENTO[which(RS22_ANTRAB_2019_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2019_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2019_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2019_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2019_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_COND_FINAL_ANIMAL<- RS22_ANTRAB_2019_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2019_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2019_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2019_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2019_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2019_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2019_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2019_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_INTERRUPCAO_TRAT <- RS22_ANTRAB_2019_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2019_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2019_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2019_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2019_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2019_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2019_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2019_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2019_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_SOROTERAPIA <- RS22_ANTRAB_2019_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2019_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2019_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_SOROTERAPIA[which(RS22_ANTRAB_2019_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2019_SOROTERAPIA[which(RS22_ANTRAB_2019_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2019_SOROTERAPIA[which(RS22_ANTRAB_2019_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2019_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2019_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2019_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2019_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2019_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2019_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2019_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2019_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2019_SORO_INFILTRACAO  <- RS22_ANTRAB_2019_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2019_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2019_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2019_SORO_INFILTRACAO[which(RS22_ANTRAB_2019_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2019_SORO_INFILTRACAO[which(RS22_ANTRAB_2019_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2019 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2019_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2019_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2019_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2019)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2020 <- read.dbf(file = "ANTRANET2020.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[9, 2] <- as.integer(ANTRAB2020 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2020$ID_MN_RESI <- as.numeric(as.character(ANTRAB2020$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2020 <- ANTRAB2020 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2020_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2020_SE_Notificados <- as.data.frame(RS22_ANTRAB_2020_SE_Notificados)

colnames(RS22_ANTRAB_2020_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2020_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2020_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2020_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202001)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202002) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202003) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==202004) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202005) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202006) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202007) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202008) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202009) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202010) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202011) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202012) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202013) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202014) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202015) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202016) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202017) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202018) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202019) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==202020) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202021) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202022) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202023) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202024) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202025) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202026) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202027) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202028) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202029) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202030) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202031) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202032) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202033) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202034) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202035) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202036) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202037) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202038) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202039) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202040) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202041) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202042) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202043) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202044) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202045) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202046) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202047) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202048) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202049) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202050) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202051) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2020 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202052) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2020_SE_Notificados[which(RS22_ANTRAB_2020_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202053) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2020_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2020_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2020_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2020_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2020_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_GERAL <- RS22_ANTRAB_2020_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_GERAL$Notificados <- NA

RS22_ANTRAB_2020_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2020_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2020_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2020_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2020_GERAL$Feminino <- NA

RS22_ANTRAB_2020_GERAL$Masculino <- NA

RS22_ANTRAB_2020_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2020_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2020_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2020_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2020_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2020_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2020_GERAL$Analfabeto <- NA

RS22_ANTRAB_2020_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2020_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2020_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2020_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2020_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2020_GERAL$Superior_completo <- NA

RS22_ANTRAB_2020_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2020_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2020_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2020_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2020_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2020_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2020_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2020_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2020_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2020_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2020_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2020_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2020_GERAL[which(RS22_ANTRAB_2020_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2020_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2020_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2020_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2020_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_EXPOSICAO <- RS22_ANTRAB_2020_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2020_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2020_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2020_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2020_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_EXPOSICAO[which(RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2020_EXPOSICAO[which(RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_EXPOSICAO[which(RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_EXPOSICAO[which(RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_EXPOSICAO[which(RS22_ANTRAB_2020_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2020_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2020_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2020_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2020_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_LOCALIZACAO <- RS22_ANTRAB_2020_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2020_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2020_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2020_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2020_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2020_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2020_LOCALIZACAO[which(RS22_ANTRAB_2020_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2020_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2020_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2020_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2020_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_FERIMENTO <- RS22_ANTRAB_2020_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_FERIMENTO$Unico <- NA

RS22_ANTRAB_2020_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2020_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2020_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_FERIMENTO[which(RS22_ANTRAB_2020_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2020_FERIMENTO[which(RS22_ANTRAB_2020_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_FERIMENTO[which(RS22_ANTRAB_2020_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_FERIMENTO[which(RS22_ANTRAB_2020_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2020_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2020_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2020_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2020_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_TIPO_FERIMENTO <- RS22_ANTRAB_2020_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2020_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2020_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_TIPO_FERIMENTO[which(RS22_ANTRAB_2020_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2020_TIPO_FERIMENTO[which(RS22_ANTRAB_2020_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2020_TIPO_FERIMENTO[which(RS22_ANTRAB_2020_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2020_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2020_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2020_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2020_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_ANTECEDENTE_ANTR <- RS22_ANTRAB_2020_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2020_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2020_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2020_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2020_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2020_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2020_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2020_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2020_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_AGRESSOR <- RS22_ANTRAB_2020_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_AGRESSOR$Canina <- NA

RS22_ANTRAB_2020_AGRESSOR$Felina <- NA

RS22_ANTRAB_2020_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2020_AGRESSOR$Primata <- NA

RS22_ANTRAB_2020_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2020_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2020_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2020_AGRESSOR[which(RS22_ANTRAB_2020_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2020_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2020_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2020_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2020_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_COND_ANIMAL_ACID <- RS22_ANTRAB_2020_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2020_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2020_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2020_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_COND_ANIMAL_ACID[which(RS22_ANTRAB_2020_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2020_COND_ANIMAL_ACID[which(RS22_ANTRAB_2020_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2020_COND_ANIMAL_ACID[which(RS22_ANTRAB_2020_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2020_COND_ANIMAL_ACID[which(RS22_ANTRAB_2020_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2020_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2020_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2020_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2020_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_OBSERVAVEL <- RS22_ANTRAB_2020_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2020_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_OBSERVAVEL[which(RS22_ANTRAB_2020_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2020_OBSERVAVEL[which(RS22_ANTRAB_2020_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2020_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2020_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2020_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2020_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_TRATAMENTO <- RS22_ANTRAB_2020_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2020_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2020_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2020_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2020_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2020_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2020_TRATAMENTO[which(RS22_ANTRAB_2020_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2020_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2020_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2020_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2020_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_COND_FINAL_ANIMAL<- RS22_ANTRAB_2020_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2020_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2020_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2020_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2020_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2020_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2020_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2020_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_INTERRUPCAO_TRAT <- RS22_ANTRAB_2020_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2020_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2020_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2020_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2020_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2020_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2020_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2020_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2020_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_SOROTERAPIA <- RS22_ANTRAB_2020_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2020_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2020_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_SOROTERAPIA[which(RS22_ANTRAB_2020_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2020_SOROTERAPIA[which(RS22_ANTRAB_2020_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2020_SOROTERAPIA[which(RS22_ANTRAB_2020_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2020_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2020_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2020_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2020_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2020_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2020_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2020_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2020_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2020_SORO_INFILTRACAO  <- RS22_ANTRAB_2020_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2020_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2020_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2020_SORO_INFILTRACAO[which(RS22_ANTRAB_2020_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2020_SORO_INFILTRACAO[which(RS22_ANTRAB_2020_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2020 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2020_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2020_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2020_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2020)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2021 <- read.dbf(file = "ANTRANET2021.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[10, 2] <- as.integer(ANTRAB2021 %>% 
                                                count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2021$ID_MN_RESI <- as.numeric(as.character(ANTRAB2021$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2021 <- ANTRAB2021 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2021_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2021_SE_Notificados <- as.data.frame(RS22_ANTRAB_2021_SE_Notificados)

colnames(RS22_ANTRAB_2021_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2021_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2021_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2021_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202101)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202102) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202103) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==202104) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202105) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202106) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202107) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202108) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202109) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202110) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202111) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202112) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202113) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202114) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202115) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202116) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202117) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202118) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202119) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==202120) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202121) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202122) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202123) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202124) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202125) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202126) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202127) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202128) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202129) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202130) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202131) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202132) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202133) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202134) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202135) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202136) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202137) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202138) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202139) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202140) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202141) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202142) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202143) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202144) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202145) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202146) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202147) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202148) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202149) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202150) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202151) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2021 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202152) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2021_SE_Notificados[which(RS22_ANTRAB_2021_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202153) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2021_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2021_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2021_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2021_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2021_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_GERAL <- RS22_ANTRAB_2021_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_GERAL$Notificados <- NA

RS22_ANTRAB_2021_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2021_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2021_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2021_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2021_GERAL$Feminino <- NA

RS22_ANTRAB_2021_GERAL$Masculino <- NA

RS22_ANTRAB_2021_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2021_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2021_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2021_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2021_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2021_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2021_GERAL$Analfabeto <- NA

RS22_ANTRAB_2021_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2021_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2021_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2021_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2021_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2021_GERAL$Superior_completo <- NA

RS22_ANTRAB_2021_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2021_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2021_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2021_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2021_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2021_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2021_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2021_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2021_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2021_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2021_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2021_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2021_GERAL[which(RS22_ANTRAB_2021_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2021_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2021_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2021_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2021_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_EXPOSICAO <- RS22_ANTRAB_2021_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2021_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2021_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2021_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2021_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_EXPOSICAO[which(RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2021_EXPOSICAO[which(RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_EXPOSICAO[which(RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_EXPOSICAO[which(RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_EXPOSICAO[which(RS22_ANTRAB_2021_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2021_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2021_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2021_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2021_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_LOCALIZACAO <- RS22_ANTRAB_2021_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2021_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2021_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2021_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2021_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2021_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2021_LOCALIZACAO[which(RS22_ANTRAB_2021_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2021_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2021_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2021_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2021_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_FERIMENTO <- RS22_ANTRAB_2021_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_FERIMENTO$Unico <- NA

RS22_ANTRAB_2021_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2021_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2021_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_FERIMENTO[which(RS22_ANTRAB_2021_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2021_FERIMENTO[which(RS22_ANTRAB_2021_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_FERIMENTO[which(RS22_ANTRAB_2021_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_FERIMENTO[which(RS22_ANTRAB_2021_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2021_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2021_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2021_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2021_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_TIPO_FERIMENTO <- RS22_ANTRAB_2021_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2021_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2021_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_TIPO_FERIMENTO[which(RS22_ANTRAB_2021_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2021_TIPO_FERIMENTO[which(RS22_ANTRAB_2021_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2021_TIPO_FERIMENTO[which(RS22_ANTRAB_2021_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2021_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2021_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2021_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2021_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_ANTECEDENTE_ANTR <- RS22_ANTRAB_2021_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2021_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2021_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2021_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2021_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2021_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2021_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2021_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2021_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_AGRESSOR <- RS22_ANTRAB_2021_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_AGRESSOR$Canina <- NA

RS22_ANTRAB_2021_AGRESSOR$Felina <- NA

RS22_ANTRAB_2021_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2021_AGRESSOR$Primata <- NA

RS22_ANTRAB_2021_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2021_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2021_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2021_AGRESSOR[which(RS22_ANTRAB_2021_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2021_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2021_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2021_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2021_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_COND_ANIMAL_ACID <- RS22_ANTRAB_2021_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2021_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2021_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2021_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_COND_ANIMAL_ACID[which(RS22_ANTRAB_2021_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2021_COND_ANIMAL_ACID[which(RS22_ANTRAB_2021_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2021_COND_ANIMAL_ACID[which(RS22_ANTRAB_2021_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2021_COND_ANIMAL_ACID[which(RS22_ANTRAB_2021_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2021_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2021_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2021_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2021_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_OBSERVAVEL <- RS22_ANTRAB_2021_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2021_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_OBSERVAVEL[which(RS22_ANTRAB_2021_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2021_OBSERVAVEL[which(RS22_ANTRAB_2021_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2021_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2021_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2021_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2021_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_TRATAMENTO <- RS22_ANTRAB_2021_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2021_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2021_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2021_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2021_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2021_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2021_TRATAMENTO[which(RS22_ANTRAB_2021_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2021_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2021_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2021_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2021_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_COND_FINAL_ANIMAL<- RS22_ANTRAB_2021_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2021_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2021_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2021_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2021_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2021_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2021_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2021_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_INTERRUPCAO_TRAT <- RS22_ANTRAB_2021_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2021_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2021_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2021_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2021_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2021_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2021_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2021_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2021_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_SOROTERAPIA <- RS22_ANTRAB_2021_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2021_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2021_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_SOROTERAPIA[which(RS22_ANTRAB_2021_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2021_SOROTERAPIA[which(RS22_ANTRAB_2021_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2021_SOROTERAPIA[which(RS22_ANTRAB_2021_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2021_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2021_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2021_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2021_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2021_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2021_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2021_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2021_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2021_SORO_INFILTRACAO  <- RS22_ANTRAB_2021_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2021_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2021_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2021_SORO_INFILTRACAO[which(RS22_ANTRAB_2021_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2021_SORO_INFILTRACAO[which(RS22_ANTRAB_2021_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2021 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2021_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2021_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2021_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2021)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2022 <- read.dbf(file = "ANTRANET2022.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[11, 2] <- as.integer(ANTRAB2022 %>% 
                                                 count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2022$ID_MN_RESI <- as.numeric(as.character(ANTRAB2022$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2022 <- ANTRAB2022 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2022_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2022_SE_Notificados <- as.data.frame(RS22_ANTRAB_2022_SE_Notificados)

colnames(RS22_ANTRAB_2022_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2022_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2022_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2022_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202201)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202202) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202203) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==202204) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202205) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202206) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202207) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202208) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202209) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202210) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202211) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202212) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202213) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202214) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202215) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202216) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202217) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202218) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202219) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==202220) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202221) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202222) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202223) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202224) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202225) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202226) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202227) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202228) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202229) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202230) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202231) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202232) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202233) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202234) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202235) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202236) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202237) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202238) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202239) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202240) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202241) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202242) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202243) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202244) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202245) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202246) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202247) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202248) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202249) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202250) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202251) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2022 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202252) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2022_SE_Notificados[which(RS22_ANTRAB_2022_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202253) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2022_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2022_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2022_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2022_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2022_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_GERAL <- RS22_ANTRAB_2022_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_GERAL$Notificados <- NA

RS22_ANTRAB_2022_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2022_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2022_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2022_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2022_GERAL$Feminino <- NA

RS22_ANTRAB_2022_GERAL$Masculino <- NA

RS22_ANTRAB_2022_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2022_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2022_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2022_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2022_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2022_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2022_GERAL$Analfabeto <- NA

RS22_ANTRAB_2022_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2022_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2022_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2022_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2022_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2022_GERAL$Superior_completo <- NA

RS22_ANTRAB_2022_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2022_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2022_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2022_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2022_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2022_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2022_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2022_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2022_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2022_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2022_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2022_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2022_GERAL[which(RS22_ANTRAB_2022_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2022_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2022_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2022_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2022_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_EXPOSICAO <- RS22_ANTRAB_2022_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2022_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2022_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2022_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2022_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_EXPOSICAO[which(RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2022_EXPOSICAO[which(RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_EXPOSICAO[which(RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_EXPOSICAO[which(RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_EXPOSICAO[which(RS22_ANTRAB_2022_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2022_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2022_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2022_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2022_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_LOCALIZACAO <- RS22_ANTRAB_2022_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2022_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2022_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2022_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2022_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2022_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2022_LOCALIZACAO[which(RS22_ANTRAB_2022_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2022_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2022_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2022_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2022_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_FERIMENTO <- RS22_ANTRAB_2022_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_FERIMENTO$Unico <- NA

RS22_ANTRAB_2022_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2022_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2022_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_FERIMENTO[which(RS22_ANTRAB_2022_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2022_FERIMENTO[which(RS22_ANTRAB_2022_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_FERIMENTO[which(RS22_ANTRAB_2022_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_FERIMENTO[which(RS22_ANTRAB_2022_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2022_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2022_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2022_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2022_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_TIPO_FERIMENTO <- RS22_ANTRAB_2022_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2022_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2022_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_TIPO_FERIMENTO[which(RS22_ANTRAB_2022_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2022_TIPO_FERIMENTO[which(RS22_ANTRAB_2022_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2022_TIPO_FERIMENTO[which(RS22_ANTRAB_2022_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2022_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2022_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2022_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2022_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_ANTECEDENTE_ANTR <- RS22_ANTRAB_2022_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2022_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2022_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2022_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2022_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2022_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2022_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2022_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2022_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_AGRESSOR <- RS22_ANTRAB_2022_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_AGRESSOR$Canina <- NA

RS22_ANTRAB_2022_AGRESSOR$Felina <- NA

RS22_ANTRAB_2022_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2022_AGRESSOR$Primata <- NA

RS22_ANTRAB_2022_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2022_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2022_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2022_AGRESSOR[which(RS22_ANTRAB_2022_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2022_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2022_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2022_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2022_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_COND_ANIMAL_ACID <- RS22_ANTRAB_2022_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2022_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2022_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2022_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_COND_ANIMAL_ACID[which(RS22_ANTRAB_2022_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2022_COND_ANIMAL_ACID[which(RS22_ANTRAB_2022_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2022_COND_ANIMAL_ACID[which(RS22_ANTRAB_2022_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2022_COND_ANIMAL_ACID[which(RS22_ANTRAB_2022_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2022_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2022_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2022_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2022_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_OBSERVAVEL <- RS22_ANTRAB_2022_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2022_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_OBSERVAVEL[which(RS22_ANTRAB_2022_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2022_OBSERVAVEL[which(RS22_ANTRAB_2022_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2022_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2022_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2022_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2022_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_TRATAMENTO <- RS22_ANTRAB_2022_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2022_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2022_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2022_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2022_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2022_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2022_TRATAMENTO[which(RS22_ANTRAB_2022_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2022_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2022_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2022_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2022_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_COND_FINAL_ANIMAL<- RS22_ANTRAB_2022_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2022_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2022_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2022_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2022_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2022_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2022_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2022_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_INTERRUPCAO_TRAT <- RS22_ANTRAB_2022_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2022_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2022_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2022_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2022_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2022_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2022_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2022_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2022_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_SOROTERAPIA <- RS22_ANTRAB_2022_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2022_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2022_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_SOROTERAPIA[which(RS22_ANTRAB_2022_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2022_SOROTERAPIA[which(RS22_ANTRAB_2022_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2022_SOROTERAPIA[which(RS22_ANTRAB_2022_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2022_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2022_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2022_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2022_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2022_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2022_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2022_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2022_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2022_SORO_INFILTRACAO  <- RS22_ANTRAB_2022_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2022_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2022_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2022_SORO_INFILTRACAO[which(RS22_ANTRAB_2022_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2022_SORO_INFILTRACAO[which(RS22_ANTRAB_2022_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2022 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2022_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2022_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2022_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2022)

####Criando um objeto com a base DBF do SINAN#################

ANTRAB2023 <- read.dbf(file = "ANTRANET2023.DBF",
                       as.is = FALSE)

#####################################################################################################################
#################  Realizando contagem dos casos do Paraná para realizar a série histórica do Estado  ###############

PR_ANTRAB_Serie_Historica[12, 2] <- as.integer(ANTRAB2023 %>% 
                                                 count()
)

####Alterando o formato da coluna ID_MN_RESI de forma que ela seja passível de vincular no for loop#################

ANTRAB2023$ID_MN_RESI <- as.numeric(as.character(ANTRAB2023$ID_MN_RESI))

#####Filtrando os dados da Base DBF do SINAN com os dados de notificação somente da 22RS###########

RS22_ANTRAB_2023 <- ANTRAB2023 %>% 
  filter(ID_REGIONA == 1376 | ID_RG_RESI == 1376)

################################################################################################################
############      Filtrando os dados por SE para elaborar o Canal Endêmico   ###################################

RS22_ANTRAB_2023_SE_Notificados <- matrix(data = NA, 
                                          nrow = 16, 
                                          ncol = 54)

RS22_ANTRAB_2023_SE_Notificados <- as.data.frame(RS22_ANTRAB_2023_SE_Notificados)

colnames(RS22_ANTRAB_2023_SE_Notificados)[1] <- "Município" 

RS22_ANTRAB_2023_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

colnames (RS22_ANTRAB_2023_SE_Notificados)[2:24] <- c(31:53)

colnames (RS22_ANTRAB_2023_SE_Notificados)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 2] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202301)%>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 3] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202302) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 4] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202303) %>% 
                                                                                                  count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i),5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        SEM_PRI ==202304) %>% 
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                  filter(ID_MN_RESI == i,
                                                                                                         SEM_PRI ==202305) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 7] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202306) %>%
                                                                                                  count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 8] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202307) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 9] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                  filter(ID_MN_RESI == i, 
                                                                                                         SEM_PRI ==202308) %>% 
                                                                                                  count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202309) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 11] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202310) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 12] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202311) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 13] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202312) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 14] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202313) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 15] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202314) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 16] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202315) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 17] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202316) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 18] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202317) %>%  
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 19] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202318) %>%      
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 20] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202319) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i),  21] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                    filter(ID_MN_RESI == i, 
                                                                                                           SEM_PRI ==202320) %>%
                                                                                                    count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 22] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202321) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 23] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202322) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 24] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202323) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 25] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202324) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 26] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202325) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 27] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202326) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 28] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202327) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 29] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202328) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 30] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202329) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 31] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202330) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 32] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202331) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 33] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202332) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 34] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202333) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 35] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202334) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 36] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202335) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 37] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202336) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 38] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202337) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 39] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202338) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 40] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202339) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 41] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202340) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 42] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202341) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 43] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202342) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 44] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202343) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 45] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202344) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 46] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202345) %>%
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 47] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202346) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 48] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202347) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 49] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202348) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 50] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202349) %>% 
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 51] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202350) %>% 
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 52] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202351) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 53] <- as.integer(RS22_ANTRAB_2023 %>%
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          SEM_PRI ==202352) %>%
                                                                                                   count() 
  )
  
  RS22_ANTRAB_2023_SE_Notificados[which(RS22_ANTRAB_2023_SE_Notificados == i), 54] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i, 
                                                                                                          SEM_PRI ==202353) %>%
                                                                                                   count() 
  )
}

RS22_ANTRAB_2023_SE_Notificados[,1] <- BASE_IBGE[which(BASE_IBGE$RS == 22), 3]

RS22_ANTRAB_2023_SE_Notificados[17,2:54] <- apply(RS22_ANTRAB_2023_SE_Notificados[,2:54], 2, sum)

RS22_ANTRAB_2023_SE_Notificados[17,1] <- "Total"

#####FIltrando os dados por município e construindo uma tabela geral dos dados de atendimentos antirrábicos#####

RS22_ANTRAB_2023_GERAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_GERAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_GERAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_GERAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_GERAL <- RS22_ANTRAB_2023_GERAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_GERAL$Notificados <- NA

RS22_ANTRAB_2023_GERAL$Zona_Urbana <- NA

RS22_ANTRAB_2023_GERAL$Zona_Rural <- NA

RS22_ANTRAB_2023_GERAL$Zona_Periurbana <- NA

RS22_ANTRAB_2023_GERAL$Zona_Ignorados <- NA

RS22_ANTRAB_2023_GERAL$Feminino <- NA

RS22_ANTRAB_2023_GERAL$Masculino <- NA

RS22_ANTRAB_2023_GERAL$Menos_um_Ano <- NA

RS22_ANTRAB_2023_GERAL$Um_a_Cinco_Anos <- NA

RS22_ANTRAB_2023_GERAL$Cinco_a_Doze_Anos <- NA

RS22_ANTRAB_2023_GERAL$Doze_a_Dezoito_Anos <- NA

RS22_ANTRAB_2023_GERAL$Dezoito_a_Cinquenta_e_Nove <- NA

RS22_ANTRAB_2023_GERAL$Mais_de_Sessenta <- NA

RS22_ANTRAB_2023_GERAL$Analfabeto <- NA

RS22_ANTRAB_2023_GERAL$Fundamental_Incompleto <- NA

RS22_ANTRAB_2023_GERAL$Fundamental_Completo <- NA

RS22_ANTRAB_2023_GERAL$Ensino_Medio_Incompleto <- NA

RS22_ANTRAB_2023_GERAL$Ensino_Medio_Completo <- NA

RS22_ANTRAB_2023_GERAL$Superior_Incompleto <- NA

RS22_ANTRAB_2023_GERAL$Superior_completo <- NA

RS22_ANTRAB_2023_GERAL$Nao_se_Aplica <- NA

RS22_ANTRAB_2023_GERAL$Esc_Ignorado <- NA

RS22_ANTRAB_2023_GERAL$Gestante_SIM <- NA

RS22_ANTRAB_2023_GERAL$Gestante_NÃO <- NA

RS22_ANTRAB_2023_GERAL$Gestante_NA <- NA

RS22_ANTRAB_2023_GERAL$Gestante_IGNORADO <- NA

RS22_ANTRAB_2023_GERAL$Raça_Branca <- NA

RS22_ANTRAB_2023_GERAL$Raça_Preta <- NA

RS22_ANTRAB_2023_GERAL$Raça_Amarela <- NA

RS22_ANTRAB_2023_GERAL$Raça_Parda <- NA

RS22_ANTRAB_2023_GERAL$Raça_Indígena <- NA

RS22_ANTRAB_2023_GERAL$Raça_Ignorado <- NA

#####For loop para criação de tabela por município dos dados de notificação do SINAN##############

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                         filter(ID_MN_RESI == i) %>%   
                                                                                         count()
  )    
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 1) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 2) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 3) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                         filter(ID_MN_RESI == i,
                                                                                                CS_ZONA == 9 
                                                                                                |
                                                                                                  is.na(CS_ZONA)) %>%   
                                                                                         count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "F") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_SEXO == "M") %>%   
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 12] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N <=3012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 13] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,  
                                                                                                 NU_IDADE_N > 4000 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4005) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 14] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4005 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4012) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 15] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4012 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4018) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 16] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4018 
                                                                                                 & 
                                                                                                   NU_IDADE_N <=4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 17] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 NU_IDADE_N > 4059) %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 18] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "00") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 19] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "01" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "02" 
                                                                                                 | 
                                                                                                   CS_ESCOL_N == "03") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 20] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "04") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 21] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "05") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 22] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "06") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 23] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "07") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 24] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "08") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 25] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "10") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 26] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_ESCOL_N == "09") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 27] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "1" 
                                                                                                 |
                                                                                                   CS_GESTANT== "2" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "3" 
                                                                                                 | 
                                                                                                   CS_GESTANT == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 28] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "5") %>% 
                                                                                          count()
  )
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 29] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "6") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 30] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_GESTANT == "9") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 31] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "01") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 32] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "2") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 33] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "3") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 34] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "4") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 35] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "5") %>% 
                                                                                          count()
  )
  
  RS22_ANTRAB_2023_GERAL[which(RS22_ANTRAB_2023_GERAL$COD_IBGE == i), 36] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                          filter(ID_MN_RESI == i,
                                                                                                 CS_RACA == "9") %>% 
                                                                                          count()
  )
}

RS22_ANTRAB_2023_GERAL[17, 4:36] <- apply(RS22_ANTRAB_2023_GERAL[, 4:36], 2, sum)
RS22_ANTRAB_2023_GERAL[17, 1] <- "Total"

####Criando uma tabela dos dados de exposição compo 32 da ficha do sinan############

RS22_ANTRAB_2023_EXPOSICAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_EXPOSICAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_EXPOSICAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_EXPOSICAO <- RS22_ANTRAB_2023_EXPOSICAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_EXPOSICAO$Contato_Indireto <- NA

RS22_ANTRAB_2023_EXPOSICAO$Arranhadura <- NA

RS22_ANTRAB_2023_EXPOSICAO$Lambedura <- NA

RS22_ANTRAB_2023_EXPOSICAO$Mordedura <- NA

RS22_ANTRAB_2023_EXPOSICAO$Outro <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_EXPOSICAO[which(RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_CONTAT == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2023_EXPOSICAO[which(RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_ARRANH == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_EXPOSICAO[which(RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_LAMBED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_EXPOSICAO[which(RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_MORDED == "1") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_EXPOSICAO[which(RS22_ANTRAB_2023_EXPOSICAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        ANT_OUTRO_ == "1") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2023_EXPOSICAO[17, 4:9] <- apply(RS22_ANTRAB_2023_EXPOSICAO[, 4:9], 2, sum)
RS22_ANTRAB_2023_EXPOSICAO[17, 1] <- "Total"

#####Criando uma tabela com dados de localização da lesão (campo 33 do SINAN)##########

RS22_ANTRAB_2023_LOCALIZACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_LOCALIZACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_LOCALIZACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_LOCALIZACAO <- RS22_ANTRAB_2023_LOCALIZACAO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_LOCALIZACAO$Mucosa <- NA

RS22_ANTRAB_2023_LOCALIZACAO$Cabeca_Pescoco <- NA

RS22_ANTRAB_2023_LOCALIZACAO$Maos_Pes <- NA

RS22_ANTRAB_2023_LOCALIZACAO$Tronco <- NA

RS22_ANTRAB_2023_LOCALIZACAO$Membros_Superiores <- NA

RS22_ANTRAB_2023_LOCALIZACAO$Membros_Inferiores <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MUCOSA == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_CABECA == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MAOS == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_TRONCO == "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            ANT_MEMBRO== "1") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2023_LOCALIZACAO[which(RS22_ANTRAB_2023_LOCALIZACAO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                      filter(ID_MN_RESI == i,
                                                                                                             ANT_MEMB_1== "1") %>%   
                                                                                                      count()
  )
}

RS22_ANTRAB_2023_LOCALIZACAO[17, 4:10] <- apply(RS22_ANTRAB_2023_LOCALIZACAO[, 4:10], 2, sum)
RS22_ANTRAB_2023_LOCALIZACAO[17, 1] <- "Total"

#####Tabela Ferimento (Campo 34 do SINAN)

RS22_ANTRAB_2023_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_FERIMENTO <- RS22_ANTRAB_2023_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_FERIMENTO$Unico <- NA

RS22_ANTRAB_2023_FERIMENTO$Multiplo <- NA

RS22_ANTRAB_2023_FERIMENTO$Sem_Ferimento <- NA

RS22_ANTRAB_2023_FERIMENTO$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_FERIMENTO[which(RS22_ANTRAB_2023_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "1") %>%   
                                                                                                 count()
  )    
  
  RS22_ANTRAB_2023_FERIMENTO[which(RS22_ANTRAB_2023_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "2") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_FERIMENTO[which(RS22_ANTRAB_2023_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "3") %>%   
                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_FERIMENTO[which(RS22_ANTRAB_2023_FERIMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                 filter(ID_MN_RESI == i,
                                                                                                        FERIMENTO == "9") %>%   
                                                                                                 count()
  )
}

RS22_ANTRAB_2023_FERIMENTO[17, 4:8] <- apply(RS22_ANTRAB_2023_FERIMENTO[, 4:8], 2, sum)
RS22_ANTRAB_2023_FERIMENTO[17, 1] <- "Total"

#####Tabela Tipo de Ferimanto (Campo 35 do SINAN)########

RS22_ANTRAB_2023_TIPO_FERIMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_TIPO_FERIMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_TIPO_FERIMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_TIPO_FERIMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_TIPO_FERIMENTO <- RS22_ANTRAB_2023_TIPO_FERIMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_TIPO_FERIMENTO$Profundo <- NA

RS22_ANTRAB_2023_TIPO_FERIMENTO$Superficial <- NA

RS22_ANTRAB_2023_TIPO_FERIMENTO$Dilacerante <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_TIPO_FERIMENTO[which(RS22_ANTRAB_2023_TIPO_FERIMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_PROFUN == "1") %>%   
                                                                                                           count()
  )    
  
  RS22_ANTRAB_2023_TIPO_FERIMENTO[which(RS22_ANTRAB_2023_TIPO_FERIMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_SUPERF == "1") %>%   
                                                                                                           count()
  )
  
  RS22_ANTRAB_2023_TIPO_FERIMENTO[which(RS22_ANTRAB_2023_TIPO_FERIMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                           filter(ID_MN_RESI == i,
                                                                                                                  ANT_DILACE == "1") %>%   
                                                                                                           count()
  )
}

RS22_ANTRAB_2023_TIPO_FERIMENTO[17, 4:7] <- apply(RS22_ANTRAB_2023_TIPO_FERIMENTO[, 4:7], 2, sum)
RS22_ANTRAB_2023_TIPO_FERIMENTO[17, 1] <- "Total"

#####Tabela Antecedentes de Tratamento (Campo 37 sinan)####

RS22_ANTRAB_2023_ANTECEDENTE_ANTR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_ANTECEDENTE_ANTR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_ANTECEDENTE_ANTR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_ANTECEDENTE_ANTR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_ANTECEDENTE_ANTR <- RS22_ANTRAB_2023_ANTECEDENTE_ANTR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_ANTECEDENTE_ANTR$Pre_Exp <- NA

RS22_ANTRAB_2023_ANTECEDENTE_ANTR$Pos_Exp <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2023_ANTECEDENTE_ANTR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      PRE_EXPOS == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2023_ANTECEDENTE_ANTR[which(RS22_ANTRAB_2023_ANTECEDENTE_ANTR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      POS_EXPOS == "1") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2023_ANTECEDENTE_ANTR[17, 4:6] <- apply(RS22_ANTRAB_2023_ANTECEDENTE_ANTR[, 4:6], 2, sum)
RS22_ANTRAB_2023_ANTECEDENTE_ANTR[17, 1] <- "Total"

####TAbela Animal Agressor (campo 40 SINAN)####

RS22_ANTRAB_2023_AGRESSOR <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_AGRESSOR$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_AGRESSOR$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_AGRESSOR$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_AGRESSOR <- RS22_ANTRAB_2023_AGRESSOR[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_AGRESSOR$Canina <- NA

RS22_ANTRAB_2023_AGRESSOR$Felina <- NA

RS22_ANTRAB_2023_AGRESSOR$Quiroptera <- NA

RS22_ANTRAB_2023_AGRESSOR$Primata <- NA

RS22_ANTRAB_2023_AGRESSOR$Raposa <- NA

RS22_ANTRAB_2023_AGRESSOR$Herbivaro_Domestico <- NA

RS22_ANTRAB_2023_AGRESSOR$Outra <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "1") %>%   
                                                                                               count()
  )    
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "2") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "3") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "4") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                               filter(ID_MN_RESI == i,
                                                                                                      ANIMAL == "5") %>%   
                                                                                               count()
  )
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "6") %>%   
                                                                                                count()
  )
  
  RS22_ANTRAB_2023_AGRESSOR[which(RS22_ANTRAB_2023_AGRESSOR$COD_IBGE == i), 11] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                filter(ID_MN_RESI == i,
                                                                                                       ANIMAL == "7") %>%   
                                                                                                count()
  )
}

RS22_ANTRAB_2023_AGRESSOR[17, 4:11] <- apply(RS22_ANTRAB_2023_AGRESSOR[, 4:11], 2, sum)
RS22_ANTRAB_2023_AGRESSOR[17, 1] <- "Total"

####Tabela Condição do animal no acidente (campo 41 do sinan)####

RS22_ANTRAB_2023_COND_ANIMAL_ACID <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_COND_ANIMAL_ACID$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_COND_ANIMAL_ACID$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_COND_ANIMAL_ACID$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_COND_ANIMAL_ACID <- RS22_ANTRAB_2023_COND_ANIMAL_ACID[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_COND_ANIMAL_ACID$Sadio <- NA

RS22_ANTRAB_2023_COND_ANIMAL_ACID$Suspeito <- NA

RS22_ANTRAB_2023_COND_ANIMAL_ACID$Raivoso <- NA

RS22_ANTRAB_2023_COND_ANIMAL_ACID$Morto_Desaparecido <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_COND_ANIMAL_ACID[which(RS22_ANTRAB_2023_COND_ANIMAL_ACID$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2023_COND_ANIMAL_ACID[which(RS22_ANTRAB_2023_COND_ANIMAL_ACID$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "2") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2023_COND_ANIMAL_ACID[which(RS22_ANTRAB_2023_COND_ANIMAL_ACID$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "3") %>%   
                                                                                                               count()
  )
  
  RS22_ANTRAB_2023_COND_ANIMAL_ACID[which(RS22_ANTRAB_2023_COND_ANIMAL_ACID$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      CONDIC_ANI == "4") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2023_COND_ANIMAL_ACID[17, 4:8] <- apply(RS22_ANTRAB_2023_COND_ANIMAL_ACID[, 4:8], 2, sum)
RS22_ANTRAB_2023_COND_ANIMAL_ACID[17, 1] <- "Total"

####Tabela Animal Observável (campo 42 SINAN)###

RS22_ANTRAB_2023_OBSERVAVEL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_OBSERVAVEL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_OBSERVAVEL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_OBSERVAVEL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_OBSERVAVEL <- RS22_ANTRAB_2023_OBSERVAVEL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_OBSERVAVEL$Sim <- NA

RS22_ANTRAB_2023_OBSERVAVEL$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_OBSERVAVEL[which(RS22_ANTRAB_2023_OBSERVAVEL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "1") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2023_OBSERVAVEL[which(RS22_ANTRAB_2023_OBSERVAVEL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          OBSERVACAO == "2") %>%   
                                                                                                   count()
  )
}

RS22_ANTRAB_2023_OBSERVAVEL[17, 4:6] <- apply(RS22_ANTRAB_2023_OBSERVAVEL[, 4:6], 2, sum)
RS22_ANTRAB_2023_OBSERVAVEL[17, 1] <- "Total"

###Tabela Tratamento (campo 43 do SINAN)####

RS22_ANTRAB_2023_TRATAMENTO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_TRATAMENTO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_TRATAMENTO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_TRATAMENTO <- RS22_ANTRAB_2023_TRATAMENTO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_TRATAMENTO$Dispensa_Tratamento <- NA

RS22_ANTRAB_2023_TRATAMENTO$Observação_Animal <- NA

RS22_ANTRAB_2023_TRATAMENTO$Observação_Vacina <- NA

RS22_ANTRAB_2023_TRATAMENTO$Vacina <- NA

RS22_ANTRAB_2023_TRATAMENTO$Soro_Vacina <- NA

RS22_ANTRAB_2023_TRATAMENTO$Esquema_Reexposicao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "2") %>%   
                                                                                                   count()
  )    
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "3") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "4") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "5") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                   filter(ID_MN_RESI == i,
                                                                                                          TRAT_ATUAL == "6") %>%   
                                                                                                   count()
  )
  
  RS22_ANTRAB_2023_TRATAMENTO[which(RS22_ANTRAB_2023_TRATAMENTO$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                    filter(ID_MN_RESI == i,
                                                                                                           TRAT_ATUAL == "7") %>%   
                                                                                                    count()
  )
}

RS22_ANTRAB_2023_TRATAMENTO[17, 4:10] <- apply(RS22_ANTRAB_2023_TRATAMENTO[, 4:10], 2, sum)
RS22_ANTRAB_2023_TRATAMENTO[17, 1] <- "Total"

###Tabela Condição final do Animal (campo 48 do SINAN)###

RS22_ANTRAB_2023_COND_FINAL_ANIMAL <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_COND_FINAL_ANIMAL<- RS22_ANTRAB_2023_COND_FINAL_ANIMAL[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Negativo_Clinico <- NA

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Negativo_Lab <- NA

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Positivo_Clinico <- NA

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Positivo_Lab <- NA

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Morto_SemDiagnostico <- NA

RS22_ANTRAB_2023_COND_FINAL_ANIMAL$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "1") %>%   
                                                                                                                 count()
  )    
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "2") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "3") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 8] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "4") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 9] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                 filter(ID_MN_RESI == i,
                                                                                                                        FIM_ANIMAL == "5") %>%   
                                                                                                                 count()
  )
  
  RS22_ANTRAB_2023_COND_FINAL_ANIMAL[which(RS22_ANTRAB_2023_COND_FINAL_ANIMAL$COD_IBGE == i), 10] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                  filter(ID_MN_RESI == i,
                                                                                                                         FIM_ANIMAL == "9") %>%   
                                                                                                                  count()
  )
}

RS22_ANTRAB_2023_COND_FINAL_ANIMAL[17, 4:10] <- apply(RS22_ANTRAB_2023_COND_FINAL_ANIMAL[, 4:10], 2, sum)
RS22_ANTRAB_2023_COND_FINAL_ANIMAL[17, 1] <- "Total"

###Tabela Interrupção de tratamento (campo 49 do SINAN)####

RS22_ANTRAB_2023_INTERRUPCAO_TRAT <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_INTERRUPCAO_TRAT$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_INTERRUPCAO_TRAT$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_INTERRUPCAO_TRAT$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_INTERRUPCAO_TRAT <- RS22_ANTRAB_2023_INTERRUPCAO_TRAT[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_INTERRUPCAO_TRAT$Sim <- NA

RS22_ANTRAB_2023_INTERRUPCAO_TRAT$Nao <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2023_INTERRUPCAO_TRAT$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2023_INTERRUPCAO_TRAT[which(RS22_ANTRAB_2023_INTERRUPCAO_TRAT$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INTERR == "2") %>%   
                                                                                                               count()
  )
}

RS22_ANTRAB_2023_INTERRUPCAO_TRAT[17, 4:6] <- apply(RS22_ANTRAB_2023_INTERRUPCAO_TRAT[, 4:6], 2, sum)
RS22_ANTRAB_2023_INTERRUPCAO_TRAT[17, 1] <- "Total"

####Tabela Soroterapia (campo 53 do SINAN)###

RS22_ANTRAB_2023_SOROTERAPIA <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_SOROTERAPIA$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_SOROTERAPIA$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_SOROTERAPIA$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_SOROTERAPIA <- RS22_ANTRAB_2023_SOROTERAPIA[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_SOROTERAPIA$Sim <- NA

RS22_ANTRAB_2023_SOROTERAPIA$Nao <- NA

RS22_ANTRAB_2023_SOROTERAPIA$Ignorado <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_SOROTERAPIA[which(RS22_ANTRAB_2023_SOROTERAPIA$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "1") %>%   
                                                                                                     count()
  )    
  
  RS22_ANTRAB_2023_SOROTERAPIA[which(RS22_ANTRAB_2023_SOROTERAPIA$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "2") %>%   
                                                                                                     count()
  )
  
  RS22_ANTRAB_2023_SOROTERAPIA[which(RS22_ANTRAB_2023_SOROTERAPIA$COD_IBGE == i), 7] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                     filter(ID_MN_RESI == i,
                                                                                                            TRA_INDI_N == "9") %>%   
                                                                                                     count()
  )
}

RS22_ANTRAB_2023_SOROTERAPIA[17, 4:7] <- apply(RS22_ANTRAB_2023_SOROTERAPIA[, 4:7], 2, sum)
RS22_ANTRAB_2023_SOROTERAPIA[17, 1] <- "Total"

###Tabela tipo de imunobiologico (campo 55 SINAN)####

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO<- RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$SAR <- NA

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$IGHAR <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO == "1") %>%   
                                                                                                                     count()
  )    
  
  RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[which(RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                                     filter(ID_MN_RESI == i,
                                                                                                                            TIP_SORO== "2") %>%   
                                                                                                                     count()
  )
  
}

RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[17, 4:6] <- apply(RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[, 4:6], 2, sum)
RS22_ANTRAB_2023_TIPO_IMUNOBIOLOGICO[17, 1] <- "Total"

###Tabela Infiltração (campo 56 do SINAN)###

RS22_ANTRAB_2023_SORO_INFILTRACAO <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == 22), 3])

RS22_ANTRAB_2023_SORO_INFILTRACAO$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == 22), 2]

RS22_ANTRAB_2023_SORO_INFILTRACAO$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == 22), 5]

RS22_ANTRAB_2023_SORO_INFILTRACAO$RS <- BASE_IBGE[which(BASE_IBGE$RS == 22), 1]

RS22_ANTRAB_2023_SORO_INFILTRACAO  <- RS22_ANTRAB_2023_SORO_INFILTRACAO [,c(4, 1, 2, 3)]

RS22_ANTRAB_2023_SORO_INFILTRACAO$TOTAL <- NA

RS22_ANTRAB_2023_SORO_INFILTRACAO$PARCIAL <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == 22)), 2]){
  
  RS22_ANTRAB_2023_SORO_INFILTRACAO[which(RS22_ANTRAB_2023_SORO_INFILTRACAO$COD_IBGE == i), 5] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFILT == "1") %>%   
                                                                                                               count()
  )    
  
  RS22_ANTRAB_2023_SORO_INFILTRACAO[which(RS22_ANTRAB_2023_SORO_INFILTRACAO$COD_IBGE == i), 6] <- as.integer(RS22_ANTRAB_2023 %>% 
                                                                                                               filter(ID_MN_RESI == i,
                                                                                                                      TRA_INFI_1 == "1") %>%   
                                                                                                               count()
  )
  
}

RS22_ANTRAB_2023_SORO_INFILTRACAO[17, 4:6] <- apply(RS22_ANTRAB_2023_SORO_INFILTRACAO[, 4:6], 2, sum)
RS22_ANTRAB_2023_SORO_INFILTRACAO[17, 1] <- "Total"

rm(ANTRAB2023)

################################################################################################################################
################################################################################################################################

###Tabela Série Histórica###

AUX <- data.frame(RS22 = "RS22", RS22_2012 = NA, RS22_2013 = NA, 
                                          RS22_2014 = NA, RS22_2015 = NA, RS22_2016 = NA, 
                                          RS22_2017 = NA, RS22_2018 = NA, RS22_2019 = NA, 
                                          RS22_2020 = NA, RS22_2021 = NA, RS22_2022 = NA, 
                                          RS22_2023 = NA)

AUX[1, 1] <- "Notificados"
AUX[2, 1] <- "Zona_Urbana"
AUX[3, 1] <- "Zona_Rural"
AUX[4, 1] <- "Zona_Periurbana"
AUX[5, 1] <- "Zona_Ignorados"
AUX[6, 1] <- "Feminino"
AUX[7, 1] <- "Masculino"
AUX[8, 1] <- "Menos_1_ano"
AUX[9, 1] <- "Um_a_cinco"
AUX[10, 1] <- "Cinco_a_doze"
AUX[11, 1] <- "Doze_dezoito"
AUX[12, 1] <- "Dezoito_cinquentaenove"
AUX[13, 1] <- "Mais_de_Sessenta"
AUX[14, 1] <- "Analfabeto"
AUX[15, 1] <- "Fundamental_Incompleto"
AUX[16, 1] <- "Fundamental_Completo"
AUX[17, 1] <- "Ensino_medio_Incompleto"
AUX[18, 1] <- "Ensino_Medio_Completo"
AUX[19, 1] <- "Superior_Incompleto"
AUX[20, 1] <- "Superior_Completo"
AUX[21, 1] <- "ESC_NA"
AUX[22, 1] <- "Esc_Ignorado"
AUX[23, 1] <- "Gestante"
AUX[24, 1] <- "Não_Gestante"

AUX[1, 2] <- RS22_ANTRAB_2012_GERAL[17, 5]
AUX[2, 2] <- RS22_ANTRAB_2012_GERAL[17, 6]
AUX[3, 2] <- RS22_ANTRAB_2012_GERAL[17, 7]
AUX[4, 2] <- RS22_ANTRAB_2012_GERAL[17, 8]
AUX[5, 2] <- RS22_ANTRAB_2012_GERAL[17, 9]
AUX[6, 2] <- RS22_ANTRAB_2012_GERAL[17, 10]
AUX[7, 2] <- RS22_ANTRAB_2012_GERAL[17, 11]
AUX[8, 2] <- RS22_ANTRAB_2012_GERAL[17, 12]
AUX[9, 2] <- RS22_ANTRAB_2012_GERAL[17, 13]
AUX[10, 2] <- RS22_ANTRAB_2012_GERAL[17, 14]
AUX[11, 2] <- RS22_ANTRAB_2012_GERAL[17, 15]
AUX[12, 2] <- RS22_ANTRAB_2012_GERAL[17, 16]
AUX[13, 2] <- RS22_ANTRAB_2012_GERAL[17, 17]
AUX[14, 2] <- RS22_ANTRAB_2012_GERAL[17, 18]
AUX[15, 2] <- RS22_ANTRAB_2012_GERAL[17, 19]
AUX[16, 2] <- RS22_ANTRAB_2012_GERAL[17, 20]
AUX[17, 2] <- RS22_ANTRAB_2012_GERAL[17, 21]
AUX[18, 2] <- RS22_ANTRAB_2012_GERAL[17, 22]
AUX[19, 2] <- RS22_ANTRAB_2012_GERAL[17, 23]
AUX[20, 2] <- RS22_ANTRAB_2012_GERAL[17, 24]
AUX[21, 2] <- RS22_ANTRAB_2012_GERAL[17, 25]
AUX[22, 2] <- RS22_ANTRAB_2012_GERAL[17, 26]
AUX[23, 2] <- RS22_ANTRAB_2012_GERAL[17, 27]
AUX[24, 2] <- RS22_ANTRAB_2012_GERAL[17, 28]

AUX[1, 3] <- RS22_ANTRAB_2013_GERAL[17, 5]
AUX[2, 3] <- RS22_ANTRAB_2013_GERAL[17, 6]
AUX[3, 3] <- RS22_ANTRAB_2013_GERAL[17, 7]
AUX[4, 3] <- RS22_ANTRAB_2013_GERAL[17, 8]
AUX[5, 3] <- RS22_ANTRAB_2013_GERAL[17, 9]
AUX[6, 3] <- RS22_ANTRAB_2013_GERAL[17, 10]
AUX[7, 3] <- RS22_ANTRAB_2013_GERAL[17, 11]
AUX[8, 3] <- RS22_ANTRAB_2013_GERAL[17, 12]
AUX[9, 3] <- RS22_ANTRAB_2013_GERAL[17, 13]
AUX[10, 3] <- RS22_ANTRAB_2013_GERAL[17, 14]
AUX[11, 3] <- RS22_ANTRAB_2013_GERAL[17, 15]
AUX[12, 3] <- RS22_ANTRAB_2013_GERAL[17, 16]
AUX[13, 3] <- RS22_ANTRAB_2013_GERAL[17, 17]
AUX[14, 3] <- RS22_ANTRAB_2013_GERAL[17, 18]
AUX[15, 3] <- RS22_ANTRAB_2013_GERAL[17, 19]
AUX[16, 3] <- RS22_ANTRAB_2013_GERAL[17, 20]
AUX[17, 3] <- RS22_ANTRAB_2013_GERAL[17, 21]
AUX[18, 3] <- RS22_ANTRAB_2013_GERAL[17, 22]
AUX[19, 3] <- RS22_ANTRAB_2013_GERAL[17, 23]
AUX[20, 3] <- RS22_ANTRAB_2013_GERAL[17, 24]
AUX[21, 3] <- RS22_ANTRAB_2013_GERAL[17, 25]
AUX[22, 3] <- RS22_ANTRAB_2013_GERAL[17, 26]
AUX[23, 3] <- RS22_ANTRAB_2013_GERAL[17, 27]
AUX[24, 3] <- RS22_ANTRAB_2013_GERAL[17, 28]

AUX[1, 4] <- RS22_ANTRAB_2014_GERAL[17, 5]
AUX[2, 4] <- RS22_ANTRAB_2014_GERAL[17, 6]
AUX[3, 4] <- RS22_ANTRAB_2014_GERAL[17, 7]
AUX[4, 4] <- RS22_ANTRAB_2014_GERAL[17, 8]
AUX[5, 4] <- RS22_ANTRAB_2014_GERAL[17, 9]
AUX[6, 4] <- RS22_ANTRAB_2014_GERAL[17, 10]
AUX[7, 4] <- RS22_ANTRAB_2014_GERAL[17, 11]
AUX[8, 4] <- RS22_ANTRAB_2014_GERAL[17, 12]
AUX[9, 4] <- RS22_ANTRAB_2014_GERAL[17, 13]
AUX[10, 4] <- RS22_ANTRAB_2014_GERAL[17, 14]
AUX[11, 4] <- RS22_ANTRAB_2014_GERAL[17, 15]
AUX[12, 4] <- RS22_ANTRAB_2014_GERAL[17, 16]
AUX[13, 4] <- RS22_ANTRAB_2014_GERAL[17, 17]
AUX[14, 4] <- RS22_ANTRAB_2014_GERAL[17, 18]
AUX[15, 4] <- RS22_ANTRAB_2014_GERAL[17, 19]
AUX[16, 4] <- RS22_ANTRAB_2014_GERAL[17, 20]
AUX[17, 4] <- RS22_ANTRAB_2014_GERAL[17, 21]
AUX[18, 4] <- RS22_ANTRAB_2014_GERAL[17, 22]
AUX[19, 4] <- RS22_ANTRAB_2014_GERAL[17, 23]
AUX[20, 4] <- RS22_ANTRAB_2014_GERAL[17, 24]
AUX[21, 4] <- RS22_ANTRAB_2014_GERAL[17, 25]
AUX[22, 4] <- RS22_ANTRAB_2014_GERAL[17, 26]
AUX[23, 4] <- RS22_ANTRAB_2014_GERAL[17, 27]
AUX[24, 4] <- RS22_ANTRAB_2014_GERAL[17, 28]

AUX[1, 5] <- RS22_ANTRAB_2015_GERAL[17, 5]
AUX[2, 5] <- RS22_ANTRAB_2015_GERAL[17, 6]
AUX[3, 5] <- RS22_ANTRAB_2015_GERAL[17, 7]
AUX[4, 5] <- RS22_ANTRAB_2015_GERAL[17, 8]
AUX[5, 5] <- RS22_ANTRAB_2015_GERAL[17, 9]
AUX[6, 5] <- RS22_ANTRAB_2015_GERAL[17, 10]
AUX[7, 5] <- RS22_ANTRAB_2015_GERAL[17, 11]
AUX[8, 5] <- RS22_ANTRAB_2015_GERAL[17, 12]
AUX[9, 5] <- RS22_ANTRAB_2015_GERAL[17, 13]
AUX[10, 5] <- RS22_ANTRAB_2015_GERAL[17, 14]
AUX[11, 5] <- RS22_ANTRAB_2015_GERAL[17, 15]
AUX[12, 5] <- RS22_ANTRAB_2015_GERAL[17, 16]
AUX[13, 5] <- RS22_ANTRAB_2015_GERAL[17, 17]
AUX[14, 5] <- RS22_ANTRAB_2015_GERAL[17, 18]
AUX[15, 5] <- RS22_ANTRAB_2015_GERAL[17, 19]
AUX[16, 5] <- RS22_ANTRAB_2015_GERAL[17, 20]
AUX[17, 5] <- RS22_ANTRAB_2015_GERAL[17, 21]
AUX[18, 5] <- RS22_ANTRAB_2015_GERAL[17, 22]
AUX[19, 5] <- RS22_ANTRAB_2015_GERAL[17, 23]
AUX[20, 5] <- RS22_ANTRAB_2015_GERAL[17, 24]
AUX[21, 5] <- RS22_ANTRAB_2015_GERAL[17, 25]
AUX[22, 5] <- RS22_ANTRAB_2015_GERAL[17, 26]
AUX[23, 5] <- RS22_ANTRAB_2015_GERAL[17, 27]
AUX[24, 5] <- RS22_ANTRAB_2015_GERAL[17, 28]

AUX[1, 6] <- RS22_ANTRAB_2016_GERAL[17, 5]
AUX[2, 6] <- RS22_ANTRAB_2016_GERAL[17, 6]
AUX[3, 6] <- RS22_ANTRAB_2016_GERAL[17, 7]
AUX[4, 6] <- RS22_ANTRAB_2016_GERAL[17, 8]
AUX[5, 6] <- RS22_ANTRAB_2016_GERAL[17, 9]
AUX[6, 6] <- RS22_ANTRAB_2016_GERAL[17, 10]
AUX[7, 6] <- RS22_ANTRAB_2016_GERAL[17, 11]
AUX[8, 6] <- RS22_ANTRAB_2016_GERAL[17, 12]
AUX[9, 6] <- RS22_ANTRAB_2016_GERAL[17, 13]
AUX[10, 6] <- RS22_ANTRAB_2016_GERAL[17, 14]
AUX[11, 6] <- RS22_ANTRAB_2016_GERAL[17, 15]
AUX[12, 6] <- RS22_ANTRAB_2016_GERAL[17, 16]
AUX[13, 6] <- RS22_ANTRAB_2016_GERAL[17, 17]
AUX[14, 6] <- RS22_ANTRAB_2016_GERAL[17, 18]
AUX[15, 6] <- RS22_ANTRAB_2016_GERAL[17, 19]
AUX[16, 6] <- RS22_ANTRAB_2016_GERAL[17, 20]
AUX[17, 6] <- RS22_ANTRAB_2016_GERAL[17, 21]
AUX[18, 6] <- RS22_ANTRAB_2016_GERAL[17, 22]
AUX[19, 6] <- RS22_ANTRAB_2016_GERAL[17, 23]
AUX[20, 6] <- RS22_ANTRAB_2016_GERAL[17, 24]
AUX[21, 6] <- RS22_ANTRAB_2016_GERAL[17, 25]
AUX[22, 6] <- RS22_ANTRAB_2016_GERAL[17, 26]
AUX[23, 6] <- RS22_ANTRAB_2016_GERAL[17, 27]
AUX[24, 6] <- RS22_ANTRAB_2016_GERAL[17, 28]

AUX[1, 7] <- RS22_ANTRAB_2017_GERAL[17, 5]
AUX[2, 7] <- RS22_ANTRAB_2017_GERAL[17, 6]
AUX[3, 7] <- RS22_ANTRAB_2017_GERAL[17, 7]
AUX[4, 7] <- RS22_ANTRAB_2017_GERAL[17, 8]
AUX[5, 7] <- RS22_ANTRAB_2017_GERAL[17, 9]
AUX[6, 7] <- RS22_ANTRAB_2017_GERAL[17, 10]
AUX[7, 7] <- RS22_ANTRAB_2017_GERAL[17, 11]
AUX[8, 7] <- RS22_ANTRAB_2017_GERAL[17, 12]
AUX[9, 7] <- RS22_ANTRAB_2017_GERAL[17, 13]
AUX[10, 7] <- RS22_ANTRAB_2017_GERAL[17, 14]
AUX[11, 7] <- RS22_ANTRAB_2017_GERAL[17, 15]
AUX[12, 7] <- RS22_ANTRAB_2017_GERAL[17, 16]
AUX[13, 7] <- RS22_ANTRAB_2017_GERAL[17, 17]
AUX[14, 7] <- RS22_ANTRAB_2017_GERAL[17, 18]
AUX[15, 7] <- RS22_ANTRAB_2017_GERAL[17, 19]
AUX[16, 7] <- RS22_ANTRAB_2017_GERAL[17, 20]
AUX[17, 7] <- RS22_ANTRAB_2017_GERAL[17, 21]
AUX[18, 7] <- RS22_ANTRAB_2017_GERAL[17, 22]
AUX[19, 7] <- RS22_ANTRAB_2017_GERAL[17, 23]
AUX[20, 7] <- RS22_ANTRAB_2017_GERAL[17, 24]
AUX[21, 7] <- RS22_ANTRAB_2017_GERAL[17, 25]
AUX[22, 7] <- RS22_ANTRAB_2017_GERAL[17, 26]
AUX[23, 7] <- RS22_ANTRAB_2017_GERAL[17, 27]
AUX[24, 7] <- RS22_ANTRAB_2017_GERAL[17, 28]

AUX[1, 8] <- RS22_ANTRAB_2018_GERAL[17, 5]
AUX[2, 8] <- RS22_ANTRAB_2018_GERAL[17, 6]
AUX[3, 8] <- RS22_ANTRAB_2018_GERAL[17, 7]
AUX[4, 8] <- RS22_ANTRAB_2018_GERAL[17, 8]
AUX[5, 8] <- RS22_ANTRAB_2018_GERAL[17, 9]
AUX[6, 8] <- RS22_ANTRAB_2018_GERAL[17, 10]
AUX[7, 8] <- RS22_ANTRAB_2018_GERAL[17, 11]
AUX[8, 8] <- RS22_ANTRAB_2018_GERAL[17, 12]
AUX[9, 8] <- RS22_ANTRAB_2018_GERAL[17, 13]
AUX[10, 8] <- RS22_ANTRAB_2018_GERAL[17, 14]
AUX[11, 8] <- RS22_ANTRAB_2018_GERAL[17, 15]
AUX[12, 8] <- RS22_ANTRAB_2018_GERAL[17, 16]
AUX[13, 8] <- RS22_ANTRAB_2018_GERAL[17, 17]
AUX[14, 8] <- RS22_ANTRAB_2018_GERAL[17, 18]
AUX[15, 8] <- RS22_ANTRAB_2018_GERAL[17, 19]
AUX[16, 8] <- RS22_ANTRAB_2018_GERAL[17, 20]
AUX[17, 8] <- RS22_ANTRAB_2018_GERAL[17, 21]
AUX[18, 8] <- RS22_ANTRAB_2018_GERAL[17, 22]
AUX[19, 8] <- RS22_ANTRAB_2018_GERAL[17, 23]
AUX[20, 8] <- RS22_ANTRAB_2018_GERAL[17, 24]
AUX[21, 8] <- RS22_ANTRAB_2018_GERAL[17, 25]
AUX[22, 8] <- RS22_ANTRAB_2018_GERAL[17, 26]
AUX[23, 8] <- RS22_ANTRAB_2018_GERAL[17, 27]
AUX[24, 8] <- RS22_ANTRAB_2018_GERAL[17, 28]

AUX[1, 9] <- RS22_ANTRAB_2019_GERAL[17, 5]
AUX[2, 9] <- RS22_ANTRAB_2019_GERAL[17, 6]
AUX[3, 9] <- RS22_ANTRAB_2019_GERAL[17, 7]
AUX[4, 9] <- RS22_ANTRAB_2019_GERAL[17, 8]
AUX[5, 9] <- RS22_ANTRAB_2019_GERAL[17, 9]
AUX[6, 9] <- RS22_ANTRAB_2019_GERAL[17, 10]
AUX[7, 9] <- RS22_ANTRAB_2019_GERAL[17, 11]
AUX[8, 9] <- RS22_ANTRAB_2019_GERAL[17, 12]
AUX[9, 9] <- RS22_ANTRAB_2019_GERAL[17, 13]
AUX[10, 9] <- RS22_ANTRAB_2019_GERAL[17, 14]
AUX[11, 9] <- RS22_ANTRAB_2019_GERAL[17, 15]
AUX[12, 9] <- RS22_ANTRAB_2019_GERAL[17, 16]
AUX[13, 9] <- RS22_ANTRAB_2019_GERAL[17, 17]
AUX[14, 9] <- RS22_ANTRAB_2019_GERAL[17, 18]
AUX[15, 9] <- RS22_ANTRAB_2019_GERAL[17, 19]
AUX[16, 9] <- RS22_ANTRAB_2019_GERAL[17, 20]
AUX[17, 9] <- RS22_ANTRAB_2019_GERAL[17, 21]
AUX[18, 9] <- RS22_ANTRAB_2019_GERAL[17, 22]
AUX[19, 9] <- RS22_ANTRAB_2019_GERAL[17, 23]
AUX[20, 9] <- RS22_ANTRAB_2019_GERAL[17, 24]
AUX[21, 9] <- RS22_ANTRAB_2019_GERAL[17, 25]
AUX[22, 9] <- RS22_ANTRAB_2019_GERAL[17, 26]
AUX[23, 9] <- RS22_ANTRAB_2019_GERAL[17, 27]
AUX[24, 9] <- RS22_ANTRAB_2019_GERAL[17, 28]

AUX[1, 10] <- RS22_ANTRAB_2020_GERAL[17, 5]
AUX[2, 10] <- RS22_ANTRAB_2020_GERAL[17, 6]
AUX[3, 10] <- RS22_ANTRAB_2020_GERAL[17, 7]
AUX[4, 10] <- RS22_ANTRAB_2020_GERAL[17, 8]
AUX[5, 10] <- RS22_ANTRAB_2020_GERAL[17, 9]
AUX[6, 10] <- RS22_ANTRAB_2020_GERAL[17, 10]
AUX[7, 10] <- RS22_ANTRAB_2020_GERAL[17, 11]
AUX[8, 10] <- RS22_ANTRAB_2020_GERAL[17, 12]
AUX[9, 10] <- RS22_ANTRAB_2020_GERAL[17, 13]
AUX[10, 10] <- RS22_ANTRAB_2020_GERAL[17, 14]
AUX[11, 10] <- RS22_ANTRAB_2020_GERAL[17, 15]
AUX[12, 10] <- RS22_ANTRAB_2020_GERAL[17, 16]
AUX[13, 10] <- RS22_ANTRAB_2020_GERAL[17, 17]
AUX[14, 10] <- RS22_ANTRAB_2020_GERAL[17, 18]
AUX[15, 10] <- RS22_ANTRAB_2020_GERAL[17, 19]
AUX[16, 10] <- RS22_ANTRAB_2020_GERAL[17, 20]
AUX[17, 10] <- RS22_ANTRAB_2020_GERAL[17, 21]
AUX[18, 10] <- RS22_ANTRAB_2020_GERAL[17, 22]
AUX[19, 10] <- RS22_ANTRAB_2020_GERAL[17, 23]
AUX[20, 10] <- RS22_ANTRAB_2020_GERAL[17, 24]
AUX[21, 10] <- RS22_ANTRAB_2020_GERAL[17, 25]
AUX[22, 10] <- RS22_ANTRAB_2020_GERAL[17, 26]
AUX[23, 10] <- RS22_ANTRAB_2020_GERAL[17, 27]
AUX[24, 10] <- RS22_ANTRAB_2020_GERAL[17, 28]

AUX[1, 11] <- RS22_ANTRAB_2021_GERAL[17, 5]
AUX[2, 11] <- RS22_ANTRAB_2021_GERAL[17, 6]
AUX[3, 11] <- RS22_ANTRAB_2021_GERAL[17, 7]
AUX[4, 11] <- RS22_ANTRAB_2021_GERAL[17, 8]
AUX[5, 11] <- RS22_ANTRAB_2021_GERAL[17, 9]
AUX[6, 11] <- RS22_ANTRAB_2021_GERAL[17, 10]
AUX[7, 11] <- RS22_ANTRAB_2021_GERAL[17, 11]
AUX[8, 11] <- RS22_ANTRAB_2021_GERAL[17, 12]
AUX[9, 11] <- RS22_ANTRAB_2021_GERAL[17, 13]
AUX[10, 11] <- RS22_ANTRAB_2021_GERAL[17, 14]
AUX[11, 11] <- RS22_ANTRAB_2021_GERAL[17, 15]
AUX[12, 11] <- RS22_ANTRAB_2021_GERAL[17, 16]
AUX[13, 11] <- RS22_ANTRAB_2021_GERAL[17, 17]
AUX[14, 11] <- RS22_ANTRAB_2021_GERAL[17, 18]
AUX[15, 11] <- RS22_ANTRAB_2021_GERAL[17, 19]
AUX[16, 11] <- RS22_ANTRAB_2021_GERAL[17, 20]
AUX[17, 11] <- RS22_ANTRAB_2021_GERAL[17, 21]
AUX[18, 11] <- RS22_ANTRAB_2021_GERAL[17, 22]
AUX[19, 11] <- RS22_ANTRAB_2021_GERAL[17, 23]
AUX[20, 11] <- RS22_ANTRAB_2021_GERAL[17, 24]
AUX[21, 11] <- RS22_ANTRAB_2021_GERAL[17, 25]
AUX[22, 11] <- RS22_ANTRAB_2021_GERAL[17, 26]
AUX[23, 11] <- RS22_ANTRAB_2021_GERAL[17, 27]
AUX[24, 11] <- RS22_ANTRAB_2021_GERAL[17, 28]

AUX[1, 12] <- RS22_ANTRAB_2022_GERAL[17, 5]
AUX[2, 12] <- RS22_ANTRAB_2022_GERAL[17, 6]
AUX[3, 12] <- RS22_ANTRAB_2022_GERAL[17, 7]
AUX[4, 12] <- RS22_ANTRAB_2022_GERAL[17, 8]
AUX[5, 12] <- RS22_ANTRAB_2022_GERAL[17, 9]
AUX[6, 12] <- RS22_ANTRAB_2022_GERAL[17, 10]
AUX[7, 12] <- RS22_ANTRAB_2022_GERAL[17, 11]
AUX[8, 12] <- RS22_ANTRAB_2022_GERAL[17, 12]
AUX[9, 12] <- RS22_ANTRAB_2022_GERAL[17, 13]
AUX[10, 12] <- RS22_ANTRAB_2022_GERAL[17, 14]
AUX[11, 12] <- RS22_ANTRAB_2022_GERAL[17, 15]
AUX[12, 12] <- RS22_ANTRAB_2022_GERAL[17, 16]
AUX[13, 12] <- RS22_ANTRAB_2022_GERAL[17, 17]
AUX[14, 12] <- RS22_ANTRAB_2022_GERAL[17, 18]
AUX[15, 12] <- RS22_ANTRAB_2022_GERAL[17, 19]
AUX[16, 12] <- RS22_ANTRAB_2022_GERAL[17, 20]
AUX[17, 12] <- RS22_ANTRAB_2022_GERAL[17, 21]
AUX[18, 12] <- RS22_ANTRAB_2022_GERAL[17, 22]
AUX[19, 12] <- RS22_ANTRAB_2022_GERAL[17, 23]
AUX[20, 12] <- RS22_ANTRAB_2022_GERAL[17, 24]
AUX[21, 12] <- RS22_ANTRAB_2022_GERAL[17, 25]
AUX[22, 12] <- RS22_ANTRAB_2022_GERAL[17, 26]
AUX[23, 12] <- RS22_ANTRAB_2022_GERAL[17, 27]
AUX[24, 12] <- RS22_ANTRAB_2022_GERAL[17, 28]

AUX[1, 13] <- RS22_ANTRAB_2023_GERAL[17, 5]
AUX[2, 13] <- RS22_ANTRAB_2023_GERAL[17, 6]
AUX[3, 13] <- RS22_ANTRAB_2023_GERAL[17, 7]
AUX[4, 13] <- RS22_ANTRAB_2023_GERAL[17, 8]
AUX[5, 13] <- RS22_ANTRAB_2023_GERAL[17, 9]
AUX[6, 13] <- RS22_ANTRAB_2023_GERAL[17, 10]
AUX[7, 13] <- RS22_ANTRAB_2023_GERAL[17, 11]
AUX[8, 13] <- RS22_ANTRAB_2023_GERAL[17, 12]
AUX[9, 13] <- RS22_ANTRAB_2023_GERAL[17, 13]
AUX[10, 13] <- RS22_ANTRAB_2023_GERAL[17, 14]
AUX[11, 13] <- RS22_ANTRAB_2023_GERAL[17, 15]
AUX[12, 13] <- RS22_ANTRAB_2023_GERAL[17, 16]
AUX[13, 13] <- RS22_ANTRAB_2023_GERAL[17, 17]
AUX[14, 13] <- RS22_ANTRAB_2023_GERAL[17, 18]
AUX[15, 13] <- RS22_ANTRAB_2023_GERAL[17, 19]
AUX[16, 13] <- RS22_ANTRAB_2023_GERAL[17, 20]
AUX[17, 13] <- RS22_ANTRAB_2023_GERAL[17, 21]
AUX[18, 13] <- RS22_ANTRAB_2023_GERAL[17, 22]
AUX[19, 13] <- RS22_ANTRAB_2023_GERAL[17, 23]
AUX[20, 13] <- RS22_ANTRAB_2023_GERAL[17, 24]
AUX[21, 13] <- RS22_ANTRAB_2023_GERAL[17, 25]
AUX[22, 13] <- RS22_ANTRAB_2023_GERAL[17, 26]
AUX[23, 13] <- RS22_ANTRAB_2023_GERAL[17, 27]
AUX[24, 13] <- RS22_ANTRAB_2023_GERAL[17, 28]

AUX <- as.data.frame(t(AUX))

colnames(AUX) <- AUX[1, ]

AUX <- AUX[-1, ] 

AUX[, 1] <- as.numeric(AUX[, 1])

AUX[, 25] <- c("2012", "2013", "2014", "2015", "2016", "2017", 
                                       "2018", "2019", "2020", "2021", "2022", "2023")

assign(paste0("RS", "_ANTRAB_BASE_Serie_Historica"), AUX)

write.csv (assign(paste0("RS", "_ANTRAB_BASE_Serie_Historica"), AUX), 
           paste0("Base_de_Dados/Tabulacoes_R/Raiva/RS", "_ANTRAB_BASE_Serie_Historica.csv"), 
           row.names = FALSE)

####  Canal Endêmico  ###

RS_CE_Base_ANTRAB <- data.frame("ANO" = NA)

RS_CE_Base_ANTRAB[1, 1] <- "2012"
RS_CE_Base_ANTRAB[1, 2:54] <- as.integer(data.frame(RS22_ANTRAB_2012_SE_Notificados[nrow(RS22_ANTRAB_2012_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2013"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2013_SE_Notificados[nrow(RS22_ANTRAB_2013_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2014"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2014_SE_Notificados[nrow(RS22_ANTRAB_2014_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2015"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2015_SE_Notificados[nrow(RS22_ANTRAB_2015_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2016"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2016_SE_Notificados[nrow(RS22_ANTRAB_2016_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2017"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2017_SE_Notificados[nrow(RS22_ANTRAB_2017_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2018"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2018_SE_Notificados[nrow(RS22_ANTRAB_2018_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2019"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2019_SE_Notificados[nrow(RS22_ANTRAB_2019_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2020"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2020_SE_Notificados[nrow(RS22_ANTRAB_2020_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2021"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2021_SE_Notificados[nrow(RS22_ANTRAB_2021_SE_Notificados), 2:54]))

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB)+1), 1] <- "2022"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2022_SE_Notificados[nrow(RS22_ANTRAB_2022_SE_Notificados), 2:54]))

colnames (RS_CE_Base_ANTRAB)[2:54] <- c(1:53)

####################################################################################################################
################Trabalhando as tabelas base do Canal Endêmico   ####################################################
####################################################################################################################

######     Canal Endêmico    NOTIFICADOS#####

RS_CE_Base_ANTRAB[(nrow(RS_CE_Base_ANTRAB) +1), 1] <- "2023"
RS_CE_Base_ANTRAB[nrow(RS_CE_Base_ANTRAB), 2:54] <- as.integer(data.frame(RS22_ANTRAB_2023_SE_Notificados[nrow(RS22_ANTRAB_2023_SE_Notificados), 2:54]))

#####################################################################################################################
#####                   Utilizando objetos auxiliares porque se transpor o data frame                   #############
#####                   direto ele transforma as variáveis em caracter.                                 #############
#####                                                                                                   #############         
#####                     NÃO FOI DESCARTADO AINDA OS PERÍODOS EPIDÊMICOS                               #############
#####               VERIFICAR SE PODE-SE UTILIZAR A MÉDIA COMO LIMITE INFERIOR.                         #############
#####################################################################################################################

AUX <- RS_CE_Base_ANTRAB[, -1]

AUX <- t(AUX)

AUX2 <- RS_CE_Base_ANTRAB[, 1]

colnames(AUX) <- AUX2

RS_CE_ANTRAB <- AUX

######        Criando a coluna de média no data.frame            #####################

AUX <- apply(RS_CE_ANTRAB[, 1: (ncol(RS_CE_ANTRAB)-1)], 1 , mean)

RS_CE_ANTRAB <- as.data.frame(RS_CE_ANTRAB)

RS_CE_ANTRAB$Media <- AUX

######              Criando a coluna de Desvio Padrão no data frame                ###############

AUX <- apply(RS_CE_ANTRAB[, 1: (ncol(RS_CE_ANTRAB) -2)], 1 , sd)

RS_CE_ANTRAB$Desvio_Padrao <- AUX

######       Criando a coluna de Média + 2(DP)    ######################

AUX <- RS_CE_ANTRAB[, (ncol(RS_CE_ANTRAB)-1):ncol(RS_CE_ANTRAB)]

AUX <- AUX %>% mutate(Lim_Superior = (Media + 1.96 * Desvio_Padrao))

RS_CE_ANTRAB$Lim_Superior <- AUX$Lim_Superior

RS_CE_ANTRAB[, (ncol(RS_CE_ANTRAB)+1)] <- rownames(RS_CE_ANTRAB)

RS_CE_ANTRAB <- RS_CE_ANTRAB[, c(ncol(RS_CE_ANTRAB), 1:(ncol(RS_CE_ANTRAB) -1))]

RS_CE_ANTRAB[, 1] <- c(31:53, 1:30)

colnames(RS_CE_ANTRAB)[1] <- "Semana_Epidemiológica"

rownames(RS_CE_ANTRAB) <- c(1: nrow(RS_CE_ANTRAB))

rm(AUX, AUX2, RS_CE_Base_ANTRAB)

write.csv (RS_CE_ANTRAB, 
           paste0("Base_de_Dados/Tabulacoes_R/Raiva/RS", "RS", "_CE_ANTRAB.csv"), 
           row.names = FALSE)

###    CANAL ENDÊMICO NOTIFICADOS     ####

###    Puxando os dados da tabela RS22_CE_Notificados e excluindo os períodos epidêmicos:   ######
###                             2015/16, 2019/20 e 2021/22                                  ######

AUX_GRAF <- RS_CE_ANTRAB[,]

###      Usando apply para tirar a média por semana epidemiológica      ####

AUX_GRAF$Media <- apply(AUX_GRAF[, ], 1 , mean)

###       Usando apply para tirar o desvio padrão por semana epidemiológica      #####

AUX_GRAF$Desvio_Padrao <- apply(AUX_GRAF[, 2:13], 1 , sd)

######      Criando a coluna de Média + 2(DP)    ###############

AUX_GRAF <- AUX_GRAF[, c((ncol(AUX_GRAF) -1): ncol(AUX_GRAF))]

AUX_GRAF$Lim_Superior <- NA

AUX_GRAF <- AUX_GRAF %>% mutate(Lim_Superior = (Media + 1.96 * Desvio_Padrao))

###Criando uma coluna de ordem das se para o R não colocar em ordem numérica.

AUX_GRAF$Ordem <- c(1: nrow(RS_CE_ANTRAB))

###Puxando o período sazonal atual para o gráfico de linhas

AUX_GRAF$`2022/23` <- RS_CE_Notificados$`2022/23`

AUX_GRAF$Sem_Epidemiológica <- RS_CE_ANTRAB$Semana_Epidemiológica

AUX_GRAF$Sem_EPI <-as.character(c("2022/1",  "2022/2", "2022/3", 
                                  "2022/4",  "2022/5",  "2022/6",  
                                  "2022/7",  "2022/8",  "2022/9",  
                                  "2022/10",  "2022/11",  "2022/12",  
                                  "2022/13",  "2022/14",  "2022/15",  
                                  "2022/16",  "2022/17",  "2022/18",  
                                  "2022/19",  "2022/20",  "2022/21",  
                                  "2022/22",  "2022/23",  "2023/24",  
                                  "2023/25",  "2023/26",  "2023/27",  
                                  "2023/28",  "2023/29",  "2023/30",  
                                  "2023/31",  "2023/32",  "2023/33", 
                                  "2023/34",  "2023/35",  "2023/36",  
                                  "2023/37",  "2023/38",  "2023/39",  
                                  "2023/40",  "2023/41",  "2023/42",  
                                  "2023/43",  "2023/44",  "2023/45",  
                                  "2023/46",  "2023/47",  "2023/48",  
                                  "2023/49",  "2023/50",  "2023/51",  
                                  "2023/52",  "2023/53")
)

RS_22_23_GRAF_CE_Notificados <- ggplot(AUX_GRAF, aes(Ordem))  +
  theme(axis.text.x = element_text(angle = 85, 
                                   vjust = .5,
                                   face = "bold")) +
  labs(caption = "Fonte",
       title = "Canal Endêmico Casos Notificados - 2022/23") +
  theme(
    panel.grid.major = element_line(color = "#C0C0C0"),
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = "#DC143C"),
    plot.title = element_text(face = "bold",
                              size = 19)
  ) +
  geom_area(aes(,Lim_Superior), fill = "#F0E68C",alpha = 0.9) +
  geom_area(aes(,Media), fill = "#556B2F") +
  geom_line(aes(,`2023`), stat = "identity", color = "black", linewidth = 1.5) +
  xlab("Semana Epidemiológica") +
  ylab("Número de Casos") +
  scale_x_continuous(breaks = c(1:53), label = AUX_GRAF$Sem_EPI) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.05)))


ggplot(AUX, aes(x = V25, y = Notificados)) + 
  theme(axis.text.x = element_text(angle = 60, 
                                   vjust = .5,
                                   face = "bold",
                                   size = 14)) +
  labs(caption = "Fonte", 
       x = "Anos",
       y = "Nº de Casos",
       title = "CASOS NOTIFICADOS 22ªRS (2012 - 2023)") +
  theme( panel.grid.major = element_line(color = "#C0C0C0"),
         panel.grid.minor = element_blank(),
         panel.background = element_rect(fill = "#F5F5F5"),
         plot.title = element_text(face = "bold",
                                   size = 20,
                                   colour = "#556B2F")) +
  geom_bar(
    stat = "identity",
    fill = "#556B2F",
    color = "black",
    width = .4) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
  geom_label(aes(label = Notificados),
             alpha = 0.5,
             size =3, 
             nudge_y = 4)
  