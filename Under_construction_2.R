rm(list =ls())
###############################################################################################################
###############################################################################################################
##                                                                                                           ##
##    Script elaborado em ambiente LINUX. Para replicação deve ser ajustado os caminhos dos diretórios       ##
##    ################################################################################################       ##
##                                                                                                           ##
##    Até o ponto em que é necessario autenticação de acesso à internet todos os passos abaixo são           ##
##    reprodutíveis em qualquer computador desde que os itens abaixo sejam executados corretamente.          ##
##    #############################################################################################          ## 
##                                                                                                           ##
##    /home/gustavo/Área de trabalho/Análise_de_Dados/Arboviroses_Geral deve ser previamente rodado          ##
##    para que o script abaixo funcione.                                                                     ##
##    ############################################################################################           ##
##                                                                                                           ##
###############################################################################################################
###############################################################################################################

#####      Definindo diretório de trabalho, caso tenha que trabalhar em Windows, acertar o diretório       ####

setwd("/home/gustavo/Área de Trabalho/Análise_de_Dados/")

#######################################################################################################################
###Importação da Base de Dados e Criação de Objetos Primários e seleção com DPLYR %>% select de colunas de interesse. É
###necessário atenção para a mudança da ficha do SINAN em 2015.########################################################
###O arquivo Planilha_Base_IBGE.CSV possui os municípios e seus respectivos códigos do IBGE. É uma planilha que serve##
###de "engrenagem" para os loops#######################################################################################
#######################################################################################################################

BASE_IBGE<-read.table(file="Base_de_Dados/Planilha_Base_IBGE.csv", 
                      header=TRUE, 
                      sep=",")
################################################################################################################

############################################################################################
####   Definindo o objeto RS para servir de apoio para    ##################################
####    buscar dados de todas as RS. Usar 1, 2, 3..., 21, 22    ############################
############################################################################################

RS <- 22   #####  Deve-se colocar AQUI a Regional

######   Criando objeto ID_REG. Será utilizado para selecionar
######   RS no DBF do SINAN ONLINE.

ID_REG <- as.data.frame(BASE_IBGE[which(BASE_IBGE$RS == RS), 6])

ID_REG <- as.numeric(ID_REG[1,1])

####   Estabelecendo o número de municípios em cada RS

nrow <- NROW(BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

##
###libraries###
##

library(dplyr)
library(foreign)

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

##
###Construindo o conjunto de tabelas necessárias por período sazonal####
##

#####################################################################################################################
########################################         2009/10          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2009 <- read.dbf(file = "Base_de_Dados/DBF/DENGON2009.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

DENGON2010 <- read.dbf(file = "Base_de_Dados/DBF/DENGON2010.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2009$SEM_PRI <-as.numeric(as.character(DENGON2009$SEM_PRI))

DENGON2010$SEM_PRI <-as.numeric(as.character(DENGON2010$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2009 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 200931)

AUX02 <- DENGON2010 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201030)

SINAN_DENGUE_09_10_RS <- rbind(AUX01, 
                         AUX02)

assign(paste0("RS", RS, "_09_10_SINAN"), 
       SINAN_DENGUE_09_10_RS) 

write.csv (assign(paste0("RS", RS, "_09_10_SINAN"), SINAN_DENGUE_09_10_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_09_10_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2009 já utilizada###

rm (DENGON2009)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200931)%>%
                                                                                      count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200932) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200933) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                     filter(ID_MN_RESI == i, 
                                                                                            SEM_PRI ==200934) %>% 
                                                                                     count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200935) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200936) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200937) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             SEM_PRI ==200938) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200939) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200940) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==200941) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200942) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200943) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200944) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200945) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200946) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200947) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200948) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200949) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                        filter(ID_MN_RESI == i, 
                                                                                               SEM_PRI ==200950) %>%
                                                                                        count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==200951) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==200952) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==200953) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201001) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201002) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201003) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201004) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201005) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201006) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201007) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201008) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201009) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201010) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_09_10_RS%>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201011) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201012) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201013) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201014) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201015) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201016) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201017) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201018) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201019) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201020) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201021) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              SEM_PRI ==201022) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201023) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201024) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201025) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201026) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201027) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201028) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_09_10_RS%>%  
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201029) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_09_10_RS%>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              SEM_PRI ==201030) %>% 
                                                                                       count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_09_10_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_09_10_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_09_10_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200931)%>%
                                                                                      count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200932) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200933) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                     filter(ID_MN_RESI == i, 
                                                                                            CLASSI_FIN == 1 
                                                                                            | 
                                                                                              CLASSI_FIN == 2 
                                                                                            |
                                                                                              CLASSI_FIN == 3
                                                                                            |
                                                                                              CLASSI_FIN == 4,
                                                                                            SEM_PRI ==200934) %>% 
                                                                                     count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200935) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200936) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200937) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 1 
                                                                                             | 
                                                                                               CLASSI_FIN == 2 
                                                                                             |
                                                                                               CLASSI_FIN == 3
                                                                                             |
                                                                                               CLASSI_FIN == 4,
                                                                                             SEM_PRI ==200938) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200939) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200940) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200941) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200942) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200943) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200944) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200945) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200946) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200947) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200948) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200949) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                        filter(ID_MN_RESI == i,
                                                                                               CLASSI_FIN == 1 
                                                                                               | 
                                                                                                 CLASSI_FIN == 2 
                                                                                               |
                                                                                                 CLASSI_FIN == 3
                                                                                               |
                                                                                                 CLASSI_FIN == 4,
                                                                                               SEM_PRI ==200950) %>%
                                                                                        count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200951) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200952) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==200953) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201001) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201002) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201003) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201004) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201005) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201006) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201007) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201008) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201009) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201010) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_09_10_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201011) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201012) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201013) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201014) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201015) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201016) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201017) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201018) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201019) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201020) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201021) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201022) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201023) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201024) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201025) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201026) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201027) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201028) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_09_10_RS %>%  
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201029) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 1 
                                                                                              | 
                                                                                                CLASSI_FIN == 2 
                                                                                              |
                                                                                                CLASSI_FIN == 3
                                                                                              |
                                                                                                CLASSI_FIN == 4,
                                                                                              SEM_PRI ==201030) %>% 
                                                                                       count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_09_10_SE_Confirmados"), AUX)

assign(paste0("RS", "_09_10_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_09_10_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_09_10_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i) %>%
                                                                             count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                            filter(CLASSI_FIN == 1, 
                                                                                   ID_MN_RESI == i) %>% 
                                                                            count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_09_10_RS %>%  
                                                                             filter(CLASSI_FIN == 2, 
                                                                                    ID_MN_RESI == i) %>% 
                                                                             count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_09_10_RS %>%   
                                                                             filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                                                    ID_MN_RESI == i) %>% 
                                                                             count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_09_10_RS %>%  
                                                                            filter(CLASSI_FIN == 5,
                                                                                   ID_MN_RESI == i) %>% 
                                                                            count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    TPAUTOCTO == 1) %>% 
                                                                             count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CRITERIO == 1) %>% 
                                                                              count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i,
                                                                                     CRITERIO == 2) %>% 
                                                                              count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    SOROTIPO == 1) %>% 
                                                                             count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     SOROTIPO == 2) %>% 
                                                                              count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     SOROTIPO == 3) %>% 
                                                                              count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    SOROTIPO == 4) %>% 
                                                                             count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     HOSPITALIZ == 1) %>% 
                                                                              count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     EVOLUCAO == 2) %>% 
                                                                              count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_09_10_GERAL"), AUX)

assign(paste0("RS", "_09_10_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_09_10_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_09_10_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i,  
                                                                                    NU_IDADE_N <=3012) %>% 
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i,  
                                                                                    NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i,
                                                                                    NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    NU_IDADE_N > 4018) %>%
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i,
                                                                                    CS_ZONA == 1) %>% 
                                                                             count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i,
                                                                                     CS_ZONA == 2) %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                               filter(ID_MN_RESI == i, 
                                                                                      CS_SEXO == "F") %>% 
                                                                               count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_SEXO == "M") %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    CS_ESCOL_N == 0) %>% 
                                                                             count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                                              count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 4) %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 5) %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 6) %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 7) %>% 
                                                                              count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                              filter(ID_MN_RESI == i, 
                                                                                     CS_ESCOL_N == 8) %>% 
                                                                              count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_09_10_RS %>% 
                                                                             filter(ID_MN_RESI == i, 
                                                                                    CS_ESCOL_N == 9) %>% 
                                                                             count() 
  )
}                                             

assign(paste0("RS", RS, "_09_10_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_09_10_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_09_10_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_09_10_RS)

#####################################################################################################################
########################################         2010/11          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2011 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2011.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2011$SEM_PRI <-as.numeric(as.character(DENGON2011$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2010 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201031)

AUX02 <- DENGON2011 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201130)

SINAN_DENGUE_10_11_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_10_11_SINAN"), 
       SINAN_DENGUE_10_11_RS) 

write.csv (assign(paste0("RS", RS, "_10_11_SINAN"), SINAN_DENGUE_10_11_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_10_11_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2009 já utilizada###

rm (DENGON2010)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201031)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201032) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201033) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201034) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201035) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201036) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201037) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201038) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201039) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201042) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201043) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201045) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201046) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201047) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201049) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201050) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201053) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201101) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201102) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201103) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201104) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201105) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201106) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201107) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201108) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201109) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201110) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_10_11_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201111) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201113) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201114) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201115) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201116) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201117) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201118) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201119) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201120) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201122) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201123) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201124) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201125) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201126) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201127) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201128) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_10_11_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201129) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_10_11_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201130) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_10_11_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_10_11_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_10_11_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201031)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201032) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201033) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201034) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201035) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201036) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201037) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201038) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201039) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201042) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201043) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201045) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201046) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201047) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201049) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201050) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201053) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201101) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201102) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201103) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201104) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201105) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201106) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201107) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201108) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201109) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201110) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_10_11_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201111) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201113) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201114) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201115) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201116) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201117) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201118) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201119) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201120) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201122) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201123) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201124) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201125) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201126) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201127) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201128) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_10_11_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201129) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201130) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_10_11_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_10_11_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_10_11_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_10_11_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_10_11_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_10_11_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_10_11_GERAL"), AUX)

assign(paste0("RS", "_10_11_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_10_11_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_10_11_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_10_11_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_10_11_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_10_11_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_10_11_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_10_11_RS)

#####################################################################################################################
########################################         2011/12          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2012 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2012.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2012$SEM_PRI <-as.numeric(as.character(DENGON2012$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2011 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201131)

AUX02 <- DENGON2012 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201230)

SINAN_DENGUE_11_12_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_11_12_SINAN"), 
       SINAN_DENGUE_11_12_RS) 

write.csv (assign(paste0("RS", RS, "_11_12_SINAN"), SINAN_DENGUE_11_12_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_11_12_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2009 já utilizada###

rm (DENGON2011)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201131)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201132) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201133) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201134) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201135) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201136) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201137) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201138) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201139) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201142) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201143) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201145) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201146) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201147) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201149) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201150) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201153) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201201) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201202) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201203) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201204) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201205) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201206) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201207) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201208) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201209) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201210) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_11_12_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201211) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201213) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201214) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201215) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201216) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201217) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201218) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201219) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201220) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201222) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201223) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201224) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201225) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201226) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201227) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201228) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_11_12_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201229) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_11_12_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201230) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_11_12_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_11_12_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_11_12_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201131)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201132) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201133) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201134) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201135) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201136) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201137) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201138) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201139) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201142) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201143) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201145) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201146) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201147) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201149) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201150) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201153) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201201) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201202) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201203) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201204) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201205) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201206) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201207) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201208) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201209) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201210) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_11_12_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201211) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201213) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201214) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201215) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201216) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201217) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201218) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201219) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201220) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201222) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201223) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201224) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201225) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201226) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201227) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201228) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_11_12_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201229) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201230) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_11_12_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_11_12_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_11_12_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_11_12_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_11_12_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_11_12_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_11_12_GERAL"), AUX)

assign(paste0("RS", "_11_12_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_11_12_GERAL"), AUX),
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_11_12_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_11_12_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_11_12_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_11_12_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_11_12_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_11_12_RS)

#####################################################################################################################
########################################         2012/13          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2013 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2013.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2013$SEM_PRI <-as.numeric(as.character(DENGON2013$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2012 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201231)

AUX02 <- DENGON2013 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201330)

SINAN_DENGUE_12_13_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_12_13_SINAN"), 
       SINAN_DENGUE_12_13_RS) 

write.csv (assign(paste0("RS", RS, "_12_13_SINAN"), SINAN_DENGUE_12_13_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_12_13_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2012 já utilizada###

rm (DENGON2012)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)


for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201231)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201232) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201233) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201234) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201235) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201236) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201237) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201238) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201239) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201240) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201241) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201242) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201243) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201245) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201246) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201247) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201249) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201250) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201251) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201252) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201253) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201301) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201302) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201303) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201304) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201305) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201306) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201307) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201308) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201309) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201310) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_12_13_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201311) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201313) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201314) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201315) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201316) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201317) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201318) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201319) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201320) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201322) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201323) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201324) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201325) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201326) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201327) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201328) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_12_13_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201329) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_12_13_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201330) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_12_13_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_12_13_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_12_13_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201231)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201232) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201233) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201234) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201235) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201236) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201237) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201238) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201239) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201240) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201241) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201242) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201243) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201245) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201246) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201247) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201249) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201250) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201251) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201252) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201253) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201301) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201302) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201303) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201304) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201305) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201306) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201307) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201308) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201309) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201310) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_12_13_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201311) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201313) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201314) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201315) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201316) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201317) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201318) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201319) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201320) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201322) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201323) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201324) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201325) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201326) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201327) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201328) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_12_13_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201329) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201330) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_12_13_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_12_13_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_12_13_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_12_13_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_12_13_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_12_13_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_12_13_GERAL"), AUX)

assign(paste0("RS", "_12_13_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_12_13_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_12_13_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_12_13_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_12_13_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_12_13_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_12_13_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_12_13_RS)

#####################################################################################################################
########################################         2013/14          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2014 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2014.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2014$SEM_PRI <-as.numeric(as.character(DENGON2014$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2013 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201331)

AUX02 <- DENGON2014 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201430)

SINAN_DENGUE_13_14_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_13_14_SINAN"), 
       SINAN_DENGUE_13_14_RS) 

write.csv (assign(paste0("RS", RS, "_13_14_SINAN"), SINAN_DENGUE_13_14_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_13_14_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2013 já utilizada###

rm (DENGON2013)


#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)


for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201331)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201332) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201333) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201334) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201335) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201336) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201337) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201338) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201339) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201340) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201341) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201342) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201343) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201345) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201346) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201347) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201349) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201350) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201351) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201352) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201353) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201401) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201402) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201403) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201404) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201405) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201406) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201407) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201408) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201409) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201410) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_13_14_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201411) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201413) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201414) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201415) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201416) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201417) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201418) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201419) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201420) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201422) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201423) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201424) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201425) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201426) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201427) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201428) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_13_14_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201429) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_13_14_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201430) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_13_14_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_13_14_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_13_14_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201331)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201332) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201333) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201334) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201335) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201336) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201337) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201338) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201339) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201340) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201341) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201342) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201343) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201345) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201346) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201347) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201349) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201350) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201351) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201352) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201353) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201401) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201402) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201403) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201404) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201405) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201406) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201407) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201408) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201409) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201410) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_13_14_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201411) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201413) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201414) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201415) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201416) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201417) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201418) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201419) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201420) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201422) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201423) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201424) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201425) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201426) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201427) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201428) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_13_14_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201429) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201430) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_13_14_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_13_14_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_13_14_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_13_14_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_13_14_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_13_14_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_13_14_GERAL"), AUX)

assign(paste0("RS", "_13_14_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_13_14_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_13_14_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_13_14_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_13_14_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_13_14_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_13_14_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_13_14_RS)

#####################################################################################################################
########################################         2014/15          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2015 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2015.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2015$SEM_PRI <-as.numeric(as.character(DENGON2015$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2014 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201431)

AUX02 <- DENGON2015 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201530)

SINAN_DENGUE_14_15_RS <- merge(AUX01, 
                               AUX02,
                               all=TRUE)

assign(paste0("RS", RS, "_14_15_SINAN"), 
       SINAN_DENGUE_14_15_RS) 

write.csv (assign(paste0("RS", RS, "_14_15_SINAN"), SINAN_DENGUE_14_15_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_14_15_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2014 já utilizada###

rm (DENGON2014)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)


for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201431)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201432) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201433) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201434) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201435) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201436) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201437) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201438) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201439) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201440) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201441) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201442) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201443) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201445) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201446) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201447) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201449) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201450) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201451) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201452) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201453) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201501) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201502) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201503) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201504) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201505) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201506) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201507) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201508) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201509) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201510) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_14_15_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201511) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201512) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201513) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201514) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201515) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201516) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201517) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201518) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201519) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201520) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201521) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201522) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201523) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201524) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201525) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201526) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201527) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201528) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_14_15_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201529) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_14_15_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201530) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_14_15_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_14_15_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_14_15_SE_Notificados.csv", 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201431)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201432) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201433) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201434) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201435) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201436) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201437) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201438) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201439) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201440) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201441) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201442) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201443) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201445) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201446) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201447) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201449) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201450) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201451) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201452) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201453) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201501) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201502) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201503) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201504) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201505) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201506) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201507) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201508) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201509) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201510) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_14_15_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201511) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201512) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201513) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201514) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201515) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201516) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201517) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201518) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201519) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201520) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201521) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201522) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201523) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201524) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201525) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201526) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201527) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201528) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_14_15_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201529) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201530) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_14_15_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_14_15_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_14_15_SE_Confirmados.csv", 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_14_15_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_14_15_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_14_15_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_14_15_GERAL"), AUX)

assign(paste0("RS", "_14_15_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_14_15_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_14_15_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_14_15_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_14_15_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_14_15_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_14_15_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_14_15_RS)

#####################################################################################################################
########################################         2015/16          ###################################################
#####################################################################################################################

###################### A partir de 2015 houve a mudança na ficha do SINAN de DENGUE/CHIKUNGUNYA. ####################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2016 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2016.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2016$SEM_PRI <-as.numeric(as.character(DENGON2016$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2015 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201531)

AUX02 <- DENGON2016 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201630)

SINAN_DENGUE_15_16_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_15_16_SINAN"), 
       SINAN_DENGUE_15_16_RS) 

write.csv (assign(paste0("RS", RS, "_15_16_SINAN"), SINAN_DENGUE_15_16_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2015 já utilizada###

rm (DENGON2015)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201531)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201532) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201533) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201534) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201535) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201536) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201537) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201538) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201539) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201540) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201541) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201542) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201543) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201544) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201545) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201546) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201547) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201548) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201549) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201550) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201551) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201552) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201553) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201601) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201602) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201603) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201604) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201605) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201606) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201607) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201608) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201609) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201610) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201611) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201612) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201613) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201614) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201615) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201616) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201617) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201618) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201619) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201620) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201621) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201622) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201623) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201624) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201625) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201626) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201627) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201628) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201629) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201630) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_15_16_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
                                    nrow = nrow, 
                                    ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201531)%>%
                                                                                      count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201532) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201533) %>% 
                                                                                      count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                     filter(ID_MN_RESI == i,
                                                                                            CLASSI_FIN == 10 
                                                                                            | 
                                                                                              CLASSI_FIN == 11 
                                                                                            |
                                                                                              CLASSI_FIN == 12,
                                                                                            SEM_PRI ==201534) %>% 
                                                                                     count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                      filter(ID_MN_RESI == i,
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201535) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201536) %>%
                                                                                      count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201537) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                      filter(ID_MN_RESI == i, 
                                                                                             CLASSI_FIN == 10 
                                                                                             | 
                                                                                               CLASSI_FIN == 11 
                                                                                             |
                                                                                               CLASSI_FIN == 12,
                                                                                             SEM_PRI ==201538) %>% 
                                                                                      count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201539) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201540) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201541) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201542) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201543) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201544) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201545) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201546) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201547) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201548) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201549) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                        filter(ID_MN_RESI == i,
                                                                                               CLASSI_FIN == 10 
                                                                                               | 
                                                                                                 CLASSI_FIN == 11 
                                                                                               |
                                                                                                 CLASSI_FIN == 12,
                                                                                               SEM_PRI ==201550) %>%
                                                                                        count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201551) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201552) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201553) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201601) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201602) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201603) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201604) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201605) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201606) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201607) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201608) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201609) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201610) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201611) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201612) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201613) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201614) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201615) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201616) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201617) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201618) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201619) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201620) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201621) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201622) %>%
                                                                                       count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201623) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201624) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201625) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i, 
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201626) %>% 
                                                                                       count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201627) %>% 
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201628) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201629) %>%
                                                                                       count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                                                       filter(ID_MN_RESI == i,
                                                                                              CLASSI_FIN == 10 
                                                                                              | 
                                                                                                CLASSI_FIN == 11 
                                                                                              |
                                                                                                CLASSI_FIN == 12,
                                                                                              SEM_PRI ==201630) %>%
                                                                                       count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_15_16_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_GERAL"), AUX)

assign(paste0("RS", "_15_16_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_15_16_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas. Possível somente a partir de 2015                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_SINAIS.csv", 
           row.names = FALSE)


#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_15_16_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_15_16_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_15_16_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_15_16_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_15_16_RS)

#####################################################################################################################
########################################         2016/17          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2017 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2017.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2017$SEM_PRI <-as.numeric(as.character(DENGON2017$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2016 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201631)

AUX02 <- DENGON2017 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201730)

SINAN_DENGUE_16_17_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_16_17_SINAN"), 
       SINAN_DENGUE_16_17_RS) 

write.csv (assign(paste0("RS", RS, "_16_17_SINAN"), SINAN_DENGUE_16_17_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2016 já utilizada###

rm (DENGON2016)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201631)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201632) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201633) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201634) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201635) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201636) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201637) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201638) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201639) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201640) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201641) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201642) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201643) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201644) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201645) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201646) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201647) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201648) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201649) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201650) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201651) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201652) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201653) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201701) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201702) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201703) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201704) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201705) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201706) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201707) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201708) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201709) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201710) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201711) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201712) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201713) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201714) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201715) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201716) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201717) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201718) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201719) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201720) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201721) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201722) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201723) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201724) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201725) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201726) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201727) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201728) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201729) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201730) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_16_17_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201631)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201632) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201633) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201634) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201635) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201636) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201637) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201638) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201639) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201640) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201641) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201642) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201643) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201644) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201645) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201646) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201647) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201648) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201649) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201650) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201651) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201652) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201653) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201701) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201702) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201703) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201704) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201705) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201706) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201707) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201708) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201709) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201710) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201711) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201712) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201713) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201714) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201715) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201716) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201717) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201718) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201719) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201720) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201721) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201722) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201723) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201724) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201725) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201726) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201727) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201728) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201729) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201730) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_16_17_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_GERAL"), AUX)

assign(paste0("RS", "_16_17_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_16_17_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_16_17_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_16_17_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_16_17_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_16_17_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_16_17_RS)

#####################################################################################################################
########################################         2017/18          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2018 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2018.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2018$SEM_PRI <-as.numeric(as.character(DENGON2018$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2017 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201731)

AUX02 <- DENGON2018 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201830)

SINAN_DENGUE_17_18_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_17_18_SINAN"), 
       SINAN_DENGUE_17_18_RS) 

write.csv (assign(paste0("RS", RS, "_17_18_SINAN"), SINAN_DENGUE_17_18_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2017 já utilizada###

rm (DENGON2017)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201731)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201732) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201733) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201734) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201735) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201736) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201737) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201738) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201739) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201740) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201741) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201742) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201743) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201744) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201745) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201746) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201747) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201748) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201749) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201750) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201751) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201752) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201753) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201801) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201802) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201803) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201804) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201805) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201806) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201807) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201808) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201809) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201810) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201811) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201812) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201813) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201814) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201815) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201816) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201817) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201818) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201819) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201820) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201821) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201822) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201823) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201824) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201825) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201826) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201827) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201828) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201829) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201830) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_17_18_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201731)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201732) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201733) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201734) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201735) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201736) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201737) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201738) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201739) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201740) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201741) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201742) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201743) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201744) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201745) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201746) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201747) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201748) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201749) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201750) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201751) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201752) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201753) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201801) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201802) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201803) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201804) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201805) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201806) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201807) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201808) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201809) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201810) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201811) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201812) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201813) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201814) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201815) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201816) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201817) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201818) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201819) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201820) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201821) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201822) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201823) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201824) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201825) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201826) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201827) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201828) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201829) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201830) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_17_18_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_GERAL"), AUX)

assign(paste0("RS", "_17_18_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_17_18_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_17_18_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_17_18_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_17_18_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_17_18_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_17_18_RS)

#####################################################################################################################
########################################         2018/19          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2019 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2019.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2019$SEM_PRI <-as.numeric(as.character(DENGON2019$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2018 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201831)

AUX02 <- DENGON2019 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 201930)

SINAN_DENGUE_18_19_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_18_19_SINAN"), 
       SINAN_DENGUE_18_19_RS) 

write.csv (assign(paste0("RS", RS, "_18_19_SINAN"), SINAN_DENGUE_18_19_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2018 já utilizada###

rm (DENGON2018)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201831)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201832) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201833) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201834) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201835) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201836) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201837) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201838) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201839) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201840) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201841) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201842) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201843) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201844) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201845) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201846) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201847) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201848) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201849) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201850) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201851) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201852) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201853) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201901) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201902) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201903) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201904) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201905) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201906) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201907) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201908) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201909) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201910) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201911) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201913) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201914) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201915) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201916) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201917) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201918) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201919) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201920) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201922) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201923) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201925) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201926) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201927) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201929) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201930) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_18_19_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201831)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201832) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201833) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201834) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201835) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201836) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201837) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201838) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201839) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201840) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201841) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201842) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201843) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201844) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201845) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201846) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201847) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201848) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201849) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201850) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201851) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201852) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201853) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201901) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201902) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201903) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201904) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201905) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201906) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201907) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201908) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201909) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201910) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201911) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201913) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201914) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201915) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201916) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201917) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201918) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201919) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201920) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201922) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201923) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201925) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201926) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201927) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201929) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201930) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_18_19_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_GERAL"), AUX)

assign(paste0("RS", "_18_19_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_18_19_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_18_19_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_18_19_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_18_19_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_18_19_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_18_19_RS)

#####################################################################################################################
########################################         2019/20          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2020 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2020.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2020$SEM_PRI <-as.numeric(as.character(DENGON2020$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2019 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201931)

AUX02 <- DENGON2020 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 202030)

SINAN_DENGUE_19_20_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_19_20_SINAN"), 
       SINAN_DENGUE_19_20_RS) 

write.csv (assign(paste0("RS", RS, "_19_20_SINAN"), SINAN_DENGUE_19_20_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2019 já utilizada###

rm (DENGON2019)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201931)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201932) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201933) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201934) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201935) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201936) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201937) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201938) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201939) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201940) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201941) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201942) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201943) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201945) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201946) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201947) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201948) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201949) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201950) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201951) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201952) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201953) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202001) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202002) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202003) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202004) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202005) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202006) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202007) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202008) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202009) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202010) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202011) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202013) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202014) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202015) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202016) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202017) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202019) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202020) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202022) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202023) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202025) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202026) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202027) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202029) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202030) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_19_20_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201931)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201932) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201933) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201934) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201935) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201936) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201937) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201938) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201939) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201940) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201941) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201942) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201943) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201945) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201946) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201947) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201948) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201949) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201950) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201951) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201952) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201953) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202001) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202002) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202003) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202004) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202005) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202006) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202007) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202008) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202009) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202010) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202011) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202013) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202014) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202015) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202016) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202017) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202019) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202020) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202022) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202023) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202025) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202026) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202027) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202029) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202030) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_19_20_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_GERAL"), AUX)

assign(paste0("RS", "_19_20_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_19_20_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_19_20_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_19_20_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_19_20_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_19_20_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_19_20_RS)

#####################################################################################################################
########################################         2020/21          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2021 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2021.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2021$SEM_PRI <-as.numeric(as.character(DENGON2021$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2020 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 202031)

AUX02 <- DENGON2021 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 202130)

SINAN_DENGUE_20_21_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_20_21_SINAN"), 
       SINAN_DENGUE_20_21_RS) 

write.csv (assign(paste0("RS", RS, "_20_21_SINAN"), SINAN_DENGUE_20_21_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2020 já utilizada###

rm (DENGON2020)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202031)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202032) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202033) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202034) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202035) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202036) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202037) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202038) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202039) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202042) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202043) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202045) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202046) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202047) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202048) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202049) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202050) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202053) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202101) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202102) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202103) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202104) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202105) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202106) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202107) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202108) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202109) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202110) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202111) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202113) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202114) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202115) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202116) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202117) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202119) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202120) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202122) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202123) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202125) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202126) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202127) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202129) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202130) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_20_21_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202031)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202032) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202033) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202034) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202035) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202036) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202037) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202038) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202039) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202042) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202043) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202045) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202046) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202047) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202048) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202049) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202050) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202053) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202101) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202102) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202103) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202104) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202105) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202106) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202107) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202108) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202109) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202110) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202111) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202113) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202114) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202115) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202116) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202117) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202119) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202120) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202122) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202123) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202125) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202126) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202127) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202129) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202130) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_20_21_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_GERAL"), AUX)

assign(paste0("RS", "_20_21_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_20_21_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_20_21_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_20_21_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_20_21_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_20_21_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_20_21_RS)

#####################################################################################################################
########################################         2021/22          ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2022 <- read.dbf(file = "/home/gustavo/Área de Trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2022.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2022$SEM_PRI <-as.numeric(as.character(DENGON2022$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

AUX01 <- DENGON2021 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 202131)

AUX02 <- DENGON2022 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI <= 202230)

SINAN_DENGUE_21_22_RS <- rbind(AUX01, 
                               AUX02)

assign(paste0("RS", RS, "_21_22_SINAN"), 
       SINAN_DENGUE_21_22_RS) 

write.csv (assign(paste0("RS", RS, "_21_22_SINAN"), SINAN_DENGUE_21_22_RS), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2021 já utilizada###

rm (DENGON2021)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202131)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202132) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202133) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202134) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202135) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202136) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202137) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202138) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202139) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202142) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202143) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202145) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202146) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202147) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202148) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202149) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202150) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202153) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202201) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202202) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202203) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202204) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202205) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202206) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202207) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202208) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202209) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202210) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202211) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202213) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202214) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202215) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202216) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202217) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202219) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202220) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202222) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202223) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202225) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202226) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202227) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202229) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202230) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_21_22_SE_Notificados"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_SE_Notificados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_SE_Notificados.csv", 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202131)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202132) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202133) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202134) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202135) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202136) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202137) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202138) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202139) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202142) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202143) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202145) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202146) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202147) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202148) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202149) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202150) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202153) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202201) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202202) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202203) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202204) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202205) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202206) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202207) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202208) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202209) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202210) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202211) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202213) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202214) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202215) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202216) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202217) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202219) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202220) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202222) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202223) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202225) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202226) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202227) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202229) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202230) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_21_22_SE_Confirmados"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_SE_Confirmados"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_SE_Confirmados.csv", 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_GERAL"), AUX)

assign(paste0("RS", "_21_22_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_GERAL"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_21_22_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_EXTRA"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_SINAIS"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_SINAIS_DE_ALARME"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_21_22_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_21_22_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_21_22_DENGUE_GRAVE"), AUX), 
           "Base_de_Dados/Tabulacoes_R/Arboviroses/RS22_21_22_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_21_22_RS)

###########################################################################################################################
###########################Elaborando tabelas especiais para serem utilizadas no Informe Epidemiológico####################
###########################################################################################################################

RS_Serie_Historica <- data.frame(RS = paste0("RS", RS), "RS_2009_10" = NA, "RS_2010_11" = NA, 
                                 "RS_2011_12" = NA, "RS_2012_13" = NA, "RS_2013_14" = NA, 
                                 "RS_2014_15" = NA, "RS_2015_16" = NA, "RS_2016_17" = NA, 
                                 "RS_2017_18" = NA, "RS_2018_19" = NA, "RS_2019_20" = NA, 
                                 "RS_2020_21" = NA, "RS_2021_22" = NA)

RS_Serie_Historica[1, 1] <- "Notificados"
RS_Serie_Historica[2, 1] <- "Dengue"
RS_Serie_Historica[3, 1] <- "D.S.A."
RS_Serie_Historica[4, 1] <- "Dengue_Grave"
RS_Serie_Historica[5, 1] <- "Hospitalizados"
RS_Serie_Historica[6, 1] <- "Autóctones"
RS_Serie_Historica[7, 1] <- "DENV_I"
RS_Serie_Historica[8, 1] <- "DENV_II"
RS_Serie_Historica[9, 1] <- "DENV_III"
RS_Serie_Historica[10, 1] <- "DENV_IV"
RS_Serie_Historica[11, 1] <- "Obitos"

RS_Serie_Historica[1, 2] <- sum(RS_09_10_GERAL$Notificados)
RS_Serie_Historica[2, 2] <- sum(RS_09_10_GERAL$Dengue)
RS_Serie_Historica[3, 2] <- sum(RS_09_10_GERAL$D_S_A)
RS_Serie_Historica[4, 2] <- sum(RS_09_10_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 2] <- sum(RS_09_10_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 2] <- sum(RS_09_10_GERAL$Autoctones)
RS_Serie_Historica[7, 2] <- sum(RS_09_10_GERAL$DENV_I)
RS_Serie_Historica[8, 2] <- sum(RS_09_10_GERAL$DENV_II)
RS_Serie_Historica[9, 2] <- sum(RS_09_10_GERAL$DENV_III)
RS_Serie_Historica[10, 2] <- sum(RS_09_10_GERAL$DENV_IV)
RS_Serie_Historica[11, 2] <- sum(RS_09_10_GERAL$Obitos)

RS_Serie_Historica[1, 3] <- sum(RS_10_11_GERAL$Notificados)
RS_Serie_Historica[2, 3] <- sum(RS_10_11_GERAL$Dengue)
RS_Serie_Historica[3, 3] <- sum(RS_10_11_GERAL$D_S_A)
RS_Serie_Historica[4, 3] <- sum(RS_10_11_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 3] <- sum(RS_10_11_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 3] <- sum(RS_10_11_GERAL$Autoctones)
RS_Serie_Historica[7, 3] <- sum(RS_10_11_GERAL$DENV_I)
RS_Serie_Historica[8, 3] <- sum(RS_10_11_GERAL$DENV_II)
RS_Serie_Historica[9, 3] <- sum(RS_10_11_GERAL$DENV_III)
RS_Serie_Historica[10, 3] <- sum(RS_10_11_GERAL$DENV_IV)
RS_Serie_Historica[11, 3] <- sum(RS_10_11_GERAL$Obitos)

RS_Serie_Historica[1, 4] <- sum(RS_11_12_GERAL$Notificados)
RS_Serie_Historica[2, 4] <- sum(RS_11_12_GERAL$Dengue)
RS_Serie_Historica[3, 4] <- sum(RS_11_12_GERAL$D_S_A)
RS_Serie_Historica[4, 4] <- sum(RS_11_12_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 4] <- sum(RS_11_12_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 4] <- sum(RS_11_12_GERAL$Autoctones)
RS_Serie_Historica[7, 4] <- sum(RS_11_12_GERAL$DENV_I)
RS_Serie_Historica[8, 4] <- sum(RS_11_12_GERAL$DENV_II)
RS_Serie_Historica[9, 4] <- sum(RS_11_12_GERAL$DENV_III)
RS_Serie_Historica[10, 4] <- sum(RS_11_12_GERAL$DENV_IV)
RS_Serie_Historica[11, 4] <- sum(RS_11_12_GERAL$Obitos)

RS_Serie_Historica[1, 5] <- sum(RS_12_13_GERAL$Notificados)
RS_Serie_Historica[2, 5] <- sum(RS_12_13_GERAL$Dengue)
RS_Serie_Historica[3, 5] <- sum(RS_12_13_GERAL$D_S_A)
RS_Serie_Historica[4, 5] <- sum(RS_12_13_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 5] <- sum(RS_12_13_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 5] <- sum(RS_12_13_GERAL$Autoctones)
RS_Serie_Historica[7, 5] <- sum(RS_12_13_GERAL$DENV_I)
RS_Serie_Historica[8, 5] <- sum(RS_12_13_GERAL$DENV_II)
RS_Serie_Historica[9, 5] <- sum(RS_12_13_GERAL$DENV_III)
RS_Serie_Historica[10, 5] <- sum(RS_12_13_GERAL$DENV_IV)
RS_Serie_Historica[11, 5] <- sum(RS_12_13_GERAL$Obitos)

RS_Serie_Historica[1, 6] <- sum(RS_13_14_GERAL$Notificados)
RS_Serie_Historica[2, 6] <- sum(RS_13_14_GERAL$Dengue)
RS_Serie_Historica[3, 6] <- sum(RS_13_14_GERAL$D_S_A)
RS_Serie_Historica[4, 6] <- sum(RS_13_14_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 6] <- sum(RS_13_14_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 6] <- sum(RS_13_14_GERAL$Autoctones)
RS_Serie_Historica[7, 6] <- sum(RS_13_14_GERAL$DENV_I)
RS_Serie_Historica[8, 6] <- sum(RS_13_14_GERAL$DENV_II)
RS_Serie_Historica[9, 6] <- sum(RS_13_14_GERAL$DENV_III)
RS_Serie_Historica[10, 6] <- sum(RS_13_14_GERAL$DENV_IV)
RS_Serie_Historica[11, 6] <- sum(RS_13_14_GERAL$Obitos)

RS_Serie_Historica[1, 7] <- sum(RS_14_15_GERAL$Notificados)
RS_Serie_Historica[2, 7] <- sum(RS_14_15_GERAL$Dengue)
RS_Serie_Historica[3, 7] <- sum(RS_14_15_GERAL$D_S_A)
RS_Serie_Historica[4, 7] <- sum(RS_14_15_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 7] <- sum(RS_14_15_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 7] <- sum(RS_14_15_GERAL$Autoctones)
RS_Serie_Historica[7, 7] <- sum(RS_14_15_GERAL$DENV_I)
RS_Serie_Historica[8, 7] <- sum(RS_14_15_GERAL$DENV_II)
RS_Serie_Historica[9, 7] <- sum(RS_14_15_GERAL$DENV_III)
RS_Serie_Historica[10, 7] <- sum(RS_14_15_GERAL$DENV_IV)
RS_Serie_Historica[11, 7] <- sum(RS_14_15_GERAL$Obitos)

RS_Serie_Historica[1, 8] <- sum(RS_15_16_GERAL$Notificados)
RS_Serie_Historica[2, 8] <- sum(RS_15_16_GERAL$Dengue)
RS_Serie_Historica[3, 8] <- sum(RS_15_16_GERAL$D_S_A)
RS_Serie_Historica[4, 8] <- sum(RS_15_16_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 8] <- sum(RS_15_16_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 8] <- sum(RS_15_16_GERAL$Autoctones)
RS_Serie_Historica[7, 8] <- sum(RS_15_16_GERAL$DENV_I)
RS_Serie_Historica[8, 8] <- sum(RS_15_16_GERAL$DENV_II)
RS_Serie_Historica[9, 8] <- sum(RS_15_16_GERAL$DENV_III)
RS_Serie_Historica[10, 8] <- sum(RS_15_16_GERAL$DENV_IV)
RS_Serie_Historica[11, 8] <- sum(RS_15_16_GERAL$Obitos)

RS_Serie_Historica[1, 9] <- sum(RS_16_17_GERAL$Notificados)
RS_Serie_Historica[2, 9] <- sum(RS_16_17_GERAL$Dengue)
RS_Serie_Historica[3, 9] <- sum(RS_16_17_GERAL$D_S_A)
RS_Serie_Historica[4, 9] <- sum(RS_16_17_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 9] <- sum(RS_16_17_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 9] <- sum(RS_16_17_GERAL$Autoctones)
RS_Serie_Historica[7, 9] <- sum(RS_16_17_GERAL$DENV_I)
RS_Serie_Historica[8, 9] <- sum(RS_16_17_GERAL$DENV_II)
RS_Serie_Historica[9, 9] <- sum(RS_16_17_GERAL$DENV_III)
RS_Serie_Historica[10, 9] <- sum(RS_16_17_GERAL$DENV_IV)
RS_Serie_Historica[11, 9] <- sum(RS_16_17_GERAL$Obitos)

RS_Serie_Historica[1, 10] <- sum(RS_17_18_GERAL$Notificados)
RS_Serie_Historica[2, 10] <- sum(RS_17_18_GERAL$Dengue)
RS_Serie_Historica[3, 10] <- sum(RS_17_18_GERAL$D_S_A)
RS_Serie_Historica[4, 10] <- sum(RS_17_18_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 10] <- sum(RS_17_18_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 10] <- sum(RS_17_18_GERAL$Autoctones)
RS_Serie_Historica[7, 10] <- sum(RS_17_18_GERAL$DENV_I)
RS_Serie_Historica[8, 10] <- sum(RS_17_18_GERAL$DENV_II)
RS_Serie_Historica[9, 10] <- sum(RS_17_18_GERAL$DENV_III)
RS_Serie_Historica[10, 10] <- sum(RS_17_18_GERAL$DENV_IV)
RS_Serie_Historica[11, 10] <- sum(RS_17_18_GERAL$Obitos)

RS_Serie_Historica[1, 11] <- sum(RS_18_19_GERAL$Notificados)
RS_Serie_Historica[2, 11] <- sum(RS_18_19_GERAL$Dengue)
RS_Serie_Historica[3, 11] <- sum(RS_18_19_GERAL$D_S_A)
RS_Serie_Historica[4, 11] <- sum(RS_18_19_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 11] <- sum(RS_18_19_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 11] <- sum(RS_18_19_GERAL$Autoctones)
RS_Serie_Historica[7, 11] <- sum(RS_18_19_GERAL$DENV_I)
RS_Serie_Historica[8, 11] <- sum(RS_18_19_GERAL$DENV_II)
RS_Serie_Historica[9, 11] <- sum(RS_18_19_GERAL$DENV_III)
RS_Serie_Historica[10, 11] <- sum(RS_18_19_GERAL$DENV_IV)
RS_Serie_Historica[11, 11] <- sum(RS_18_19_GERAL$Obitos)

RS_Serie_Historica[1, 12] <- sum(RS_19_20_GERAL$Notificados)
RS_Serie_Historica[2, 12] <- sum(RS_19_20_GERAL$Dengue)
RS_Serie_Historica[3, 12] <- sum(RS_19_20_GERAL$D_S_A)
RS_Serie_Historica[4, 12] <- sum(RS_19_20_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 12] <- sum(RS_19_20_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 12] <- sum(RS_19_20_GERAL$Autoctones)
RS_Serie_Historica[7, 12] <- sum(RS_19_20_GERAL$DENV_I)
RS_Serie_Historica[8, 12] <- sum(RS_19_20_GERAL$DENV_II)
RS_Serie_Historica[9, 12] <- sum(RS_19_20_GERAL$DENV_III)
RS_Serie_Historica[10, 12] <- sum(RS_19_20_GERAL$DENV_IV)
RS_Serie_Historica[11, 12] <- sum(RS_19_20_GERAL$Obitos)

RS_Serie_Historica[1, 13] <- sum(RS_20_21_GERAL$Notificados)
RS_Serie_Historica[2, 13] <- sum(RS_20_21_GERAL$Dengue)
RS_Serie_Historica[3, 13] <- sum(RS_20_21_GERAL$D_S_A)
RS_Serie_Historica[4, 13] <- sum(RS_20_21_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 13] <- sum(RS_20_21_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 13] <- sum(RS_20_21_GERAL$Autoctones)
RS_Serie_Historica[7, 13] <- sum(RS_20_21_GERAL$DENV_I)
RS_Serie_Historica[8, 13] <- sum(RS_20_21_GERAL$DENV_II)
RS_Serie_Historica[9, 13] <- sum(RS_20_21_GERAL$DENV_III)
RS_Serie_Historica[10, 13] <- sum(RS_20_21_GERAL$DENV_IV)
RS_Serie_Historica[11, 13] <- sum(RS_20_21_GERAL$Obitos)

RS_Serie_Historica[1, 14] <- sum(RS_21_22_GERAL$Notificados)
RS_Serie_Historica[2, 14] <- sum(RS_21_22_GERAL$Dengue)
RS_Serie_Historica[3, 14] <- sum(RS_21_22_GERAL$D_S_A)
RS_Serie_Historica[4, 14] <- sum(RS_21_22_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 14] <- sum(RS_21_22_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 14] <- sum(RS_21_22_GERAL$Autoctones)
RS_Serie_Historica[7, 14] <- sum(RS_21_22_GERAL$DENV_I)
RS_Serie_Historica[8, 14] <- sum(RS_21_22_GERAL$DENV_II)
RS_Serie_Historica[9, 14] <- sum(RS_21_22_GERAL$DENV_III)
RS_Serie_Historica[10, 14] <- sum(RS_21_22_GERAL$DENV_IV)
RS_Serie_Historica[11, 14] <- sum(RS_21_22_GERAL$Obitos)

rm(RS_09_10_GERAL, RS_10_11_GERAL, RS_11_12_GERAL, RS_12_13_GERAL, 
   RS_13_14_GERAL, RS_14_15_GERAL, RS_15_16_GERAL, RS_16_17_GERAL,
   RS_17_18_GERAL, RS_18_19_GERAL, RS_19_20_GERAL, RS_20_21_GERAL,
   RS_21_22_GERAL)

#####Gravando tabela de série histórica#####

assign(paste0("RS", RS, "_Serie_Historica"), 
       RS_Serie_Historica) 

write.csv (RS_Serie_Historica, 
           paste0("Base_de_Dados/Tabulacoes_R/Arboviroses/RS", RS, "_Serie_Historica_Base.csv"), 
           row.names = FALSE)

rm(RS_Serie_Historica)

###Construindo tabela para Canal Endêmico Notificados####

RS_CE_Base_Notificados <- data.frame("SE" = NA)

RS_CE_Base_Notificados[1, 1] <- "2009/10"
RS_CE_Base_Notificados[1, 2:54] <- as.integer(data.frame(RS22_09_10_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[2, 1] <- "2010/11"
RS_CE_Base_Notificados[2, 2:54] <- as.integer(data.frame(RS22_10_11_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[3, 1] <- "2011/12"
RS_CE_Base_Notificados[3, 2:54] <- as.integer(data.frame(RS22_11_12_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[4, 1] <- "2012/13"
RS_CE_Base_Notificados[4, 2:54] <- as.integer(data.frame(RS22_12_13_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[5, 1] <- "2013/14"
RS_CE_Base_Notificados[5, 2:54] <- as.integer(data.frame(RS22_13_14_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[6, 1] <- "2014/15"
RS_CE_Base_Notificados[6, 2:54] <- as.integer(data.frame(RS22_14_15_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[7, 1] <- "2015/16"
RS_CE_Base_Notificados[7, 2:54] <- as.integer(data.frame(RS22_15_16_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[8, 1] <- "2016/17"
RS_CE_Base_Notificados[8, 2:54] <- as.integer(data.frame(RS22_16_17_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[9, 1] <- "2017/18"
RS_CE_Base_Notificados[9, 2:54] <- as.integer(data.frame(RS22_17_18_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[10, 1] <- "2018/19"
RS_CE_Base_Notificados[10, 2:54] <- as.integer(data.frame(RS22_18_19_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[11, 1] <- "2019/20"
RS_CE_Base_Notificados[11, 2:54] <- as.integer(data.frame(RS22_19_20_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[12, 1] <- "2020/21"
RS_CE_Base_Notificados[12, 2:54] <- as.integer(data.frame(RS22_20_21_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[13, 1] <- "2021/22"
RS_CE_Base_Notificados[13, 2:54] <- as.integer(data.frame(RS22_21_22_SE_Notificados[17, 2:54]))

colnames (RS_CE_Base_Notificados)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados)[2:24] <- c(31:53)
colnames (RS_CE_Base_Notificados)[25:54] <- c(1:30)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

write.csv (RS_CE_Base_Notificados, 
           paste0("Base_de_Dados/Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_Base.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados

RS_CE_Base_Confirmados <- data.frame("SE" = NA)

RS_CE_Base_Confirmados[1, 1] <- "2009/10"
RS_CE_Base_Confirmados[1, 2:54] <- as.integer(data.frame(RS22_09_10_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[2, 1] <- "2010/11"
RS_CE_Base_Confirmados[2, 2:54] <- as.integer(data.frame(RS22_10_11_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[3, 1] <- "2011/12"
RS_CE_Base_Confirmados[3, 2:54] <- as.integer(data.frame(RS22_11_12_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[4, 1] <- "2012/13"
RS_CE_Base_Confirmados[4, 2:54] <- as.integer(data.frame(RS22_12_13_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[5, 1] <- "2013/14"
RS_CE_Base_Confirmados[5, 2:54] <- as.integer(data.frame(RS22_13_14_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[6, 1] <- "2014/15"
RS_CE_Base_Confirmados[6, 2:54] <- as.integer(data.frame(RS22_14_15_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[7, 1] <- "2015/16"
RS_CE_Base_Confirmados[7, 2:54] <- as.integer(data.frame(RS22_15_16_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[8, 1] <- "2016/17"
RS_CE_Base_Confirmados[8, 2:54] <- as.integer(data.frame(RS22_16_17_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[9, 1] <- "2017/18"
RS_CE_Base_Confirmados[9, 2:54] <- as.integer(data.frame(RS22_17_18_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[10, 1] <- "2018/19"
RS_CE_Base_Confirmados[10, 2:54] <- as.integer(data.frame(RS22_18_19_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[11, 1] <- "2019/20"
RS_CE_Base_Confirmados[11, 2:54] <- as.integer(data.frame(RS22_19_20_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[12, 1] <- "2020/21"
RS_CE_Base_Confirmados[12, 2:54] <- as.integer(data.frame(RS22_20_21_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[13, 1] <- "2021/22"
RS_CE_Base_Confirmados[13, 2:54] <- as.integer(data.frame(RS22_21_22_SE_Confirmados[17, 2:54]))

colnames (RS_CE_Base_Confirmados)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados)[2:24] <- c(31:53)
colnames (RS_CE_Base_Confirmados)[25:54] <- c(1:30)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

write.csv (RS_CE_Base_Confirmados, 
           paste0("Base_de_Dados/Tabulacoes_R/Arboviroses/RS", RS, "_CE_Confirmados_Base.csv"), 
           row.names = FALSE)

###Construindo tabela para Canal Endêmico Notificados - IVAIPORÃ####

RS_CE_Base_Notificados_SEDE <- data.frame("SE" = NA)

RS_CE_Base_Notificados_SEDE[1, 1] <- "2009/10"
RS_CE_Base_Notificados_SEDE[1, 2:54] <- as.integer(data.frame(RS22_09_10_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[2, 1] <- "2010/11"
RS_CE_Base_Notificados_SEDE[2, 2:54] <- as.integer(data.frame(RS22_10_11_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[3, 1] <- "2011/12"
RS_CE_Base_Notificados_SEDE[3, 2:54] <- as.integer(data.frame(RS22_11_12_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[4, 1] <- "2012/13"
RS_CE_Base_Notificados_SEDE[4, 2:54] <- as.integer(data.frame(RS22_12_13_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[5, 1] <- "2013/14"
RS_CE_Base_Notificados_SEDE[5, 2:54] <- as.integer(data.frame(RS22_13_14_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[6, 1] <- "2014/15"
RS_CE_Base_Notificados_SEDE[6, 2:54] <- as.integer(data.frame(RS22_14_15_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[7, 1] <- "2015/16"
RS_CE_Base_Notificados_SEDE[7, 2:54] <- as.integer(data.frame(RS22_15_16_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[8, 1] <- "2016/17"
RS_CE_Base_Notificados_SEDE[8, 2:54] <- as.integer(data.frame(RS22_16_17_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[9, 1] <- "2017/18"
RS_CE_Base_Notificados_SEDE[9, 2:54] <- as.integer(data.frame(RS22_17_18_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[10, 1] <- "2018/19"
RS_CE_Base_Notificados_SEDE[10, 2:54] <- as.integer(data.frame(RS22_18_19_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[11, 1] <- "2019/20"
RS_CE_Base_Notificados_SEDE[11, 2:54] <- as.integer(data.frame(RS22_19_20_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[12, 1] <- "2020/21"
RS_CE_Base_Notificados_SEDE[12, 2:54] <- as.integer(data.frame(RS22_20_21_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[13, 1] <- "2021/22"
RS_CE_Base_Notificados_SEDE[13, 2:54] <- as.integer(data.frame(RS22_21_22_SE_Notificados[6, 2:54]))

colnames (RS_CE_Base_Notificados_SEDE)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados_SEDE)[2:24] <- c(31:53)
colnames (RS_CE_Base_Notificados_SEDE)[25:54] <- c(1:30)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

write.csv (RS_CE_Base_Notificados_SEDE, 
           paste0("Base_de_Dados/Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_SEDE_Base.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados - IVAIPORÃ

RS_CE_Base_Confirmados_SEDE <- data.frame("SE" = NA)

RS_CE_Base_Confirmados_SEDE[1, 1] <- "2009/10"
RS_CE_Base_Confirmados_SEDE[1, 2:54] <- as.integer(data.frame(RS22_09_10_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[2, 1] <- "2010/11"
RS_CE_Base_Confirmados_SEDE[2, 2:54] <- as.integer(data.frame(RS22_10_11_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[3, 1] <- "2011/12"
RS_CE_Base_Confirmados_SEDE[3, 2:54] <- as.integer(data.frame(RS22_11_12_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[4, 1] <- "2012/13"
RS_CE_Base_Confirmados_SEDE[4, 2:54] <- as.integer(data.frame(RS22_12_13_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[5, 1] <- "2013/14"
RS_CE_Base_Confirmados_SEDE[5, 2:54] <- as.integer(data.frame(RS22_13_14_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[6, 1] <- "2014/15"
RS_CE_Base_Confirmados_SEDE[6, 2:54] <- as.integer(data.frame(RS22_14_15_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[7, 1] <- "2015/16"
RS_CE_Base_Confirmados_SEDE[7, 2:54] <- as.integer(data.frame(RS22_15_16_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[8, 1] <- "2016/17"
RS_CE_Base_Confirmados_SEDE[8, 2:54] <- as.integer(data.frame(RS22_16_17_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[9, 1] <- "2017/18"
RS_CE_Base_Confirmados_SEDE[9, 2:54] <- as.integer(data.frame(RS22_17_18_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[10, 1] <- "2018/19"
RS_CE_Base_Confirmados_SEDE[10, 2:54] <- as.integer(data.frame(RS22_18_19_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[11, 1] <- "2019/20"
RS_CE_Base_Confirmados_SEDE[11, 2:54] <- as.integer(data.frame(RS22_19_20_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[12, 1] <- "2020/21"
RS_CE_Base_Confirmados_SEDE[12, 2:54] <- as.integer(data.frame(RS22_20_21_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[13, 1] <- "2021/22"
RS_CE_Base_Confirmados_SEDE[13, 2:54] <- as.integer(data.frame(RS22_21_22_SE_Confirmados[6, 2:54]))

colnames (RS_CE_Base_Confirmados_SEDE)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados_SEDE)[2:24] <- c(31:53)
colnames (RS_CE_Base_Confirmados_SEDE)[25:54] <- c(1:30)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

write.csv (RS_CE_Base_Confirmados_SEDE, 
           paste0("Base_de_Dados/Tabulacoes_R/Arboviroses/RS", RS,"_CE_Confirmados_SEDE_Base.csv"), 
           row.names = FALSE)

rm(AUX,
   AUX01,
   AUX02,
   BASE_IBGE,
   DENGON2022,
   i,
   ID_REG,
   nrow,
   RS)








