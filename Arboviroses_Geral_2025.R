rm(list =ls())
###############################################################################################################
###############################################################################################################
##                                                                                                           ##
##    Script elaborado em ambiente LINUX. Para replicação deve ser ajustado os caminhos dos diretórios       ##
##    ################################################################################################       ##
##                                                                                                           ##
##    Até o ponto em que é necessario autenticação de acesso à internet todos os passos abaixo são           ##
##    reprodutíveis em qualquer computador desde que os itens abaixo sejam executados corretamente.          ##
##    #############################################################################################          ## 
##                                                                                                           ##
##    /home/gustavo/Área de trabalho/Análise_de_Dados/Arboviroses_Geral deve ser previamente rodado          ##
##    para que o script abaixo funcione.                                                                     ##
##    ############################################################################################           ##
##                                                                                                           ##
###############################################################################################################
###############################################################################################################

#####      Definindo diretório de trabalho, caso tenha que trabalhar em Windows, acertar o diretório       ####

setwd("/home/gustavo/Área de trabalho/Análise_de_Dados/")

#######################################################################################################################
###Importação da Base de Dados e Criação de Objetos Primários e seleção com DPLYR %>% select de colunas de interesse. É
###necessário atenção para a mudança da ficha do SINAN em 2015.########################################################
###O arquivo Planilha_Base_IBGE.CSV possui os municípios e seus respectivos códigos do IBGE. É uma planilha que serve##
###de "engrenagem" para os loops#######################################################################################
#######################################################################################################################

BASE_IBGE<-read.table(file="Base_de_Dados/Auxiliares/Planilha_Base_IBGE.csv", 
                      header=TRUE, 
                      sep=",")
################################################################################################################

############################################################################################
####   Definindo o objeto RS para servir de apoio para    ##################################
####    buscar dados de todas as RS. Usar 1, 2, 3..., 21, 22    ############################
############################################################################################

RS <- 22   #####  Deve-se colocar AQUI a Regional

######   Criando objeto ID_REG. Será utilizado para selecionar
######   RS no DBF do SINAN ONLINE.

ID_REG <- as.data.frame(BASE_IBGE[which(BASE_IBGE$RS == RS), 6])

ID_REG <- as.numeric(ID_REG[1,1])

####   Estabelecendo o número de municípios em cada RS

nrow <- NROW(BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

##
###libraries###
##

library(dplyr)
library(foreign)

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

##
###Construindo o conjunto de tabelas necessárias por período sazonal####
##

#####################################################################################################################
########################################         2009             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2009 <- read.dbf(file = "Base_de_Dados/DBF/DENGON2009.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, 
                                                 SEM_NOT, DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, 
                                                 DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, 
                                                 SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, 
                                                 DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, 
                                                 CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, 
                                                 HOSPITALIZ, DT_INTERNA, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, 
                                                 SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2009$SEM_PRI <-as.numeric(as.character(DENGON2009$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2009_RS <- DENGON2009 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG,)

assign(paste0("RS", RS, "_2009_SINAN"), 
       SINAN_DENGUE_2009_RS) 

write.csv (assign(paste0("RS", RS, "_2009_SINAN"), SINAN_DENGUE_2009_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2009_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2009 já utilizada###

rm (DENGON2009)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200901)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200902) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200903) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==200904) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200905) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200906) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200907) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==200908) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200909) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200910) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200911) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200913) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200914) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200915) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200916) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200917) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200918) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200919) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==200920) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200922) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200923) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200925) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200926) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200927) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200929) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200930) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200931) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200932) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200933) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2009_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200934) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200935) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200936) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200937) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200938) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200939) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200940) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200941) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200942) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200943) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==200945) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200946) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200947) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200948) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200949) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200950) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200951) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2009_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200952) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2009_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==200953) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2009_SE_Notificados"), AUX)

assign("RS_2009_SE_Notificados", AUX)

write.csv (RS_2009_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2009_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200901)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200902) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200903) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==200904) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200905) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200906) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200907) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==200908) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200909) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200910) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200911) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200913) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200914) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200915) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200916) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200917) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200918) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200919) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==200920) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200922) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200923) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200925) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200926) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200927) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200929) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200930) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200931) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200932) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200933) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2009_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200934) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200935) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200936) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200937) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200938) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200939) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200940) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200941) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200942) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200943) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200945) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200946) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200947) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200948) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200949) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200950) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200951) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2009_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200952) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==200953) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2009_SE_Confirmados"), AUX)

assign("RS_2009_SE_Confirmados", AUX)

write.csv (RS_2009_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2009_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2009_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2009_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2009_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2009_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2009_GERAL"), AUX)

assign(paste0("RS", "_2009_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2009_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2009_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2009_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2009_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2009_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2009_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2009_RS)

#####################################################################################################################
########################################         2010             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2010 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2010.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, DT_SIN_PRI, SEM_PRI,  
                                                 SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, 
                                                 ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, 
                                                 DT_INVEST, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, 
                                                 COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, 
                                                 EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, CON_FHD, 
                                                 COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2010$SEM_PRI <-as.numeric(as.character(DENGON2010$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2010_RS <- DENGON2010 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2010_SINAN"), 
       SINAN_DENGUE_2010_RS) 

write.csv (assign(paste0("RS", RS, "_2010_SINAN"), SINAN_DENGUE_2010_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2010_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2010 já utilizada###

rm (DENGON2010)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201001)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201002) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201003) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201004) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201005) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201006) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201007) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201008) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201009) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201010) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201011) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201013) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201014) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201015) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201016) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201017) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201018) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201020) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201022) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201023) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201025) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201026) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201027) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201029) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201030) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201031) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201032) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201033) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2010_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201034) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201035) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201036) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201037) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201038) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201039) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201040) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201041) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201042) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201043) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201045) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201046) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201047) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201049) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201050) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201051) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2010_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201052) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2010_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201053) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2010_SE_Notificados"), AUX)

assign("RS_2010_SE_Notificados", AUX)

write.csv (RS_2010_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2010_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201001)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201002) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201003) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201004) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201005) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201006) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201007) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201008) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201009) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201010) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201011) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201013) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201014) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201015) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201016) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201017) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201018) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201020) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201022) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201023) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201025) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201026) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201027) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201029) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201030) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201031) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201032) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201033) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2010_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201034) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201035) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201036) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201037) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201038) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201039) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201040) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201041) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201042) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201043) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201045) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201046) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201047) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201049) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201050) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201051) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2010_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201052) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201053) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2010_SE_Confirmados"), AUX)

assign("RS_2010_SE_Confirmados", AUX)

write.csv (assign(paste0("RS", RS, "_2010_SE_Confirmados"), AUX), 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2010_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2010_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2010_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2010_RS %>%   
                                                   filter(CLASSI_FIN == 3 | 
                                                            CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2010_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2010_GERAL"), AUX)

assign(paste0("RS", "_2010_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2010_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2010_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2010_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2010_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2010_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2010_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2010_RS)

#####################################################################################################################
########################################         2011             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2011 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2011.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, 
                                                 RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, 
                                                 COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR,
                                                 EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, 
                                                 CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2011$SEM_PRI <-as.numeric(as.character(DENGON2011$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2011_RS <- DENGON2011 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2011_SINAN"), 
       SINAN_DENGUE_2011_RS) 

write.csv (assign(paste0("RS", RS, "_2011_SINAN"), SINAN_DENGUE_2011_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2011_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2011 já utilizada###

rm (DENGON2011)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201101)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201102) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201103) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201104) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201105) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201106) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201107) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201108) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201109) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201110) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201111) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201113) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201114) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201115) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201116) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201117) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201118) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201120) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201122) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201123) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201125) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201126) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201127) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201129) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201130) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201131) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201132) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201133) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2011_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201134) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201135) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201136) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201137) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201138) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201139) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201140) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201141) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201142) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201143) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201145) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201146) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201147) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201149) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201150) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201151) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2011_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201152) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2011_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201153) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2011_SE_Notificados"), AUX)

assign("RS_2011_SE_Notificados", AUX)

write.csv (RS_2011_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2011_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:24] <- c(31:53)

colnames (AUX)[25:54] <- c(1:30)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201101)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201102) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201103) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201104) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201105) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201106) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201107) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201108) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201109) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201110) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201111) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201113) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201114) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201115) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201116) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201117) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201118) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201120) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201122) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201123) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201125) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201126) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201127) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201129) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201130) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201131) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201132) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201133) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2011_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201134) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201135) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201136) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201137) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201138) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201139) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201140) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201141) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201142) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201143) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201145) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201146) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201147) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201149) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201150) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201151) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2011_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201152) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201153) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2011_SE_Confirmados"), AUX)

assign("RS_2011_SE_Confirmados", AUX)

write.csv (RS_2011_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2011_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2011_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2011_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2011_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2011_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2011_GERAL"), AUX)

assign(paste0("RS", "_2011_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2011_GERAL"), AUX),
           "Tabulacoes_R/Arboviroses/RS22_2011_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2011_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2011_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2011_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2011_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2011_RS)

#####################################################################################################################
########################################         2012             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2012 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2012.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT,
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, 
                                                 RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, 
                                                 COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, 
                                                 EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, 
                                                 CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2012$SEM_PRI <-as.numeric(as.character(DENGON2012$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2012_RS <- DENGON2012 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2012_SINAN"), 
       SINAN_DENGUE_2012_RS) 

write.csv (assign(paste0("RS", RS, "_2012_SINAN"), SINAN_DENGUE_2012_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2012_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2012 já utilizada###

rm (DENGON2012)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201201)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201202) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201203) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201204) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201205) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201206) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201207) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201208) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201209) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201210) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201211) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201213) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201214) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201215) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201216) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201217) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201218) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201220) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201222) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201223) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201225) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201226) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201227) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201229) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201230) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201231) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201232) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201233) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2012_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201234) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201235) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201236) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201237) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201238) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201239) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201240) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201241) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201242) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201243) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201245) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201246) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201247) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201249) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201250) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201251) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2012_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201252) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2012_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201253) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2012_SE_Notificados"), AUX)

assign("RS_2012_SE_Notificados", AUX)

write.csv (RS_2012_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2012_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201201)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201202) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201203) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201204) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201205) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201206) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201207) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201208) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201209) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201210) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201211) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201213) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201214) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201215) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201216) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201217) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201218) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201220) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201222) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201223) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201225) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201226) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201227) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201229) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201230) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201231) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201232) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201233) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2012_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201234) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201235) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201236) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201237) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201238) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201239) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201240) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201241) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201242) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201243) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201245) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201246) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201247) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201249) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201250) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201251) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2012_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201252) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201253) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2012_SE_Confirmados"), AUX)

assign("RS_2012_SE_Confirmados", AUX)

write.csv (RS_2012_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2012_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2012_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2012_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2012_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2012_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2012_GERAL"), AUX)

assign(paste0("RS", "_2012_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2012_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2012_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2012_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2012_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2012_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2012_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2012_RS)

#####################################################################################################################
########################################         2013             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2013 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2013.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, 
                                                 RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, 
                                                 COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, 
                                                 EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, 
                                                 CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2013$SEM_PRI <-as.numeric(as.character(DENGON2013$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2013_RS <- DENGON2013 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2013_SINAN"), 
       SINAN_DENGUE_2013_RS) 

write.csv (assign(paste0("RS", RS, "_2013_SINAN"), SINAN_DENGUE_2013_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2013_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2013 já utilizada###

rm (DENGON2013)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201301)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201302) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201303) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201304) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201305) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201306) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201307) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201308) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201309) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201310) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201311) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201313) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201314) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201315) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201316) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201317) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201318) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201319) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201320) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201322) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201323) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201324) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201325) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201326) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201327) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201328) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201329) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201330) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201331) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201332) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201333) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2013_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201334) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201335) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201336) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201337) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201338) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201339) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201340) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201341) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201342) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201343) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201345) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201346) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201347) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201349) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201350) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201351) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2013_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201352) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2013_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201353) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2013_SE_Notificados"), AUX)

assign("RS_2013_SE_Notificados", AUX)

write.csv (RS_2013_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2013_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201301)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201302) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201303) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201304) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201305) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201306) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201307) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201308) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201309) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201310) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201311) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201313) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201314) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201315) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201316) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201317) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201318) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201319) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201320) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201322) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201323) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201324) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201325) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201326) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201327) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201328) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201329) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201330) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201331) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201332) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201333) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2013_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201334) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201335) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201336) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201337) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201338) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201339) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201340) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201341) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201342) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201343) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201345) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201346) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201347) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201349) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201350) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201351) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2013_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201352) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201353) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2013_SE_Confirmados"), AUX)

assign("RS_2013_SE_Confirmados", AUX)

write.csv (RS_2013_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2013_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2013_RS %>% 
                                                  filter(CLASSI_FIN == 1, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2013_RS %>%  
                                                   filter(CLASSI_FIN == 2, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2013_RS %>%   
                                                   filter(CLASSI_FIN == 3 | CLASSI_FIN == 4, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2013_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2013_GERAL"), AUX)

assign(paste0("RS", "_2013_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2013_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2013_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | CS_ESCOL_N == 2 | CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2013_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2013_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2013_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2013_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2013_RS)

#####################################################################################################################
########################################         2014             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2014 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2014.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, DT_SORO, 
                                                 RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, 
                                                 COMUNINF, CO_BAINF, EVOLUCAO, DT_OBITO, DT_ENCERRA, HOSPITALIZ, DT_INTERNA, MANI_HEMOR, 
                                                 EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, LACO_N, PLASMATICO, EVIDENCIA, 
                                                 CON_FHD, COMPLICA, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2014$SEM_PRI <-as.numeric(as.character(DENGON2014$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2014_RS <- DENGON2014 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2014_SINAN"), 
       SINAN_DENGUE_2014_RS) 

write.csv (assign(paste0("RS", RS, "_2014_SINAN"), SINAN_DENGUE_2014_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2014_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2014 já utilizada###

rm (DENGON2014)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201401)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201402) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201403) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                         filter(ID_MN_RESI == i, 
                                                SEM_PRI ==201404) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201405) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201406) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201407) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201408) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201409) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201410) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201411) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201413) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201414) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201415) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201416) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201417) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201418) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201419) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201420) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201422) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201423) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201424) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201425) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201426) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201427) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201428) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201429) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201430) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201431) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201432) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201433) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2014_RS%>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201434) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201435) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201436) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201437) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201438) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201439) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201440) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201441) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201442) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201443) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201445) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201446) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201447) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201449) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201450) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201451) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2014_RS%>%  
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201452) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2014_RS%>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201453) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2014_SE_Notificados"), AUX)

assign("RS_2014_SE_Notificados", AUX)

write.csv (RS_2014_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2014_SE_Notificados.csv"), 
           row.names = FALSE)

########################################################################################################
###     Construindo um for loop para realizar a tabela de Confirmados por semana epidemiológica      ###
########################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201401)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201402) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201403) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                         filter(ID_MN_RESI == i, 
                                                CLASSI_FIN == 1 
                                                | 
                                                  CLASSI_FIN == 2 
                                                |
                                                  CLASSI_FIN == 3
                                                |
                                                  CLASSI_FIN == 4,
                                                SEM_PRI ==201404) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201405) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201406) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201407) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 1 
                                                 | 
                                                   CLASSI_FIN == 2 
                                                 |
                                                   CLASSI_FIN == 3
                                                 |
                                                   CLASSI_FIN == 4,
                                                 SEM_PRI ==201408) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201409) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201410) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201411) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201413) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201414) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201415) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201416) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201417) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201418) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201419) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 1 
                                                   | 
                                                     CLASSI_FIN == 2 
                                                   |
                                                     CLASSI_FIN == 3
                                                   |
                                                     CLASSI_FIN == 4,
                                                   SEM_PRI ==201420) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201422) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 1 
                                                  | 
                                                    CLASSI_FIN == 2 
                                                  |
                                                    CLASSI_FIN == 3
                                                  |
                                                    CLASSI_FIN == 4,
                                                  SEM_PRI ==201423) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201424) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201425) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201426) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201427) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201428) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201429) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201430) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201431) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201432) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201433) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2014_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201434) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201435) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201436) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201437) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201438) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201439) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201440) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201441) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201442) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201443) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201445) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201446) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201447) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201449) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201450) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201451) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2014_RS %>%  
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201452) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201453) %>% 
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2014_SE_Confirmados"), AUX)

assign("RS_2014_SE_Confirmados", AUX)

write.csv (RS_2014_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2014_SE_Confirmados.csv"), 
           row.names = FALSE)

###################################################################################################
####       Elaborando for loop para criar tabela de dados gerais de notificação da 22ª RS      ####
###################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[,c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2014_RS %>% 
                                                  filter(CLASSI_FIN == 1 |
                                                           CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>% 
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2014_RS %>%  
                                                   filter(CLASSI_FIN == 2 |
                                                            CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2014_RS %>%   
                                                   filter(CLASSI_FIN == 3 | 
                                                            CLASSI_FIN == 4 |
                                                            CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2014_RS %>%  
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  ###Óbito####
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2014_GERAL"), AUX)

assign(paste0("RS", "_2014_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2014_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2014_GERAL.csv", 
           row.names = FALSE)

####################################################################################################
####      Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade           #####
####################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2014_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

assign(paste0("RS", RS, "_2014_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2014_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2014_EXTRA.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2014_RS)

#####################################################################################################################
########################################         2015             ###################################################
#####################################################################################################################

###################### A partir de 2015 houve a mudança na ficha do SINAN de DENGUE/CHIKUNGUNYA. ####################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2015 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2015.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, 
                                                 DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, 
                                                 ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, 
                                                 MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, 
                                                 ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, 
                                                 RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, 
                                                 SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, 
                                                 HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, 
                                                 ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, 
                                                 GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, 
                                                 GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, 
                                                 GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2015$SEM_PRI <-as.numeric(as.character(DENGON2015$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2015_RS <- DENGON2015 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2015_SINAN"), 
       SINAN_DENGUE_2015_RS) 

write.csv (assign(paste0("RS", RS, "_2015_SINAN"), SINAN_DENGUE_2015_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2015_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2015 já utilizada###

rm (DENGON2015)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201501)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201502) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201503) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201504) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201505) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201506) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201507) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201508) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201509) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201510) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201511) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201512) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201513) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201514) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201515) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201516) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201517) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201518) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201519) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201520) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201521) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201522) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201523) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201524) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201525) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201526) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201527) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201528) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201529) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201530) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201531) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201532) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201533) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201534) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201535) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201536) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201537) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201538) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201539) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201540) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201541) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201542) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201543) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201544) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201545) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201546) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201547) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201548) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201549) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201550) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201551) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201552) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201553) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2015_SE_Notificados"), AUX)

assign("RS_2015_SE_Notificados", AUX)

write.csv (RS_2015_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2015_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201501)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201502) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201503) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201504) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201505) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201506) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201507) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201508) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201509) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201510) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201511) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201512) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201513) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201514) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201515) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201516) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201517) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201518) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201519) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201520) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201521) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201522) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201523) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201524) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201525) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201526) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201527) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201528) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201529) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201530) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201531) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201532) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201533) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201534) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201535) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201536) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201537) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201538) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201539) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201540) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201541) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201542) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201543) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201544) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201545) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201546) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201547) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201548) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201549) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201550) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201551) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201552) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201553) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2015_SE_Confirmados"), AUX)

assign("RS_2015_SE_Confirmados", AUX)

write.csv (RS_2015_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2015_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2015_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_GERAL"), AUX)

assign(paste0("RS", "_2015_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2015_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas. Possível somente a partir de 2015                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2015_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_SINAIS.csv", 
           row.names = FALSE)


#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2015_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2015_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2015_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2015_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2015_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2015_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2015_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2015_RS)

#####################################################################################################################
########################################         2016             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2016 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2016.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, 
                                                 MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, 
                                                 ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, 
                                                 RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, 
                                                 SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, 
                                                 HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, 
                                                 ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, 
                                                 GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, 
                                                 GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, 
                                                 GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2016$SEM_PRI <-as.numeric(as.character(DENGON2016$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2016_RS <- DENGON2016 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2016_SINAN"), 
       SINAN_DENGUE_2016_RS) 

write.csv (assign(paste0("RS", RS, "_2016_SINAN"), SINAN_DENGUE_2016_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2016_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2016 já utilizada###

rm (DENGON2016)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201601)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201602) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201603) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201604) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201605) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201606) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201607) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201608) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201609) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201610) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201611) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201612) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201613) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201614) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201615) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201616) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201617) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201618) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201619) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201620) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201621) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201622) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201623) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201624) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201625) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201626) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201627) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201628) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201629) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201630) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201631) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201632) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201633) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201634) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201635) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201636) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201637) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201638) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201639) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201640) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201641) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201642) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201643) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201644) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201645) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201646) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201647) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201648) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201649) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201650) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201651) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201652) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201653) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2016_SE_Notificados"), AUX)

assign("RS_2016_SE_Notificados", AUX)

write.csv (RS_2016_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2016_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201601)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201602) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201603) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201604) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201605) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201606) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201607) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201608) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201609) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201610) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201611) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201612) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201613) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201614) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201615) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201616) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201617) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201618) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201619) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201620) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201621) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201622) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201623) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201624) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201625) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201626) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201627) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201628) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201629) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201630) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201631) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201632) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201633) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201634) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201635) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201636) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201637) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201638) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201639) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201640) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201641) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201642) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201643) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201644) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201645) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201646) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201647) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201648) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201649) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201650) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201651) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201652) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201653) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2016_SE_Confirmados"), AUX)

assign("RS_2016_SE_Confirmados", AUX)

write.csv (RS_2016_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2016_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2016_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_GERAL"), AUX)

assign(paste0("RS", "_2016_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2016_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2016_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2016_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2016_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2016_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2016_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2016_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2016_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2016_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2016_RS)

#####################################################################################################################
########################################         2017             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2017 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2017.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, 
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, 
                                                 MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, 
                                                 ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, 
                                                 RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, 
                                                 SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, 
                                                 HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, 
                                                 ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, 
                                                 GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, 
                                                 GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, 
                                                 GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2017$SEM_PRI <-as.numeric(as.character(DENGON2017$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2017_RS <- DENGON2017 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG, 
         SEM_PRI >= 201731)

assign(paste0("RS", RS, "_2017_SINAN"), 
       SINAN_DENGUE_2017_RS) 

write.csv (assign(paste0("RS", RS, "_2017_SINAN"), SINAN_DENGUE_2017_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2017_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2017 já utilizada###

rm (DENGON2017)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201701)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201702) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201703) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201704) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201705) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201706) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201707) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201708) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201709) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201710) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201711) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201712) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201713) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201714) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201715) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201716) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201717) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201718) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201719) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201720) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201721) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201722) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201723) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201724) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201725) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201726) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201727) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201728) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201729) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201730) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201731) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201732) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201733) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201734) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201735) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201736) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201737) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201738) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201739) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201740) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201741) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201742) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201743) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201744) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201745) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201746) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201747) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201748) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201749) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201750) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201751) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201752) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201753) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2017_SE_Notificados"), AUX)

assign("RS_2017_SE_Notificados", AUX)

write.csv (RS_2017_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2017_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201701)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201702) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201703) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201704) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201705) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201706) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201707) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201708) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201709) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201710) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201711) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201712) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201713) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201714) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201715) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201716) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201717) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201718) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201719) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201720) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201721) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201722) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201723) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201724) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201725) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201726) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201727) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201728) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201729) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201730) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201731) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201732) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201733) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201734) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201735) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201736) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201737) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201738) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201739) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201740) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201741) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201742) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201743) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201744) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201745) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201746) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201747) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201748) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201749) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201750) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201751) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201752) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201753) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2017_SE_Confirmados"), AUX)

assign("RS_2017_SE_Confirmados", AUX)

write.csv (RS_2017_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2017_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2017_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_GERAL"), AUX)

assign(paste0("RS", "_2017_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2017_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2017_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2017_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2017_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2017_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2017_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2017_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2017_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2017_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2017_RS)

#####################################################################################################################
########################################         2018             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2018 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2018.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI,
                                                 NM_LOGRADO, NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, 
                                                 MIALGIA, CEFALEIA, EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, 
                                                 ARTRALGIA, PETEQUIA_N, LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, 
                                                 RENAL, HIPERTENSA, ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, 
                                                 SOROTIPO, CLASSI_FIN, CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, 
                                                 HOSPITALIZ, DT_INTERNA, DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, 
                                                 ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, 
                                                 GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, 
                                                 GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, 
                                                 GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2018$SEM_PRI <-as.numeric(as.character(DENGON2018$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2018_RS <- DENGON2018 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2018_SINAN"), 
       SINAN_DENGUE_2018_RS) 

write.csv (assign(paste0("RS", RS, "_2018_SINAN"), SINAN_DENGUE_2018_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2018_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2018 já utilizada###

rm (DENGON2018)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201801)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201802) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201803) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201804) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201805) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201806) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201807) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201808) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201809) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201810) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201811) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201812) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201813) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201814) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201815) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201816) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201817) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201818) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201819) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201820) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201821) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201822) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201823) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201824) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201825) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201826) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201827) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201828) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201829) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201830) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201831) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201832) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201833) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201834) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201835) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201836) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201837) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201838) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201839) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201840) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201841) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201842) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201843) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201844) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201845) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201846) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201847) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201848) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201849) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201850) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201851) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201852) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201853) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2018_SE_Notificados"), AUX)

assign("RS_2018_SE_Notificados", AUX)

write.csv (RS_2018_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2018_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201801)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201802) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201803) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201804) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201805) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201806) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201807) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201808) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201809) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201810) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201811) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201812) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201813) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201814) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201815) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201816) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201817) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201818) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201819) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201820) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201821) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201822) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201823) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201824) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201825) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201826) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201827) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201828) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201829) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201830) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201831) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201832) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201833) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201834) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201835) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201836) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201837) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201838) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201839) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201840) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201841) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201842) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201843) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201844) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201845) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201846) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201847) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201848) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201849) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201850) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201851) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201852) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201853) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2018_SE_Confirmados"), AUX)

assign("RS_2018_SE_Confirmados", AUX)

write.csv (RS_2018_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2018_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2018_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_GERAL"), AUX)

assign(paste0("RS", "_2018_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2018_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2018_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2018_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2018_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2018_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2018_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2018_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2018_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2018_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2018_RS)

#####################################################################################################################
########################################         2019             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2019 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2019.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, CS_SEXO, 
                                                 CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, 
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, 
                                                 ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, 
                                                 CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, 
                                                 DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, 
                                                 ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, 
                                                 GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, 
                                                 GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, 
                                                 METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2019$SEM_PRI <-as.numeric(as.character(DENGON2019$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2019_RS <- DENGON2019 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2019_SINAN"), 
       SINAN_DENGUE_2019_RS) 

write.csv (assign(paste0("RS", RS, "_2019_SINAN"), SINAN_DENGUE_2019_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2019_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2019 já utilizada###

rm (DENGON2019)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201901)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201902) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201903) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==201904) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==201905) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201906) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201907) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==201908) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201909) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201910) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201911) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201913) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201914) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201915) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201916) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201917) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201918) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201919) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==201920) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201922) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201923) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201925) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201926) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201927) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201929) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201930) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201031) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201932) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201933) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201934) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201935) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201936) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201937) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201938) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201939) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201940) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201941) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201942) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201943) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201945) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201946) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201947) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201948) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201949) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201950) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201951) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==201952) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==201953) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2019_SE_Notificados"), AUX)

assign("RS_2019_SE_Notificados", AUX)

write.csv (RS_2019_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2019_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201901)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201902) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201903) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==201904) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201905) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201906) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201907) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==201908) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201909) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201910) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201911) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201912) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201913) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201914) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201915) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201916) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201917) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201918) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201919) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==201920) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201921) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201922) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201923) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201924) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201925) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201926) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201927) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201928) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201929) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201930) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201931) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201932) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201933) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201934) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201935) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201936) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201937) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201938) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201939) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201940) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201941) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201942) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201943) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201944) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201945) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201946) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201947) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201948) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201949) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201950) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201951) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201952) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==201953) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2019_SE_Confirmados"), AUX)

assign("RS_2019_SE_Confirmados", AUX)

write.csv (RS_2019_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2019_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2019_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_GERAL"), AUX)

assign(paste0("RS", "_2019_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2019_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2019_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2019_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2019_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2019_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2019_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2019_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2019_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2019_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2019_RS)

#####################################################################################################################
########################################         2020             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2020 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2020.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO,
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, 
                                                 ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, 
                                                 CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, 
                                                 DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, 
                                                 ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, 
                                                 GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, 
                                                 GRAV_SANG, GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, 
                                                 METRO, PETEQUIAS, HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2020$SEM_PRI <-as.numeric(as.character(DENGON2020$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2020_RS <- DENGON2020 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2020_SINAN"), 
       SINAN_DENGUE_2020_RS) 

write.csv (assign(paste0("RS", RS, "_2020_SINAN"), SINAN_DENGUE_2020_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2020_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2020 já utilizada###

rm (DENGON2020)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202001)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202002) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202003) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202004) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202005) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202006) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202007) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202008) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202009) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202010) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202011) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202013) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202014) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202015) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202016) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202017) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202018) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202020) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202022) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202023) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202025) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202026) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202027) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202029) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202030) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202031) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202032) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202033) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202034) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202035) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202036) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202037) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202038) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202039) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202042) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202043) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202045) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202046) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202047) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202049) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202050) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202053) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2020_SE_Notificados"), AUX)

assign("RS_2020_SE_Notificados", AUX)

write.csv (RS_2020_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2020_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202001)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202002) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202003) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202004) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202005) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202006) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202007) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202008) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202009) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202010) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202011) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202012) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202013) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202014) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202015) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202016) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202017) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202018) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202019) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202020) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202021) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202022) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202023) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202024) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202025) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202026) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202027) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202028) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202029) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202030) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202031) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202032) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202033) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202034) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202035) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202036) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202037) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202038) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202039) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202040) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202041) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202042) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202043) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202044) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202045) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202046) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202047) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202048) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202049) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202050) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202051) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202052) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202053) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2020_SE_Confirmados"), AUX)

assign("RS_2020_SE_Confirmados", AUX)

write.csv (RS_2020_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2020_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2020_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_GERAL"), AUX)

assign(paste0("RS", "_2020_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2020_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2020_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2020_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2020_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2020_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2020_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2020_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2020_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2020_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2020_RS)

#####################################################################################################################
########################################         2021             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2022.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2021 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2021.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO,
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, 
                                                 ACIDO_PEPT, AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, 
                                                 CRITERIO, TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, 
                                                 DT_OBITO, DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, 
                                                 ALRM_VOM, ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, 
                                                 GRAV_INSUF, GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG,
                                                 GRAV_AST, GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, 
                                                 HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2021$SEM_PRI <-as.numeric(as.character(DENGON2021$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2021_RS <- DENGON2021 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2021_SINAN"), 
       SINAN_DENGUE_2021_RS) 

write.csv (assign(paste0("RS", RS, "_2021_SINAN"), SINAN_DENGUE_2021_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2021_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2021 já utilizada###

rm (DENGON2021)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202101)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202102) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202103) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202104) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202105) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202106) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202107) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202108) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202109) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202110) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202111) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202113) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202114) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202115) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202116) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202117) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202118) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202120) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202122) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202123) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202125) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202126) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202127) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202129) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202130) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202131) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202132) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202133) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202134) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202135) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202136) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202137) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202138) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202139) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202142) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202143) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202145) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202146) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202147) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202149) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202150) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202153) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2021_SE_Notificados"), AUX)

assign("RS_2021_SE_Notificados", AUX)

write.csv (RS_2021_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2021_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202101)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202102) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202103) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202104) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202105) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202106) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202107) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202108) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202109) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202110) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202111) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202112) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202113) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202114) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202115) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202116) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202117) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202118) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202119) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202120) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202121) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202122) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202123) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202124) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202125) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202126) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202127) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202128) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202129) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202130) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202131) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202132) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202133) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202134) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202135) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202136) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202137) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202138) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202139) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202140) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202141) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202142) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202143) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202144) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202145) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202146) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202147) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202148) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202149) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202150) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202151) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202152) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202153) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2021_SE_Confirmados"), AUX)

assign("RS_2021_SE_Confirmados", AUX)

write.csv (RS_2021_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2021_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2021_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_GERAL"), AUX)

assign(paste0("RS", "_2021_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2021_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2021_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2021_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2021_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2021_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2021_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2021_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2021_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2021_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2021_RS)

#####################################################################################################################
########################################         2022             ###################################################
#####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2023.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2022 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2022.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, 
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, 
                                                 AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, 
                                                 TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, 
                                                 DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, 
                                                 ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, 
                                                 GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, 
                                                 GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, 
                                                 HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2022$SEM_PRI <-as.numeric(as.character(DENGON2022$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2022_RS <- DENGON2022 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2022_SINAN"), 
       SINAN_DENGUE_2022_RS) 

write.csv (assign(paste0("RS", RS, "_2022_SINAN"), SINAN_DENGUE_2022_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2022_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2022 já utilizada###

rm (DENGON2022)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202201)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202202) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202203) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202204) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202205) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202206) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202207) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202208) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202209) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202210) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202211) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202213) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202214) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202215) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202216) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202217) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202218) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202220) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202222) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202223) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202225) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202226) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202227) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202229) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202230) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202231) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202232) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202233) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202234) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202235) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202236) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202237) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202238) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202239) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202240) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202241) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202242) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202243) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202245) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202246) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202247) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202249) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202250) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202251) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202252) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202253) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2022_SE_Notificados"), AUX)

assign("RS_2022_SE_Notificados", AUX)

write.csv (RS_2022_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2022_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202201)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202202) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202203) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202204) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202205) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202206) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202207) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202208) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202209) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202210) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202211) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202212) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202213) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202214) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202215) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202216) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202217) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202218) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202219) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202220) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202221) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202222) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202223) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202224) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202225) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202226) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202227) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202228) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202229) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202230) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202231) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202232) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202233) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202234) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202235) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202236) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202237) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202238) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202239) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202240) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202241) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202242) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202243) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202244) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202245) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202246) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202247) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202248) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202249) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202250) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202251) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202252) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202253) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2022_SE_Confirmados"), AUX)

assign("RS_2022_SE_Confirmados", AUX)

write.csv (RS_2022_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2022_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2022_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_GERAL"), AUX)

assign(paste0("RS", "_2022_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2022_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2022_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2022_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2022_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2022_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2022_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2022_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2022_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2022_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2022_RS)

#####################################################################################################################
########################################         2023             ###################################################
####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2024.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2023 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2023.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, 
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, 
                                                 AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, 
                                                 TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, 
                                                 DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, 
                                                 ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, 
                                                 GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, 
                                                 GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, 
                                                 HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2023$SEM_PRI <-as.numeric(as.character(DENGON2023$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2023_RS <- DENGON2023 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2023_SINAN"), 
       SINAN_DENGUE_2023_RS) 

write.csv (assign(paste0("RS", RS, "_2023_SINAN"), SINAN_DENGUE_2023_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2023_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2023 já utilizada###

rm (DENGON2023)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202301)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202302) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202303) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202304) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202305) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202306) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202307) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202308) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202309) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202310) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202311) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202313) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202314) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202315) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202316) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202317) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202318) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202319) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202320) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202322) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202323) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202324) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202325) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202326) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202327) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202328) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202329) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202330) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202331) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202332) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202333) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202334) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202335) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202336) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202337) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202338) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202339) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202340) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202341) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202342) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202343) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202345) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202346) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202347) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202349) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202350) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202351) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202352) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202353) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2023_SE_Notificados"), AUX)

assign("RS_2023_SE_Notificados", AUX)

write.csv (RS_2023_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2023_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202301)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202302) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202303) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202304) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202305) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202306) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202307) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202308) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202309) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202310) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202311) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202312) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202313) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202314) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202315) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202316) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202317) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202318) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202319) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202320) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202321) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202322) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202323) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202324) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202325) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202326) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202327) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202328) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202329) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202330) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202331) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202332) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202333) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202334) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202335) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202336) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202337) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202338) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202339) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202340) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202341) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202342) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202343) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202344) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202345) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202346) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202347) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202348) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202349) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202350) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202351) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202352) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202353) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2023_SE_Confirmados"), AUX)

assign("RS_2023_SE_Confirmados", AUX)

write.csv (RS_2023_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2023_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2023_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_GERAL"), AUX)

assign(paste0("RS", "_2023_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2023_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2023_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2023_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2023_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2023_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2023_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2023_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2023_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2023_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2023_RS)

#####################################################################################################################
########################################         2024             ###################################################
####################################################################################################################

#######################################################################################################################
#######Os arquivos .DBF devem ser requisitados no SINAN online com os dados de notificações e dados do paciente########
#######por ano, a partir de 2009 até o ano atual. Após baixar os arquivos, os mesmos devem ser renomeados para ########
#######DENGON2009.dbf, DENGON2010.dbf,..., DENGON2024.dbf e alocados em diretório correto: ############################
############## /home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/Arboviroses/DBF/##########################
#######################################################################################################################

#######################################################################################################################
######Por não ser necessário todas as variáveis contidas na BASE DBF baixada do SINAN online, #########################
######é feito um select de variáveis após o read.dbf para atribuir ao respectivo objeto somente########################
###### as variáveis de interesse ao script. Isso poupa memória RAM#####################################################
#######################################################################################################################

DENGON2024 <- read.dbf(file = "/home/gustavo/Área de trabalho/Análise_de_Dados/Base_de_Dados/DBF/DENGON2024.dbf", 
                       as.is = FALSE) %>% select(ID_REGIONA, NU_NOTIFIC, ID_AGRAVO, ID_REGIONA, DT_NOTIFIC, NU_ANO, SEM_NOT, 
                                                 DT_SIN_PRI, SEM_PRI,  SG_UF_NOT, ID_MUNICIP, NM_PACIENT, DT_NASC, NU_IDADE_N, 
                                                 CS_SEXO, CS_GESTANT, CS_ESCOL_N, NM_MAE_PAC, ID_MN_RESI, SG_UF, ID_RG_RESI, NM_LOGRADO, 
                                                 NU_NUMERO, NM_BAIRRO, NU_CEP, CS_ZONA, DT_DIGITA, DT_INVEST, FEBRE, MIALGIA, CEFALEIA, 
                                                 EXANTEMA, VOMITO, NAUSEA, DOR_COSTAS, CONJUNTVIT, ARTRITE, ARTRALGIA, PETEQUIA_N, 
                                                 LEUCOPENIA, LACO, DOR_RETRO, DIABETES, HEMATOLOG, HEPATOPAT, RENAL, HIPERTENSA, ACIDO_PEPT, 
                                                 AUTO_IMUNE, DT_SORO, RESUL_SORO, DT_PCR, RESUL_PCR_, SOROTIPO, CLASSI_FIN, CRITERIO, 
                                                 TPAUTOCTO, COUFINF, COMUNINF, CO_BAINF, EVOLUCAO, HOSPITALIZ, DT_INTERNA, DT_OBITO, 
                                                 DT_ENCERRA, DT_ALRM, ALRM_LETAR, ALRM_HEPAT, ALRM_LIQ, ALRM_HIPOT, ALRM_PLAQ, ALRM_VOM, 
                                                 ALRM_SANG, ALRM_HEMAT, ALRM_ABDOM, DT_GRAV, GRAV_PULSO, GRAV_CONV, GRAV_ENCH, GRAV_INSUF, 
                                                 GRAV_TAQUI, GRAV_EXTRE, GRAV_HIPOT, GRAV_HEMAT, GRAV_MELEN, GRAV_METRO, GRAV_SANG, GRAV_AST, 
                                                 GRAV_MIOC, GRAV_CONSC, GRAV_ORGAO, MANI_HEMOR, EPISTAXE, GENGIVO, METRO, PETEQUIAS, 
                                                 HEMATURA, SANGRAM, DS_OBS)

##########################################################################################################################
#########Transformando coluna de semana epidemiológica de fator para numérica (passando por texto,########################
######### se for direto, ela transforma 200905 em 06. Seria possível realizar busca de SE passando########################
#########direto de fator para numérica utilizando as.integer(DENGON2009 %>% filter(ID_MUNICIP ==  ########################
#########410165, SEM_PRI == 6) -1, para buscar SE 05???? #################################################################
##########################################################################################################################

####################Será usado para usar o filter de casos por semanas epidemiológicas####################################

DENGON2024$SEM_PRI <-as.numeric(as.character(DENGON2024$SEM_PRI))

####Tabela de notificações SINAN###

#####################################################################################################################
########## Está sendo utilizado dois objetos auxiliares para filtrar os casos notificados ###########################
########## e assim transformar uma base DBF de notificados POR ANO, para um objeto único  ###########################
########## com as notificações por período sazonal. Utiliza-se o filter para, no AUX01    ###########################
########## filtrar as observações onde, na variável SEM_PRI (semana epidemiológica de 1º  ###########################
########## sintomas), as observações tenham a condição lógica >= 200930 para o segundo    ###########################
########## semestre do ano de 2009 e <= 201029 no 1º semestre de 2010. Foi selecionado    ###########################
########## também observações em Regional de residência ou regional de notificação.       ###########################
#####################################################################################################################

SINAN_DENGUE_2024_RS <- DENGON2024 %>% 
  filter(ID_REGIONA == ID_REG | ID_RG_RESI == ID_REG)

assign(paste0("RS", RS, "_2024_SINAN"), 
       SINAN_DENGUE_2024_RS) 

write.csv (assign(paste0("RS", RS, "_2024_SINAN"), SINAN_DENGUE_2024_RS), 
           "Tabulacoes_R/Arboviroses/RS22_2024_SINAN.csv", 
           row.names = FALSE)

###Removendo tabela DENGON2024 já utilizada###

rm (DENGON2024)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de notificados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202401)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202402) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202403) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                SEM_PRI ==202404) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 SEM_PRI ==202405) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202406) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202407) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 SEM_PRI ==202408) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202409) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202410) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202411) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202413) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202414) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202415) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202416) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202417) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202418) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202419) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                            filter(ID_MN_RESI == i, 
                                                   SEM_PRI ==202420) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202422) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202423) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202424) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202425) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202426) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202427) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202428) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202429) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202430) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202431) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202432) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202433) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202434) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202435) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202436) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202437) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202438) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202439) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202440) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202441) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202442) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202443) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202445) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202446) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202447) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202449) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202450) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202451) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  SEM_PRI ==202452) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  SEM_PRI ==202453) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2024_SE_Notificados"), AUX)

assign("RS_2024_SE_Notificados", AUX)

write.csv (RS_2024_SE_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2024_SE_Notificados.csv"), 
           row.names = FALSE)

#################################################################################################################
###     Construindo um for loop para realizar a tabela de confirmados por semana epidemiológica               ###
#################################################################################################################

AUX <- matrix(data = NA, 
              nrow = nrow, 
              ncol = 54)

AUX <- as.data.frame(AUX)

colnames(AUX)[1] <- "Município" 

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

colnames (AUX)[2:54] <- c(1:53)

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX == i), 2] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202401)%>%
                                          count()
  )
  
  AUX[which(AUX == i), 3] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202402) %>% 
                                          count()
  )
  
  AUX[which(AUX == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202403) %>% 
                                          count()
  )
  
  AUX[which(AUX == i),5] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                         filter(ID_MN_RESI == i,
                                                CLASSI_FIN == 10 
                                                | 
                                                  CLASSI_FIN == 11 
                                                |
                                                  CLASSI_FIN == 12,
                                                SEM_PRI ==202404) %>% 
                                         count()
  )
  
  AUX[which(AUX == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                          filter(ID_MN_RESI == i,
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202405) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202406) %>%
                                          count()
  )
  
  AUX[which(AUX == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202407) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                          filter(ID_MN_RESI == i, 
                                                 CLASSI_FIN == 10 
                                                 | 
                                                   CLASSI_FIN == 11 
                                                 |
                                                   CLASSI_FIN == 12,
                                                 SEM_PRI ==202408) %>% 
                                          count() 
  )
  
  AUX[which(AUX == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202409) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 11] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202410) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202411) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 13] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202412) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 14] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202413) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202414) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202415) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 17] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202416) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 18] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202417) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 19] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202418) %>%                                                                                        count() 
  )
  
  AUX[which(AUX == i), 20] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202419) %>%
                                           count() 
  )
  
  AUX[which(AUX == i),  21] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                            filter(ID_MN_RESI == i,
                                                   CLASSI_FIN == 10 
                                                   | 
                                                     CLASSI_FIN == 11 
                                                   |
                                                     CLASSI_FIN == 12,
                                                   SEM_PRI ==202420) %>%
                                            count() 
  )
  
  AUX[which(AUX == i), 22] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202421) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 23] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202422) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 24] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202423) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 25] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202424) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 26] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202425) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 27] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202426) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 28] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202427) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 29] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202428) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 30] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202429) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 31] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202430) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 32] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202431) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 33] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202432) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 34] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202433) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 35] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202434) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 36] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202435) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 37] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202436) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 38] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202437) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 39] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202438) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 40] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202439) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 41] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202440) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 42] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202441) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 43] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202442) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 44] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202443) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 45] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202444) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 46] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202445) %>%
                                           count()
  )
  
  AUX[which(AUX == i), 47] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202446) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 48] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202447) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 49] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202448) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 50] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i, 
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202449) %>% 
                                           count()
  )
  
  AUX[which(AUX == i), 51] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202450) %>% 
                                           count() 
  )
  
  AUX[which(AUX == i), 52] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202451) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 53] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202452) %>%
                                           count() 
  )
  
  AUX[which(AUX == i), 54] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                           filter(ID_MN_RESI == i,
                                                  CLASSI_FIN == 10 
                                                  | 
                                                    CLASSI_FIN == 11 
                                                  |
                                                    CLASSI_FIN == 12,
                                                  SEM_PRI ==202453) %>%
                                           count() 
  )
}

AUX[, 1] <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX[(nrow(AUX)+ 1), 2:54] <- apply(AUX[, 2:54], 2, sum)

AUX[nrow(AUX), 1] <- "Total"

assign(paste0("RS", RS, "_2024_SE_Confirmados"), AUX)

assign("RS_2024_SE_Confirmados", AUX)

write.csv (RS_2024_SE_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_2024_SE_Confirmados.csv"), 
           row.names = FALSE)

#################################################################################################################
###         laborando for loop para criar tabela de dados gerais de notificação da 22ª RS                     ###
#################################################################################################################

AUX <- data.frame(Município = BASE_IBGE[which(BASE_IBGE$RS == RS), 3])

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Populacao <- BASE_IBGE[which(BASE_IBGE$RS == RS), 5]

AUX$RS <- BASE_IBGE[which(BASE_IBGE$RS == RS), 1]

AUX <- AUX[, c(4, 1, 2, 3)]

AUX$Notificados <- NA

AUX$Dengue <- NA

AUX$D_S_A <- NA

AUX$Dengue_Grave <- NA

AUX$Descartados <- NA

AUX$Autoctones <- NA

AUX$Incidencia <- NA

AUX$Criterio_Encerramento_Lab <- NA

AUX$Criterio_Encerramento_Clin_Epid <- NA

AUX$DENV_I <- NA

AUX$DENV_II <- NA

AUX$DENV_III <- NA

AUX$DENV_IV <- NA

AUX$Hospitalizacao <- NA

AUX$Obitos <- NA

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  ###Notiicações###  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i) %>%   
                                                   count()
  )    
  
  ###Dengue###
  
  AUX[which(AUX$COD_IBGE == i), 6] <-as.integer(SINAN_DENGUE_2024_RS %>% 
                                                  filter(CLASSI_FIN == 10, 
                                                         ID_MN_RESI == i) %>%
                                                  count() 
  )
  ###D.S.A.###
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%  
                                                   filter(CLASSI_FIN == 11, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Dengue Grave###
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%  
                                                   filter(CLASSI_FIN == 12, 
                                                          ID_MN_RESI == i) %>% 
                                                   count()
  )
  
  ###Descartados###
  
  
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                  filter(CLASSI_FIN == 5,
                                                         ID_MN_RESI == i) %>% 
                                                  count()
  )  
  
  ###Autóctones###
  
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          TPAUTOCTO == 1) %>% 
                                                   count() 
  )
  
  ###Encerrados Laboratório###
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CRITERIO == 1) %>% 
                                                    count() 
  )
  
  ###Encerrados Clínico-Epidemiológico###
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CRITERIO == 2) %>% 
                                                    count() 
  )
  
  ###DENV I###
  
  AUX[which(AUX$COD_IBGE == i), 14]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 1) %>% 
                                                   count() 
  )
  
  ###DENV II###
  
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 2) %>% 
                                                    count() 
  )
  
  ###DENV III###
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           SOROTIPO == 3) %>% 
                                                    count() 
  )
  ###DENV IV###                                     
  
  AUX[which(AUX$COD_IBGE == i), 17]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          SOROTIPO == 4) %>% 
                                                   count() 
  )
  ###Hospitalização###
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           HOSPITALIZ == 1) %>% 
                                                    count() 
  )
  
  ###ÓBITOS###
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           EVOLUCAO == 2) %>% 
                                                    count() 
  )
}

###Incidência###FORA DO LOOP###

AUX$Incidencia <- (AUX$Autoctones/AUX$Populacao)*100000  

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_GERAL"), AUX)

assign(paste0("RS", "_2024_GERAL"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_GERAL"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_GERAL.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando Quadro com dados de sexo, idade, zona de moradia e escolaridade                        ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Menos_1_ano <- NA

AUX$Um_a_Cinco_Anos <- NA

AUX$Cinco_a_Doze_Anos <- NA

AUX$Doze_a_Dezoito_Anos <- NA

AUX$Maior_Dezoito <- NA

AUX$Area_Urbana <- NA

AUX$Area_Rural <- NA

AUX$Sexo_Feminino <- NA

AUX$Sexo_Masculino <- NA

AUX$Analfabeto <- NA

AUX$Fundamental_Incompleto <- NA

AUX$Fundamental <- NA

AUX$Ens_Medio_Incompleto <- NA

AUX$Ens_Medio<- NA

AUX$Ens_Superior_Incompleto<- NA

AUX$Ens_Superior<- NA

AUX$Escolaridade_Ignorada<- NA

###For Loop para geração da tabela RS22_Extra###

for(i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N <=3012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i,  
                                                          NU_IDADE_N > 4000 & 
                                                            NU_IDADE_N <=4005) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          NU_IDADE_N > 4005 & 
                                                            NU_IDADE_N <=4012) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4012 & 
                                                            NU_IDADE_N <=4018) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          NU_IDADE_N > 4018) %>%
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i,
                                                          CS_ZONA == 1) %>% 
                                                   count() 
  )
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i,
                                                           CS_ZONA == 2) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 11]  <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                     filter(ID_MN_RESI == i, 
                                                            CS_SEXO == "F") %>% 
                                                     count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_SEXO == "M") %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 13]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 0) %>% 
                                                   count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 1 | 
                                                             CS_ESCOL_N == 2 | 
                                                             CS_ESCOL_N == 3) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 4) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 5) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 6) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 18] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 7) %>% 
                                                    count() 
  )
  
  AUX[which(AUX$COD_IBGE == i), 19] <- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                    filter(ID_MN_RESI == i, 
                                                           CS_ESCOL_N == 8) %>% 
                                                    count() 
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 20]<- as.integer(SINAN_DENGUE_2024_RS %>% 
                                                   filter(ID_MN_RESI == i, 
                                                          CS_ESCOL_N == 9) %>% 
                                                   count() 
  )
}                                             

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_EXTRA"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_EXTRA"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_EXTRA.csv", 
           row.names = FALSE)

#################################################################################################################
###         Elaborando tabelas de sinais e sintomas.                                                          ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Febre <- NA

AUX$Cefaleia <- NA

AUX$Mialgia <- NA

AUX$Exantema <- NA

AUX$Vomitos <- NA

AUX$Nausea <- NA

AUX$Dor_nas_Costas <- NA

AUX$Conjuntivite <- NA

AUX$Artrite  <- NA

AUX$Artralgia <- NA

AUX$Petequias <- NA

AUX$Leucopenia <- NA

AUX$Dor_Retroorbital <- NA

AUX$Prova_do_Laco_Positiva <- NA

###Elaborando for loop para sinais e sintomas.###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          FEBRE == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          CEFALEIA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          MIALGIA == 1) %>%
                                                   count()
  )
  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          EXANTEMA == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          VOMITO == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9]<- as.integer(SINAN_DENGUE_2024_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         NAUSEA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10]<- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          DOR_COSTAS == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           CONJUNTVIT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRITE == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ARTRALGIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           PETEQUIA_N == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LEUCOPENIA == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           DOR_RETRO == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           LACO == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_SINAIS"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_SINAIS"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_SINAIS.csv", 
           row.names = FALSE)

#################################################################################################################
###         Montando tabela de doenças pré-existentes                                                         ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Município <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Diabetes <- NA

AUX$Doencas_Hematologicas <- NA

AUX$Hepatopatias <- NA

AUX$DRC <- NA

AUX$Hipertensao <- NA

AUX$Doenca_Acido_Peptica <- NA

AUX$Doenca_Auto_Imune <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i, 
                                                          DIABETES == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEMATOLOG == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          HEPATOPAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7]<- as.integer(SINAN_DENGUE_2024_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         RENAL == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8]<- as.integer(SINAN_DENGUE_2024_RS %>%
                                                  filter(ID_MN_RESI == i,
                                                         HIPERTENSA == 1) %>%
                                                  count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ACIDO_PEPT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           AUTO_IMUNE == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_DOENCAS_PRE_EXISTENTES"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_DOENCAS_PRE_EXISTENTES"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_DOENCAS_PRE_EXISTENTES.csv", 
           row.names = FALSE)

#################################################################################################################
###         Construindo tabela sinais de alarme                                                               ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Hipotensao_Lipotimia <- NA

AUX$Queda_Abrupta_Plaquetas <- NA

AUX$Vomitos_Persistentes <- NA

AUX$Dor_Abdominal <- NA

AUX$Letargia <- NA

AUX$Aumento_Hematocrito <- NA

AUX$hemorragias <- NA

AUX$Hepatomegalia <- NA

AUX$Acumulo_Liquidos <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HIPOT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_PLAQ == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_VOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_ABDOM == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_LETAR == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          ALRM_HEMAT == 1) %>%
                                                   count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_HEPAT == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 12] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           ALRM_LIQ == 1) %>%
                                                    count()
                                                  
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_SINAIS_DE_ALARME"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_SINAIS_DE_ALARME"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_SINAIS_DE_ALARME.csv", 
           row.names = FALSE)

#################################################################################################################
###       Construindo tabela Dengue Grave                                                                     ###
#################################################################################################################

AUX <- data.frame(RS = BASE_IBGE[which(BASE_IBGE$RS == RS), 1])

AUX$Municipio <- BASE_IBGE[which(BASE_IBGE$RS == RS), 3]

AUX$COD_IBGE <- BASE_IBGE[which(BASE_IBGE$RS == RS), 2]

AUX$Pulso_Debil <- NA

AUX$PA_Convergente <- NA

AUX$TPC <- NA

AUX$Acumulo_Liquidos_Insuf_Respiratoria <- NA

AUX$Taquicardia <- NA

AUX$Extremidades_Frias <- NA

AUX$Hipotensão_Arterial <- NA

AUX$Hematemese <- NA

AUX$Melena <- NA

AUX$Metrorragia <- NA

AUX$Sangramento_SNC <- NA

AUX$Aumento_ALT_AST <- NA

AUX$Miocardite <- NA

AUX$Alteracao_Consciencia <- NA

###Construindo o for loop###

for (i in BASE_IBGE[(which(BASE_IBGE$RS == RS)), 2]){
  
  AUX[which(AUX$COD_IBGE == i), 4] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_PULSO == 1) %>%
                                                   count()
  )     
  
  AUX[which(AUX$COD_IBGE == i), 5] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_CONV == 1) %>%
                                                   count()
  )   
  
  AUX[which(AUX$COD_IBGE == i), 6] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_ENCH == 1) %>%
                                                   count()
  )  
  
  AUX[which(AUX$COD_IBGE == i), 7] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_INSUF == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 8] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_TAQUI == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 9] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_EXTRE == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 10] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HIPOT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 11] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_HEMAT == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 12]<- as.integer(SINAN_DENGUE_2024_RS %>%
                                                   filter(ID_MN_RESI == i,
                                                          GRAV_MELEN == 1) %>%
                                                   count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 13] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_METRO == 1) %>%
                                                    count()
  ) 
  
  AUX[which(AUX$COD_IBGE == i), 14] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_SANG == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 15] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_AST == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 16] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_MIOC == 1) %>%
                                                    count()
  )
  
  AUX[which(AUX$COD_IBGE == i), 17] <- as.integer(SINAN_DENGUE_2024_RS %>%
                                                    filter(ID_MN_RESI == i,
                                                           GRAV_CONSC == 1) %>%
                                                    count()
  )
}

#### Salvando tabela   ####

assign(paste0("RS", RS, "_2024_DENGUE_GRAVE"), AUX)

write.csv (assign(paste0("RS", RS, "_2024_DENGUE_GRAVE"), AUX), 
           "Tabulacoes_R/Arboviroses/RS22_2024_DENGUE_GRAVE.csv", 
           row.names = FALSE)

rm(SINAN_DENGUE_2024_RS)

###########################################################################################################################
###########################Elaborando tabelas especiais para serem utilizadas no Informe Epidemiológico####################
###########################################################################################################################

RS_Serie_Historica <- data.frame(RS = paste0("RS", RS), "RS_2009" = NA, "RS_2010" = NA, 
                                 "RS_2011" = NA, "RS_2012" = NA, "RS_2013" = NA, 
                                 "RS_2014" = NA, "RS_2015" = NA, "RS_2016" = NA, 
                                 "RS_2017" = NA, "RS_2018" = NA, "RS_2019" = NA, 
                                 "RS_2020" = NA, "RS_2021" = NA, "RS_2022" = NA,
                                 "RS_2023" = NA, "RS_2024" = NA)

RS_Serie_Historica[1, 1] <- "Notificados"
RS_Serie_Historica[2, 1] <- "Dengue"
RS_Serie_Historica[3, 1] <- "D.S.A."
RS_Serie_Historica[4, 1] <- "Dengue_Grave"
RS_Serie_Historica[5, 1] <- "Hospitalizados"
RS_Serie_Historica[6, 1] <- "Autóctones"
RS_Serie_Historica[7, 1] <- "DENV_I"
RS_Serie_Historica[8, 1] <- "DENV_II"
RS_Serie_Historica[9, 1] <- "DENV_III"
RS_Serie_Historica[10, 1] <- "DENV_IV"
RS_Serie_Historica[11, 1] <- "Obitos"

RS_Serie_Historica[1, 2] <- sum(RS_2009_GERAL$Notificados)
RS_Serie_Historica[2, 2] <- sum(RS_2009_GERAL$Dengue)
RS_Serie_Historica[3, 2] <- sum(RS_2009_GERAL$D_S_A)
RS_Serie_Historica[4, 2] <- sum(RS_2009_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 2] <- sum(RS_2009_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 2] <- sum(RS_2009_GERAL$Autoctones)
RS_Serie_Historica[7, 2] <- sum(RS_2009_GERAL$DENV_I)
RS_Serie_Historica[8, 2] <- sum(RS_2009_GERAL$DENV_II)
RS_Serie_Historica[9, 2] <- sum(RS_2009_GERAL$DENV_III)
RS_Serie_Historica[10, 2] <- sum(RS_2009_GERAL$DENV_IV)
RS_Serie_Historica[11, 2] <- sum(RS_2009_GERAL$Obitos)

RS_Serie_Historica[1, 3] <- sum(RS_2010_GERAL$Notificados)
RS_Serie_Historica[2, 3] <- sum(RS_2010_GERAL$Dengue)
RS_Serie_Historica[3, 3] <- sum(RS_2010_GERAL$D_S_A)
RS_Serie_Historica[4, 3] <- sum(RS_2010_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 3] <- sum(RS_2010_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 3] <- sum(RS_2010_GERAL$Autoctones)
RS_Serie_Historica[7, 3] <- sum(RS_2010_GERAL$DENV_I)
RS_Serie_Historica[8, 3] <- sum(RS_2010_GERAL$DENV_II)
RS_Serie_Historica[9, 3] <- sum(RS_2010_GERAL$DENV_III)
RS_Serie_Historica[10, 3] <- sum(RS_2010_GERAL$DENV_IV)
RS_Serie_Historica[11, 3] <- sum(RS_2010_GERAL$Obitos)

RS_Serie_Historica[1, 4] <- sum(RS_2011_GERAL$Notificados)
RS_Serie_Historica[2, 4] <- sum(RS_2011_GERAL$Dengue)
RS_Serie_Historica[3, 4] <- sum(RS_2011_GERAL$D_S_A)
RS_Serie_Historica[4, 4] <- sum(RS_2011_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 4] <- sum(RS_2011_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 4] <- sum(RS_2011_GERAL$Autoctones)
RS_Serie_Historica[7, 4] <- sum(RS_2011_GERAL$DENV_I)
RS_Serie_Historica[8, 4] <- sum(RS_2011_GERAL$DENV_II)
RS_Serie_Historica[9, 4] <- sum(RS_2011_GERAL$DENV_III)
RS_Serie_Historica[10, 4] <- sum(RS_2011_GERAL$DENV_IV)
RS_Serie_Historica[11, 4] <- sum(RS_2011_GERAL$Obitos)

RS_Serie_Historica[1, 5] <- sum(RS_2012_GERAL$Notificados)
RS_Serie_Historica[2, 5] <- sum(RS_2012_GERAL$Dengue)
RS_Serie_Historica[3, 5] <- sum(RS_2012_GERAL$D_S_A)
RS_Serie_Historica[4, 5] <- sum(RS_2012_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 5] <- sum(RS_2012_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 5] <- sum(RS_2012_GERAL$Autoctones)
RS_Serie_Historica[7, 5] <- sum(RS_2012_GERAL$DENV_I)
RS_Serie_Historica[8, 5] <- sum(RS_2012_GERAL$DENV_II)
RS_Serie_Historica[9, 5] <- sum(RS_2012_GERAL$DENV_III)
RS_Serie_Historica[10, 5] <- sum(RS_2012_GERAL$DENV_IV)
RS_Serie_Historica[11, 5] <- sum(RS_2012_GERAL$Obitos)

RS_Serie_Historica[1, 6] <- sum(RS_2013_GERAL$Notificados)
RS_Serie_Historica[2, 6] <- sum(RS_2013_GERAL$Dengue)
RS_Serie_Historica[3, 6] <- sum(RS_2013_GERAL$D_S_A)
RS_Serie_Historica[4, 6] <- sum(RS_2013_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 6] <- sum(RS_2013_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 6] <- sum(RS_2013_GERAL$Autoctones)
RS_Serie_Historica[7, 6] <- sum(RS_2013_GERAL$DENV_I)
RS_Serie_Historica[8, 6] <- sum(RS_2013_GERAL$DENV_II)
RS_Serie_Historica[9, 6] <- sum(RS_2013_GERAL$DENV_III)
RS_Serie_Historica[10, 6] <- sum(RS_2013_GERAL$DENV_IV)
RS_Serie_Historica[11, 6] <- sum(RS_2013_GERAL$Obitos)

RS_Serie_Historica[1, 7] <- sum(RS_2014_GERAL$Notificados)
RS_Serie_Historica[2, 7] <- sum(RS_2014_GERAL$Dengue)
RS_Serie_Historica[3, 7] <- sum(RS_2014_GERAL$D_S_A)
RS_Serie_Historica[4, 7] <- sum(RS_2014_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 7] <- sum(RS_2014_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 7] <- sum(RS_2014_GERAL$Autoctones)
RS_Serie_Historica[7, 7] <- sum(RS_2014_GERAL$DENV_I)
RS_Serie_Historica[8, 7] <- sum(RS_2014_GERAL$DENV_II)
RS_Serie_Historica[9, 7] <- sum(RS_2014_GERAL$DENV_III)
RS_Serie_Historica[10, 7] <- sum(RS_2014_GERAL$DENV_IV)
RS_Serie_Historica[11, 7] <- sum(RS_2014_GERAL$Obitos)

RS_Serie_Historica[1, 8] <- sum(RS_2015_GERAL$Notificados)
RS_Serie_Historica[2, 8] <- sum(RS_2015_GERAL$Dengue)
RS_Serie_Historica[3, 8] <- sum(RS_2015_GERAL$D_S_A)
RS_Serie_Historica[4, 8] <- sum(RS_2015_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 8] <- sum(RS_2015_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 8] <- sum(RS_2015_GERAL$Autoctones)
RS_Serie_Historica[7, 8] <- sum(RS_2015_GERAL$DENV_I)
RS_Serie_Historica[8, 8] <- sum(RS_2015_GERAL$DENV_II)
RS_Serie_Historica[9, 8] <- sum(RS_2015_GERAL$DENV_III)
RS_Serie_Historica[10, 8] <- sum(RS_2015_GERAL$DENV_IV)
RS_Serie_Historica[11, 8] <- sum(RS_2015_GERAL$Obitos)

RS_Serie_Historica[1, 9] <- sum(RS_2016_GERAL$Notificados)
RS_Serie_Historica[2, 9] <- sum(RS_2016_GERAL$Dengue)
RS_Serie_Historica[3, 9] <- sum(RS_2016_GERAL$D_S_A)
RS_Serie_Historica[4, 9] <- sum(RS_2016_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 9] <- sum(RS_2016_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 9] <- sum(RS_2016_GERAL$Autoctones)
RS_Serie_Historica[7, 9] <- sum(RS_2016_GERAL$DENV_I)
RS_Serie_Historica[8, 9] <- sum(RS_2016_GERAL$DENV_II)
RS_Serie_Historica[9, 9] <- sum(RS_2016_GERAL$DENV_III)
RS_Serie_Historica[10, 9] <- sum(RS_2016_GERAL$DENV_IV)
RS_Serie_Historica[11, 9] <- sum(RS_2016_GERAL$Obitos)

RS_Serie_Historica[1, 10] <- sum(RS_2017_GERAL$Notificados)
RS_Serie_Historica[2, 10] <- sum(RS_2017_GERAL$Dengue)
RS_Serie_Historica[3, 10] <- sum(RS_2017_GERAL$D_S_A)
RS_Serie_Historica[4, 10] <- sum(RS_2017_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 10] <- sum(RS_2017_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 10] <- sum(RS_2017_GERAL$Autoctones)
RS_Serie_Historica[7, 10] <- sum(RS_2017_GERAL$DENV_I)
RS_Serie_Historica[8, 10] <- sum(RS_2017_GERAL$DENV_II)
RS_Serie_Historica[9, 10] <- sum(RS_2017_GERAL$DENV_III)
RS_Serie_Historica[10, 10] <- sum(RS_2017_GERAL$DENV_IV)
RS_Serie_Historica[11, 10] <- sum(RS_2017_GERAL$Obitos)

RS_Serie_Historica[1, 11] <- sum(RS_2018_GERAL$Notificados)
RS_Serie_Historica[2, 11] <- sum(RS_2018_GERAL$Dengue)
RS_Serie_Historica[3, 11] <- sum(RS_2018_GERAL$D_S_A)
RS_Serie_Historica[4, 11] <- sum(RS_2018_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 11] <- sum(RS_2018_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 11] <- sum(RS_2018_GERAL$Autoctones)
RS_Serie_Historica[7, 11] <- sum(RS_2018_GERAL$DENV_I)
RS_Serie_Historica[8, 11] <- sum(RS_2018_GERAL$DENV_II)
RS_Serie_Historica[9, 11] <- sum(RS_2018_GERAL$DENV_III)
RS_Serie_Historica[10, 11] <- sum(RS_2018_GERAL$DENV_IV)
RS_Serie_Historica[11, 11] <- sum(RS_2018_GERAL$Obitos)

RS_Serie_Historica[1, 12] <- sum(RS_2019_GERAL$Notificados)
RS_Serie_Historica[2, 12] <- sum(RS_2019_GERAL$Dengue)
RS_Serie_Historica[3, 12] <- sum(RS_2019_GERAL$D_S_A)
RS_Serie_Historica[4, 12] <- sum(RS_2019_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 12] <- sum(RS_2019_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 12] <- sum(RS_2019_GERAL$Autoctones)
RS_Serie_Historica[7, 12] <- sum(RS_2019_GERAL$DENV_I)
RS_Serie_Historica[8, 12] <- sum(RS_2019_GERAL$DENV_II)
RS_Serie_Historica[9, 12] <- sum(RS_2019_GERAL$DENV_III)
RS_Serie_Historica[10, 12] <- sum(RS_2019_GERAL$DENV_IV)
RS_Serie_Historica[11, 12] <- sum(RS_2019_GERAL$Obitos)

RS_Serie_Historica[1, 13] <- sum(RS_2020_GERAL$Notificados)
RS_Serie_Historica[2, 13] <- sum(RS_2020_GERAL$Dengue)
RS_Serie_Historica[3, 13] <- sum(RS_2020_GERAL$D_S_A)
RS_Serie_Historica[4, 13] <- sum(RS_2020_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 13] <- sum(RS_2020_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 13] <- sum(RS_2020_GERAL$Autoctones)
RS_Serie_Historica[7, 13] <- sum(RS_2020_GERAL$DENV_I)
RS_Serie_Historica[8, 13] <- sum(RS_2020_GERAL$DENV_II)
RS_Serie_Historica[9, 13] <- sum(RS_2020_GERAL$DENV_III)
RS_Serie_Historica[10, 13] <- sum(RS_2020_GERAL$DENV_IV)
RS_Serie_Historica[11, 13] <- sum(RS_2020_GERAL$Obitos)

RS_Serie_Historica[1, 14] <- sum(RS_2021_GERAL$Notificados)
RS_Serie_Historica[2, 14] <- sum(RS_2021_GERAL$Dengue)
RS_Serie_Historica[3, 14] <- sum(RS_2021_GERAL$D_S_A)
RS_Serie_Historica[4, 14] <- sum(RS_2021_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 14] <- sum(RS_2021_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 14] <- sum(RS_2021_GERAL$Autoctones)
RS_Serie_Historica[7, 14] <- sum(RS_2021_GERAL$DENV_I)
RS_Serie_Historica[8, 14] <- sum(RS_2021_GERAL$DENV_II)
RS_Serie_Historica[9, 14] <- sum(RS_2021_GERAL$DENV_III)
RS_Serie_Historica[10, 14] <- sum(RS_2021_GERAL$DENV_IV)
RS_Serie_Historica[11, 14] <- sum(RS_2021_GERAL$Obitos)

RS_Serie_Historica[1, 15] <- sum(RS_2022_GERAL$Notificados)
RS_Serie_Historica[2, 15] <- sum(RS_2022_GERAL$Dengue)
RS_Serie_Historica[3, 15] <- sum(RS_2022_GERAL$D_S_A)
RS_Serie_Historica[4, 15] <- sum(RS_2022_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 15] <- sum(RS_2022_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 15] <- sum(RS_2022_GERAL$Autoctones)
RS_Serie_Historica[7, 15] <- sum(RS_2022_GERAL$DENV_I)
RS_Serie_Historica[8, 15] <- sum(RS_2022_GERAL$DENV_II)
RS_Serie_Historica[9, 15] <- sum(RS_2022_GERAL$DENV_III)
RS_Serie_Historica[10, 15] <- sum(RS_2022_GERAL$DENV_IV)
RS_Serie_Historica[11, 15] <- sum(RS_2022_GERAL$Obitos)

RS_Serie_Historica[1, 16] <- sum(RS_2023_GERAL$Notificados)
RS_Serie_Historica[2, 16] <- sum(RS_2023_GERAL$Dengue)
RS_Serie_Historica[3, 16] <- sum(RS_2023_GERAL$D_S_A)
RS_Serie_Historica[4, 16] <- sum(RS_2023_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 16] <- sum(RS_2023_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 16] <- sum(RS_2023_GERAL$Autoctones)
RS_Serie_Historica[7, 16] <- sum(RS_2023_GERAL$DENV_I)
RS_Serie_Historica[8, 16] <- sum(RS_2023_GERAL$DENV_II)
RS_Serie_Historica[9, 16] <- sum(RS_2023_GERAL$DENV_III)
RS_Serie_Historica[10, 16] <- sum(RS_2023_GERAL$DENV_IV)
RS_Serie_Historica[11, 16] <- sum(RS_2023_GERAL$Obitos)

RS_Serie_Historica[1, 17] <- sum(RS_2024_GERAL$Notificados)
RS_Serie_Historica[2, 17] <- sum(RS_2024_GERAL$Dengue)
RS_Serie_Historica[3, 17] <- sum(RS_2024_GERAL$D_S_A)
RS_Serie_Historica[4, 17] <- sum(RS_2024_GERAL$Dengue_Grave)
RS_Serie_Historica[5, 17] <- sum(RS_2024_GERAL$Hospitalizacao)
RS_Serie_Historica[6, 17] <- sum(RS_2024_GERAL$Autoctones)
RS_Serie_Historica[7, 17] <- sum(RS_2024_GERAL$DENV_I)
RS_Serie_Historica[8, 17] <- sum(RS_2024_GERAL$DENV_II)
RS_Serie_Historica[9, 17] <- sum(RS_2024_GERAL$DENV_III)
RS_Serie_Historica[10, 17] <- sum(RS_2024_GERAL$DENV_IV)
RS_Serie_Historica[11, 17] <- sum(RS_2024_GERAL$Obitos)

rm(RS_2009_GERAL, RS_2010_GERAL, RS_2011_GERAL, RS_2012_GERAL, 
   RS_2013_GERAL, RS_2014_GERAL, RS_2015_GERAL, RS_2016_GERAL,
   RS_2017_GERAL, RS_2018_GERAL, RS_2019_GERAL, RS_2020_GERAL,
   RS_2021_GERAL, RS_2022_GERAL, RS_2023_GERAL, RS_2024_GERAL)

#####Gravando tabela de série histórica#####

assign(paste0("RS", RS, "_Serie_Historica"), 
       RS_Serie_Historica) 

write.csv (RS_Serie_Historica, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_Serie_Historica_Base.csv"), 
           row.names = FALSE)

rm(RS_Serie_Historica)

###Construindo tabela para Canal Endêmico Notificados####

RS_CE_Base_Notificados <- data.frame("SE" = NA)

RS_CE_Base_Notificados[1, 1] <- "2009"
RS_CE_Base_Notificados[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[2, 1] <- "2010"
RS_CE_Base_Notificados[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[3, 1] <- "2011"
RS_CE_Base_Notificados[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[4, 1] <- "2012"
RS_CE_Base_Notificados[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[5, 1] <- "2013"
RS_CE_Base_Notificados[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[6, 1] <- "2014"
RS_CE_Base_Notificados[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[7, 1] <- "2015"
RS_CE_Base_Notificados[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[8, 1] <- "2016"
RS_CE_Base_Notificados[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[9, 1] <- "2017"
RS_CE_Base_Notificados[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[10, 1] <- "2018"
RS_CE_Base_Notificados[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[11, 1] <- "2019"
RS_CE_Base_Notificados[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[12, 1] <- "2020"
RS_CE_Base_Notificados[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[13, 1] <- "2021"
RS_CE_Base_Notificados[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[14, 1] <- "2022"
RS_CE_Base_Notificados[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[15, 1] <- "2023"
RS_CE_Base_Notificados[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Notificados[17, 2:54]))

RS_CE_Base_Notificados[16, 1] <- "2024"
RS_CE_Base_Notificados[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Notificados[17, 2:54]))

colnames (RS_CE_Base_Notificados)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Notificados_Base"), RS_CE_Base_Notificados)

write.csv (RS_CE_Base_Notificados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_Base.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados

RS_CE_Base_Confirmados <- data.frame("SE" = NA)

RS_CE_Base_Confirmados[1, 1] <- "2009"
RS_CE_Base_Confirmados[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[2, 1] <- "2010"
RS_CE_Base_Confirmados[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[3, 1] <- "2011"
RS_CE_Base_Confirmados[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[4, 1] <- "2012"
RS_CE_Base_Confirmados[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[5, 1] <- "2013"
RS_CE_Base_Confirmados[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[6, 1] <- "2014"
RS_CE_Base_Confirmados[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[7, 1] <- "2015"
RS_CE_Base_Confirmados[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[8, 1] <- "2016"
RS_CE_Base_Confirmados[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[9, 1] <- "2017"
RS_CE_Base_Confirmados[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[10, 1] <- "2018"
RS_CE_Base_Confirmados[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[11, 1] <- "2019"
RS_CE_Base_Confirmados[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[12, 1] <- "2020"
RS_CE_Base_Confirmados[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[13, 1] <- "2021"
RS_CE_Base_Confirmados[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[14, 1] <- "2022"
RS_CE_Base_Confirmados[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[15, 1] <- "2023"
RS_CE_Base_Confirmados[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Confirmados[17, 2:54]))

RS_CE_Base_Confirmados[16, 1] <- "2024"
RS_CE_Base_Confirmados[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Confirmados[17, 2:54]))

colnames (RS_CE_Base_Confirmados)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Confirmados_Base"), RS_CE_Base_Confirmados)

write.csv (RS_CE_Base_Confirmados, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_CE_Confirmados_Base.csv"), 
           row.names = FALSE)

###Construindo tabela para Canal Endêmico Notificados - IVAIPORÃ####

RS_CE_Base_Notificados_SEDE <- data.frame("SE" = NA)

RS_CE_Base_Notificados_SEDE[1, 1] <- "2009"
RS_CE_Base_Notificados_SEDE[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[2, 1] <- "2010"
RS_CE_Base_Notificados_SEDE[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[3, 1] <- "2011"
RS_CE_Base_Notificados_SEDE[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[4, 1] <- "2012"
RS_CE_Base_Notificados_SEDE[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[5, 1] <- "2013"
RS_CE_Base_Notificados_SEDE[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[6, 1] <- "2014"
RS_CE_Base_Notificados_SEDE[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[7, 1] <- "2015"
RS_CE_Base_Notificados_SEDE[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[8, 1] <- "2016"
RS_CE_Base_Notificados_SEDE[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[9, 1] <- "2017"
RS_CE_Base_Notificados_SEDE[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[10, 1] <- "2018"
RS_CE_Base_Notificados_SEDE[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[11, 1] <- "2019"
RS_CE_Base_Notificados_SEDE[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[12, 1] <- "2020"
RS_CE_Base_Notificados_SEDE[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[13, 1] <- "2021"
RS_CE_Base_Notificados_SEDE[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[14, 1] <- "2022"
RS_CE_Base_Notificados_SEDE[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[15, 1] <- "2023"
RS_CE_Base_Notificados_SEDE[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Notificados[6, 2:54]))

RS_CE_Base_Notificados_SEDE[16, 1] <- "2024"
RS_CE_Base_Notificados_SEDE[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Notificados[6, 2:54]))

colnames (RS_CE_Base_Notificados_SEDE)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados_SEDE)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Notificados_Sede_Base"), RS_CE_Base_Notificados_SEDE)

write.csv (RS_CE_Base_Notificados_SEDE, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_Sede_Base.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados - IVAIPORÃ

RS_CE_Base_Confirmados_SEDE <- data.frame("SE" = NA)

RS_CE_Base_Confirmados_SEDE[1, 1] <- "2009"
RS_CE_Base_Confirmados_SEDE[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[2, 1] <- "2010"
RS_CE_Base_Confirmados_SEDE[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[3, 1] <- "2011"
RS_CE_Base_Confirmados_SEDE[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[4, 1] <- "2012"
RS_CE_Base_Confirmados_SEDE[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[5, 1] <- "2013"
RS_CE_Base_Confirmados_SEDE[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[6, 1] <- "2014"
RS_CE_Base_Confirmados_SEDE[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[7, 1] <- "2015"
RS_CE_Base_Confirmados_SEDE[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[8, 1] <- "2016"
RS_CE_Base_Confirmados_SEDE[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[9, 1] <- "2017"
RS_CE_Base_Confirmados_SEDE[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[10, 1] <- "2018"
RS_CE_Base_Confirmados_SEDE[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[11, 1] <- "2019"
RS_CE_Base_Confirmados_SEDE[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[12, 1] <- "2020"
RS_CE_Base_Confirmados_SEDE[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[13, 1] <- "2021"
RS_CE_Base_Confirmados_SEDE[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[14, 1] <- "2022"
RS_CE_Base_Confirmados_SEDE[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[15, 1] <- "2023"
RS_CE_Base_Confirmados_SEDE[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Confirmados[6, 2:54]))

RS_CE_Base_Confirmados_SEDE[16, 1] <- "2024"
RS_CE_Base_Confirmados_SEDE[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Confirmados[6, 2:54]))

colnames (RS_CE_Base_Confirmados_SEDE)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados_SEDE)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Confirmados_SEDE_Base"), RS_CE_Base_Confirmados_SEDE)

write.csv (RS_CE_Base_Confirmados_SEDE, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS,"_CE_Confirmados_Sede_BASE.csv"), 
           row.names = FALSE)


###Construindo tabela para Canal Endêmico Notificados - Jardim Alegre####

RS_CE_Base_Notificados_JARDIM <- data.frame("SE" = NA)

RS_CE_Base_Notificados_JARDIM[1, 1] <- "2009"
RS_CE_Base_Notificados_JARDIM[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[2, 1] <- "2010"
RS_CE_Base_Notificados_JARDIM[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[3, 1] <- "2011"
RS_CE_Base_Notificados_JARDIM[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[4, 1] <- "2012"
RS_CE_Base_Notificados_JARDIM[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[5, 1] <- "2013"
RS_CE_Base_Notificados_JARDIM[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[6, 1] <- "2014"
RS_CE_Base_Notificados_JARDIM[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[7, 1] <- "2015"
RS_CE_Base_Notificados_JARDIM[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[8, 1] <- "2016"
RS_CE_Base_Notificados_JARDIM[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[9, 1] <- "2017"
RS_CE_Base_Notificados_JARDIM[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[10, 1] <- "2018"
RS_CE_Base_Notificados_JARDIM[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[11, 1] <- "2019"
RS_CE_Base_Notificados_JARDIM[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[12, 1] <- "2020"
RS_CE_Base_Notificados_JARDIM[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[13, 1] <- "2021"
RS_CE_Base_Notificados_JARDIM[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[14, 1] <- "2022"
RS_CE_Base_Notificados_JARDIM[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[15, 1] <- "2023"
RS_CE_Base_Notificados_JARDIM[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Notificados[7, 2:54]))

RS_CE_Base_Notificados_JARDIM[16, 1] <- "2024"
RS_CE_Base_Notificados_JARDIM[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Notificados[7, 2:54]))

colnames (RS_CE_Base_Notificados_JARDIM)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados_JARDIM)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Notificados_JARDIM"), RS_CE_Base_Notificados_JARDIM)

write.csv (RS_CE_Base_Notificados_JARDIM, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_JARDIM.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados - Jardim Alegre

RS_CE_Base_Confirmados_JARDIM <- data.frame("SE" = NA)

RS_CE_Base_Confirmados_JARDIM[1, 1] <- "2009"
RS_CE_Base_Confirmados_JARDIM[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[2, 1] <- "2010"
RS_CE_Base_Confirmados_JARDIM[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[3, 1] <- "2011"
RS_CE_Base_Confirmados_JARDIM[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[4, 1] <- "2012"
RS_CE_Base_Confirmados_JARDIM[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[5, 1] <- "2013"
RS_CE_Base_Confirmados_JARDIM[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[6, 1] <- "2014"
RS_CE_Base_Confirmados_JARDIM[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[7, 1] <- "2015"
RS_CE_Base_Confirmados_JARDIM[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[8, 1] <- "2016"
RS_CE_Base_Confirmados_JARDIM[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[9, 1] <- "2017"
RS_CE_Base_Confirmados_JARDIM[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[10, 1] <- "2018"
RS_CE_Base_Confirmados_JARDIM[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[11, 1] <- "2019"
RS_CE_Base_Confirmados_JARDIM[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[12, 1] <- "2020"
RS_CE_Base_Confirmados_JARDIM[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[13, 1] <- "2021"
RS_CE_Base_Confirmados_JARDIM[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[14, 1] <- "2022"
RS_CE_Base_Confirmados_JARDIM[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[15, 1] <- "2023"
RS_CE_Base_Confirmados_JARDIM[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Confirmados[7, 2:54]))

RS_CE_Base_Confirmados_JARDIM[16, 1] <- "2024"
RS_CE_Base_Confirmados_JARDIM[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Confirmados[7, 2:54]))

colnames (RS_CE_Base_Confirmados_JARDIM)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados_JARDIM)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Confirmados_JARDIM"), RS_CE_Base_Confirmados_JARDIM)

write.csv (RS_CE_Base_Confirmados_JARDIM, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS,"_CE_Confirmados_JARDIM.csv"), 
           row.names = FALSE)


###Construindo tabela para Canal Endêmico Notificados - São João do Ivaí####

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI <- data.frame("SE" = NA)

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[1, 1] <- "2009"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[2, 1] <- "2010"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[3, 1] <- "2011"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[4, 1] <- "2012"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[5, 1] <- "2013"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[6, 1] <- "2014"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[7, 1] <- "2015"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[8, 1] <- "2016"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[9, 1] <- "2017"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[10, 1] <- "2018"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[11, 1] <- "2019"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[12, 1] <- "2020"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[13, 1] <- "2021"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[14, 1] <- "2022"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[15, 1] <- "2023"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Notificados[16, 2:54]))

RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[16, 1] <- "2024"
RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Notificados[16, 2:54]))

colnames (RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Notificados_SAO_JOAO_DO_IVAI"), RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI)

write.csv (RS_CE_Base_Notificados_SAO_JOAO_DO_IVAI, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS, "_CE_Notificados_SAO_JOAO_DO_IVAI.csv"), 
           row.names = FALSE)

###Construindo tabela Canal Endêmico Confirmados - São João do Ivaí

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI <- data.frame("SE" = NA)

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[1, 1] <- "2009"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[1, 2:54] <- as.integer(data.frame(RS_2009_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[2, 1] <- "2010"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[2, 2:54] <- as.integer(data.frame(RS_2010_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[3, 1] <- "2011"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[3, 2:54] <- as.integer(data.frame(RS_2011_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[4, 1] <- "2012"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[4, 2:54] <- as.integer(data.frame(RS_2012_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[5, 1] <- "2013"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[5, 2:54] <- as.integer(data.frame(RS_2013_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[6, 1] <- "2014"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[6, 2:54] <- as.integer(data.frame(RS_2014_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[7, 1] <- "2015"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[7, 2:54] <- as.integer(data.frame(RS_2015_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[8, 1] <- "2016"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[8, 2:54] <- as.integer(data.frame(RS_2016_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[9, 1] <- "2017"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[9, 2:54] <- as.integer(data.frame(RS_2017_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[10, 1] <- "2018"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[10, 2:54] <- as.integer(data.frame(RS_2018_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[11, 1] <- "2019"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[11, 2:54] <- as.integer(data.frame(RS_2019_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[12, 1] <- "2020"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[12, 2:54] <- as.integer(data.frame(RS_2020_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[13, 1] <- "2021"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[13, 2:54] <- as.integer(data.frame(RS_2021_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[14, 1] <- "2022"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[14, 2:54] <- as.integer(data.frame(RS_2022_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[15, 1] <- "2023"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[15, 2:54] <- as.integer(data.frame(RS_2023_SE_Confirmados[16, 2:54]))

RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[16, 1] <- "2024"
RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI[16, 2:54] <- as.integer(data.frame(RS_2024_SE_Confirmados[16, 2:54]))

colnames (RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI)[1] <- "Período Sazonal"
colnames (RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI)[2:54] <- c(1:53)

#####Gravando tabela base do canal endêmico NOTIFICADOS#####

assign(paste0("RS", RS, "_CE_Confirmados_SAO_JOAO_DO_IVAI"), RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI)

write.csv (RS_CE_Base_Confirmados_SAO_JOAO_DO_IVAI, 
           paste0("Tabulacoes_R/Arboviroses/RS", RS,"_CE_Confirmados_SAO_JOAO_DO_IVAI.csv"), 
           row.names = FALSE)

rm(AUX,
   BASE_IBGE,
   i,
   ID_REG,
   nrow,
   RS, 
   RS_2009_SE_Confirmados,
   RS_2009_SE_Notificados,
   RS_2010_SE_Confirmados,
   RS_2010_SE_Notificados,
   RS_2011_SE_Confirmados,
   RS_2011_SE_Notificados,
   RS_2012_SE_Confirmados,
   RS_2012_SE_Notificados,
   RS_2013_SE_Confirmados,
   RS_2013_SE_Notificados,
   RS_2014_SE_Notificados,
   RS_2014_SE_Confirmados,
   RS_2015_SE_Confirmados,
   RS_2015_SE_Notificados,
   RS_2016_SE_Confirmados,
   RS_2016_SE_Notificados,
   RS_2017_SE_Confirmados,
   RS_2017_SE_Notificados,
   RS_2018_SE_Confirmados,
   RS_2018_SE_Notificados,
   RS_2019_SE_Confirmados,
   RS_2019_SE_Notificados,
   RS_2020_SE_Confirmados,
   RS_2020_SE_Notificados,
   RS_2021_SE_Confirmados,
   RS_2021_SE_Notificados,
   RS_CE_Base_Confirmados_SEDE,
   RS_CE_Base_Confirmados,
   RS_CE_Base_Notificados,
   RS_CE_Base_Notificados_SEDE)

warnings()














